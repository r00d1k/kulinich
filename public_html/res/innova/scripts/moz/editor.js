/***********************************************************
InnovaStudio WYSIWYG Editor 5.3
ï¿½ 2011, InnovaStudio (www.innovastudio.com). All rights reserved.
************************************************************/
//eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('a 4V=1m go();a 14=1m cx();z cx(){9.8s="en-cy";2q{if(cz)9.8s=cz}2r(e){}a 3z=c.1O("3A");Q(a i=0;i<3z.F;i++){a 5N=3z[i].4n.2w();if(5N.1K("3m/4V.js")!=-1){9.X=3z[i].4n.D(/4V.js/,"")}K if(5N.1K("gp/5O.js")!=-1){if(!9.X)9.X=3z[i].4n.D(/5O.js/,"")+"3m/"}}9.cA=9.X.D(/\\/3m/,"")+"gq/"+9.8s+"/";if(9.8s=="en-cy")c.6V("<cB"+"cC 4n=\'"+9.cA+"gr.js\'></cB"+"cC>");9.b;9.d;9.11;9.L;9.6W;9.4W=4W;9.gs=E;9.2X=[];9.8t=z(){N E};9.3T;9.gu;9.al=al;9.am=J;9.8u=[[gv,"&gw;"],[cD,"&gx;"],[6X,"&5P;"],[gy,"&gz;"],[gA,"&gB;"],[gC,"&gD;"],[gE,"\\""]];9.6Y=[];Q(a i=0;i<9.8u.F;i++){9.6Y[i]=[1m cE(1q.gF(9.8u[i][0]),"g"),9.8u[i][1]]}9.6Z=z(q){Q(a i=0;i<9.6Y.F;i++){q=q.D(9.6Y[i][0],9.6Y[i][1])}N q};9.gG=z(4o,3B){a 4X=[],2M,8v;if(gH(4o)=="gI"&&4o.1o&&4o.1o=="3U"){4X[0]=4o}K if(4o.3n(0,1)=="#"){2M=c.M(4o.3n(1));if(!2M)N;4X[0]=2M}K{a 70=c.1O("3U");Q(a i=0;i<70.F;i++){if(70[i].3o==4o){4X[4X.F]=70[i]}}}Q(a i=0;i<4X.F;i++){2M=4X[i];if(2M.id||2M.id=="")2M.id="gJ"+i;8v=c.3C("3V");8v.id="5O"+i;2M.1v.gK(8v,2M);2s["2f"+i]=1m cF("2f"+i);a 5Q;if(2s.cG){5Q=2s.cG(2M,1g)}K if(2M.cI){5Q=2M.cI}K{5Q={1n:2s["2f"+i].1n,1c:2s["2f"+i].1c}}2s["2f"+i].1n=5Q.1n;2s["2f"+i].1c=5Q.1c;if(3B){Q(a it in 3B){2s["2f"+i][it]=3B[it]}}2s["2f"+i].8w(2M.id,"5O"+i)}}};z 4W(R){2Y(R!=1g){if(R.2N&&R.2N=="1d")N E;R=R.1v}N J};z an(){a d=c.M("12"+9.b).15;a L=d.1i();a 8x=2x(L);if(8x!=1g){if(!4W(8x))N J}K{if(!4W(8x))N J}N E};z cJ(4p){a d=c.M("12"+9.b);if(d){d=d.15;d.1V()}if(4p&&d){a gL;a l=d.c.2g();if(d.c.1j.17.F>0){a 4Y=1g;if(4p=="gM"){4Y=d.c.1j.17[0];l.2h(4Y);l.2Z(E)}K{4Y=d.c.1j.17[d.c.1j.17.F-1];l.2h(4Y);if(4Y.1P==1&&4Y.1o=="5R"){l.2Z(E)}K{l.2Z(J)}}}K{l.ao(d.c.1j);l.2Z(J)}a 2i=d.1i();2i.2F();2i.2G(l);a 2j=d.c.cK("cL");2j.cM("cN",E,E,1g,J,J,J,J,0,32);d.c.cO(2j);2j=d.c.cK("cL");2j.cM("cN",E,E,1g,J,J,J,J,8,0);d.c.cO(2j)}};z ap(4p){9.1V(4p)};z al(b){if((b!=1g)&&(b!="")){2q{a 4q=c.M("12"+b);4q.gN.2N="1d";4q.1V()}2r(e){}}K{Q(a i=0;i<9.2X.F;i++){2q{a 4q=c.M("12"+9.2X[i]).15;4q.c.2N="1d";a r=4q.1i().2k(0);r.2h(4q.c.1O("gO")[0]);r.2Z(E);4q.1V()}2r(e){}}}};a 5S;z cF(b){9.b=b;9.cP=cQ;9.71=71;9.8y=8y;9.72=72;9.5T=5T;9.5U=5U;9.5V=5V;9.5W=5W;9.aq=aq;9.ar=ar;9.5X="";9.cR=z(){N E};9.as="#gP";9.at="3D";9.8z=8z;9.8A=8A;9.3E=3E;9.4r=4r;9.3W=3W;9.8B=8B;9.8C=8C;9.4W=4W;9.an=an;9.1V=cJ;9.ap=ap;9.1D=1D;9.8D=8D;9.8E=8E;9.8F=8F;9.8G=8G;9.8H=8H;9.8I=8I;9.8J=8J;9.8K=8K;9.8L=8L;9.8M=8M;9.8N=8N;9.au=au;9.8O=8O;9.74=74;9.8P=8P;9.8Q=8Q;9.8R=8R;9.1k=1k;9.1n="gQ";9.1c="gR";9.75="";a 3z=c.1O("3A");Q(a i=0;i<3z.F;i++){a 5N=3z[i].4n.2w();if(5N.1K("3m/4V.js")!=-1){9.X=3z[i].4n.D(/4V.js/,"");u}K if(5N.1K("5O.js")!=-1){9.X=3z[i].4n.D(/5O.js/,"3m/");u}}9.2y="cS/";9.av=29;9.5S=25;9.gS=0;9.gT=0;9.gU=0;9.4Z=4Z;9.4s=[];9.30=1m aw("30",9.b);9.31=1m aw("31",9.b);9.76=76;9.gV=J;9.gW=J;9.gX="";9.gY="";9.cT=cU;9.8S=J;9.gZ=cV;9.50=[];9.3X=["ax","ay","az","aA","8T","cW","aB","aC","51","cX","cY","8U","8V","5Y","aD","8W","8X","77","8Y","8Z","91","cZ","d0","d1","d2","33","aE","d3","aF","92","93","94","78","d4","d5","d6","aG","d7","4t","aH","95","d8","79","7a","7b","3Y","3Z","41","4u","4v","52","5Z","60","61","62","96","97","53","54","d9","da"];9.55=J;9.98=E;9.7c=E;9.7d=J;9.7e=E;9.7f=J;9.56=E;9.57=E;9.58=E;9.4w=E;9.63=E;9.64=J;9.99=J;9.4x=E;9.4y=E;9.4z=E;9.db=E;9.dc=E;9.7g=E;9.65=J;9.42=E;9.43=E;9.59=E;9.5a=E;9.5b=E;9.5c=J;9.5d=J;9.5e=J;9.67=E;9.68=E;9.69=E;9.6a=E;9.5f=E;9.5g=E;9.5h=E;9.5i=E;9.5j=J;9.5k=J;9.6b=E;9.6c=E;9.7h=E;9.7i=E;9.9a=E;9.5l=J;9.7j=E;9.7k=J;9.7l=J;9.6d=E;9.dd=E;9.7m=E;9.6e=E;9.5m=E;9.7n=E;9.7o=E;9.9b=J;9.9c=J;9.4A=J;9.4B=E;9.9d=J;9.7p=E;9.7q=J;9.aI=[["h0","h1",["df","dg","dh"]],["h2","6f",["di","dj","dk"]]];9.6g=[["df","",["aG","ay","8T","78","4t","8U","8V","aB","aC","51","cX","cY"]],["dg","",["7a","7b","4u","4v","4t","3Y","3Z","41","5Y","aD"]],["dh","",["79","53","54","95","aH","4t","5Z","60","61","62","96","97"]],["di","",["8X","8W","4t","77"]],["dj","",["33","4t","d3"]],["dk","",["8Z","8Y","91","4t","92","93"]]];9.aJ=1;9.dl=E;9.dm=J;9.h3="";9.h4="";9.h5="";9.h6="";9.h7="";9.6h=J;9.aK=";";9.6i=J;9.aL=";";9.aM=aM;9.6j=J;9.aN=";";9.6k=J;9.aO=";";9.1G=[];9.aP=J;9.7r=7r;9.6l=[[H("6m 1"),"9e"],[H("6m 2"),"9f"],[H("6m 3"),"9g"],[H("6m 4"),"9h"],[H("6m 5"),"9i"],[H("6m 6"),"9j"],[H("h8"),"9k"],[H("dn (P)"),"P"],[H("dn (3V)"),"3V"]];9.4C=["aQ","aQ h9","aQ ha","hb hc","hd he do","hf dp","hh dq dr","hi ds","hj dp hk","hl","hm","hn","aR ho","aR dq","aR hp","hq","hs ht","hu hv","dt","hw","hx hy","hz","hA","hB ds dt","hC dr","hD","hE","hF","du","hG-du","hH","hI","hJ"];9.5n=[[H("44 1"),"1"],[H("44 2"),"2"],[H("44 3"),"3"],[H("44 4"),"4"],[H("44 5"),"5"],[H("44 6"),"6"],[H("44 7"),"7"]];9.7s=[];9.5o="";9.2O="<2O>";9.aS="";9.6n="";9.6o="";9.aT=aT;9.dv=z(){c.M("aU"+9.b).dw()};9.dz=z(){N E};9.dA=z(){N E};9.hK=J;9.9l=9l;9.9m=9m;9.1I=1I;9.7t=7t;9.3F=[];9.7u=[];9.9n=E;9.5p="45";9.6p=6p;9.7v=7v;9.7w=7w;9.9o=9o;9.9p=9p;9.3p=[["hL","dB(0)","dC dD","55.V"],["hM","dB(0)","dC dD","55.V"]];9.8t=z(){N E};9.9q="aV";9.7x=J;9.7y=7y;9.9r=9r;9.8w=8w;9.2P="7z";9.5q;a me=9;9.1e=1m hN(9.b);9.1e.2y=9.X.1R(0,9.X.1K("3m/"))+9.2y;4V[4V.F]=9;N 9};z 1I(){a d=c.M("12"+9.b).15;a 11=9;if(11.3F[0])if(d.c.1j.1h==11.3F[0][0])N;Q(a i=20;i>1;i--)11.3F[i-1]=11.3F[i-2];11.1V();a L=d.1i();a l=L.2k(0);11.3F[0]=[d.c.1j.1h,l.dE()];9.7u=[];if(9.42)9.1e.1E["42"+9.b].1z(1);if(9.43)9.1e.1E["43"+9.b].1z(5)};z 9l(){9.7t(9.3F,9.7u)};z 9m(){9.7t(9.7u,9.3F)};z 7t(5r,9s){a d=c.M("12"+9.b).15;a 11=9;if(!5r[0])N;Q(a i=20;i>1;i--)9s[i-1]=9s[i-2];a L=d.1i();a l=L.2k(0);9s[0]=[d.c.1j.1h,l.dE()];q=5r[0][0];d.c.1j.1h=q;L=d.1i();L.2F();L.2G(5r[0][1]);Q(a i=0;i<19;i++)5r[i]=5r[i+1];5r[19]=1g;34(9)};a aW=J;z 8w(5q,7A){9.5q=5q;a aX=c.M(5q);aX.k.2l="2Q";a 7B=aX.hO;if(7B){if(!aW){if(7B.aY)9t=7B.aY;aW=E}7B.aY=1m 2H("N dF()")}a 1W=c.M(5q).6q;1W=1W.D(/&/g,"&2R;");1W=1W.D(/</g,"&lt;");1W=1W.D(/>/g,"&gt;");9.71(1W,7A)};z aT(){a 1W="";if(9.2P=="9u"){1W=9.5T()}K if(9.2P=="5s"){1W=9.5U()}K if(9.2P=="7z"){1W=9.5V()}K if(9.2P=="9v"){1W=9.5W()}if(1W!=9.6o){N E}N J};z dF(){a 1W;Q(a i=0;i<14.2X.F;i++){a 2f=1L(14.2X[i]);if(2f.2P=="9u")1W=2f.5T();if(2f.2P=="5s")1W=2f.5U();if(2f.2P=="7z")1W=2f.5V();if(2f.2P=="9v")1W=2f.5W();c.M(2f.5q).6q=1W}if(9t)N 9t()};z 9t(){};z 71(1X,7A){5S=9.5S;if(1X.1R(0,4)=="<!--"&&1X.1R(1X.F-3)=="-->")1X=1X.1R(4,1X.F-3);if(1X.1R(0,4)=="<!--"&&1X.1R(1X.F-6)=="--&gt;")1X=1X.1R(4,1X.F-6);1X=1X.D(/&lt;/g,"<");1X=1X.D(/&gt;/g,">");1X=1X.D(/&2R;/g,"&");if(9.aK!=";")9.6h=E;if(9.aL!=";")9.6i=E;if(9.aO!=";")9.6k=E;if(9.aN!=";")9.6j=E;if(9.7s.F>0)9.5l=E;if(9.2P=="9u"){9.4B=E;9.4A=J}if(9.2P=="5s"){9.4A=E;9.4B=J}if(9.2P=="7z"){9.4B=E;9.4A=J}if(9.2P=="9v"){9.4A=E;9.4B=J}a dG=J;if(9.50.F>0){dG=E;Q(a i=0;i<9.3X.F;i++)1L(9.b+".T"+9.3X[i]+"=E");9.56=J;9.57=J;9.58=J;9.4w=J;9.63=J;9.64=J;Q(a j=0;j<9.50.F;j++)1L(9.b+".T"+9.50[j]+"=E");Q(a i=0;i<9.3X.F;i++){6r=9.3X[i];aZ=J;Q(a j=0;j<9.50.F;j++)if(6r==9.50[j])aZ=E;if(!aZ)1L(9.b+".T"+6r+"=J")}9.3X=9.50}9.6n=1X;a dH="";a hP="";a 1Y="";9.30.2I=9.X+"hQ.1b";9.30.b0=1m 2H(9.b+".1k()");9.30.9w=1m 2H(9.b+".1k()");9.30.7C=1m 2H(9.b+".4Z(\'5Y\', "+9.b+".30.1A)");9.30.9x=1m 2H(9.b+".4Z(\'5Y\',\'\')");9.30.9y=H("9z 6s");9.30.9A=H("b1 6s...");9.31.2I=9.X+"hR.1b";9.31.b0=1m 2H(9.b+".1k()");9.31.9w=1m 2H(9.b+".1k()");9.31.7C=1m 2H(9.b+".4Z(\'hS\', "+9.b+".31.1A)");9.31.9x=1m 2H(9.b+".4Z(\'dI\',\'\')");9.31.9y=H("9z 6s");9.31.9A=H("b1 6s...");a me=9;if(9.aJ!=0){a 1Z=1g,46,9B=1m dJ();Q(a i=0;i<9.3X.F;i++){1L(9.b+".T"+9.3X[i]+"=J")}Q(a i=0;i<9.6g.F;i++){1Z=9.6g[i];46=9.1e.dK(9.b+"1e"+1Z[0]);46.3q=z(id){b2(46,id,me,me.b)};46.k.hT="hU";46.2y=9.X.1R(0,9.X.1K("3m/"))+9.2y;46.dL=9.av;46.dM=9.5S;Q(a j=0;j<1Z[2].F;j++){1L(9.b+".T"+1Z[2][j]+"=E")}b3(46,9,1Z[2]);9B[1Z[0]]=1Z[1]}if(9.aJ==1){a dN=9.1e.hV("hW"+9.b),5t;Q(a i=0;i<9.aI.F;i++){1Z=9.aI[i];5t=9.1e.dO(9.b+"dP"+1Z[0]);Q(a j=0;j<1Z[2].F;j++){5t.dQ(9.b+1Z[2][j],9B[1Z[2][j]],9.b+"1e"+1Z[2][j])}dN.hX(9.b+1Z[0],1Z[1],5t)}}K if(9.6g.F>0){a 5t;5t=9.1e.dO(9.b+"dP");Q(a i=0;i<9.6g.F;i++){1Z=9.6g[i];5t.dQ(9.b+1Z[0],9B[1Z[0]],9.b+"1e"+1Z[0])}}}K{a 5u=9.1e.dK(9.b);5u.3q=z(id){b2(5u,id,me,me.b)};5u.2y=9.X.1R(0,9.X.1K("3m/"))+9.2y;5u.dL=9.av;5u.dM=9.5S;b3(5u,9,9.3X)}a q="";a b4=9.X.1R(0,9.X.1K("3m/"))+9.2y;if(!c.M("9C"))q+="<3G id=9C k=\'2m:1B\'></3G>";q+="<1r id=5v"+9.b+" 4D=5v"+9.b+" 1s=\'1B\' "+"2t=0 2u=0 1n=\'"+9.1n+"\' 1c=\'"+9.1c+"\' k=\'1s-45:#6t 1a 1J\'>"+"<18><Y 47=2 k=\\"1F:1B;1s:#6t 1B 1J;21:2I(\'"+b4+"bg.V\')\\">"+"<1r 2t=0 2u=0 1s=0 1n=26%><18><Y 35=b5 k=\'1F:1B;\'>"+9.1e.hY()+"</Y></18></1r>"+"</Y></18>"+"<18 id=dR"+9.b+"><Y 47=2 id=dS"+9.b+" 1c=1B k=\'1F:1B;\'></Y></18>";q+="<18 k=\'1n:26%;1c:26%\'><Y 47=2 4E=2J 1c=26% k=\'1F:1B;21:3D;1F-48:1B;\'>";q+="<1r id=\'hZ"+9.b+"\' 2t=0 2u=0 1n=\'26%\' 1c=\'26%\' k=\'2m-2J:1B;\'><18 k=\'1n:26%;1c:26%\'><Y 1n=\'26%\' 1c=\'26%\' k=\'1F:1B;1s:1J 1a #6t;1s-45:2Q\'>";q+="<6u k=\'1n:26%;1c:26%;1s:2Q;\' "+" 4D=12"+9.b+" id=12"+9.b+"></6u>";q+="<6u k=\'6v:9D;6w:-dT;2J:-dT;1n:1a;1c:1a;7D:b6;\' "+" 4D=\'9E"+9.b+"\' id=\'9E"+9.b+"\'></6u>";q+="<6u k=\'1n:1a;1c:1a;7D:b6;1s:1B\' id=\\"3r"+9.b+"\\" 4D=\\"3r"+9.b+"\\" 4n=\'"+9.X+"i0.V\'></6u>";q+="</Y><Y id=2K"+9.b+" k=\'1F:1B;21:#3d\'></Y></18></1r>";q+="</Y></18>";q+="<18 id=dU"+9.b+"><Y 47=2 id=dV"+9.b+" k=\'1F:1B;\'></Y></18>";if(9.dl){q+="<18 id=i1"+9.b+"><Y 47=2 k=\'1F:1B;\'><3G k=\'2S:n-dW;\' 7E=\'i2\' i3=\\"dX(3H, 9, \'"+9.b+"\')\\" ></3G></Y></18>"}q+="</1r>";q+=dH;q+="<9F 4p=i4 4D=aU"+9.b+" id=aU"+9.b+" 6q=i5 k=\'2l:2Q\' >";if(7A){a b7=[];b7[0]=q;c.M(7A).1h=b7.dY("")}K{c.6V(q)}a me=9;b8(z(){me.cP()},10)};z dX(ev,i6,b){c.dZ=e0;c.e1=e2;c.i7=z(){N J};c.i8=z(){N J};c.1j.k.2S="n-dW";14.b9=1L(b);14.6x={x:ev.9G,y:ev.9H};if(!14.9I)14.9I=1m e3(b);14.9I.i9();ev.7F()};z e2(3H){14.9J={dx:3H.9G-14.6x.x,dy:3H.9H-14.6x.y};14.b9.7y(14.9J.dy);14.9I.ia();c.dZ=1g;c.e1=1g;c.1j.k.2S="3e"};z e0(3H){14.9J={dx:3H.9G-14.6x.x,dy:3H.9H-14.6x.y};14.b9.7y(14.9J.dy);14.6x={x:3H.9G,y:3H.9H}};z cQ(){if(9.9n){if(9.5p=="45")9.5p="2J";K 9.5p="45";9.6p()}a d=c.M("12"+9.b).15;14.b=9.b;14.d=d;14.11=9;14.2X.e4(9.b);2q{d.c.2N="1d"}2r(e){}a 3I=1q(9.6n).3J(/<5s[^>]*>/ig);if(3I){9.72(9.6n)}K{9.8y(9.6n)}if(!14.am){if(2s.ba)bb=2s.ba;2s.ba=1m 2H("e5()");14.am=E}9.1V();2q{a 9K=d.c.1j.1h;9K=9K.D(/\\s+/gi,"");if(9K==""){d.c.1j.1h="<br 7E=\\"bc\\" />"}a l=d.c.2g();l.2h(d.c.1j.17[0]);l.2Z(E);a 2i=d.1i();2i.2F();2i.2G(l)}2r(e){}5w(9.2P){C"9u":9.6o=9.5T();u;C"5s":9.6o=9.5U();u;C"7z":9.6o=9.5V();u;C"9v":9.6o=9.5W();u};9.1V()};z b3(O,G,bd){a b=G.b;Q(a i=0;i<bd.F;i++){6r=bd[i];5w(6r){C"|":O.ib();u;C"4t":O.ic();u;C"ax":if(G.55)O.1x("55"+b,"55.V",H("ax"));u;C"az":if(G.98){O.3f("98"+b,"e6"+b,"98.V",H("az"));a 3K=1m 3g("e6"+b);3K.28("e7"+b,"ie");3K.28("e8"+b,"ih");3K.28("e9"+b,"ii");3K.3q=z(id){3L(O,id,G,G.b)}}u;C"ay":if(G.7c)O.1x("7c"+b,"7c.V",H("ea ij"));u;C"aA":if(G.7d)O.1x("7d"+b,"7d.V",H("aA"));u;C"8T":if(G.7e)O.1x("7e"+b,"7e.V",H("8T"));u;C"cW":if(G.7f){if(G.9q!="aV")O.1x("7f"+b,"7f.V",H("ik il"))}u;C"aH":if(G.56||G.4w||G.57||G.58||G.63||G.64){O.3f("im"+b,"eb"+b,"io.V",H("95 & 6y"));a 49=1m 3g("eb"+b);49.2y=O.2y;49.3q=z(id){3L(O,id,G,G.b)};if(G.56)49.28("56"+b,H("9L 6y"),"56.V");if(G.4w)49.28("4w"+b,H("79 6y"),"4w.V");if(G.57)49.28("57"+b,H("ec 6y"),"57.V");if(G.58)49.28("58"+b,H("ip 6y"),"58.V");if(G.63)49.28("63"+b,H("9z ed"),"iq.V");if(G.64)49.28("64"+b,H("ed ir"))}u;C"95":if(G.99)O.1x("99"+b,"is.V",H("do iu"));u;C"79":if(G.4x){O.3f("4x"+b,"ee"+b,"4x.V",H("79"),37);a be=1m 3g("ee"+b);be.3q=z(id){3L(O,id,G,G.b)};Q(a j=0;j<G.6l.F;j++){be.28("iv"+j+b,"<"+G.6l[j][1]+" k=\\"\\2m-45:iw\\"  1u=1d> "+G.6l[j][0]+"</"+G.6l[j][1]+">")}}u;C"7a":if(G.4y){O.3f("4y"+b,"9M"+b,"4y.V",H("ef ix"),37);a bf=1m 3g("9M"+b);bf.3q=z(id){3L(O,id,G,G.b)};Q(a j=0;j<G.4C.F;j++){bf.28("eg"+j+b,"<2z k=\'2a-4a:"+G.4C[j]+"\' 1u=1d>"+G.4C[j]+"</2z><2z 1u=1d k=\'2a-4a:iy\'>("+G.4C[j]+")</2z>")}}u;C"7b":if(G.4z){O.3f("4z"+b,"9N"+b,"4z.V",H("ef 44"),37);a bh=1m 3g("9N"+b);bh.3q=z(id){3L(O,id,G,G.b)};Q(a j=0;j<G.5n.F;j++){bh.28("eh"+j+b,"<2a 1u=1d 1H=\\""+G.5n[j][1]+"\\">"+G.5n[j][0]+"</2a>")}}u;C"8U":if(G.42)O.1x("42"+b,"42.V",H("8U"));u;C"8V":if(G.43)O.1x("43"+b,"43.V",H("8V"));u;C"51":if(G.6e||G.65){O.3f("7g"+b,"ei"+b,"7g.V",H("51"));a 3K=1m 3g("ei"+b);3K.2y=O.2y;if(G.6e)3K.28("6e"+b,H("51 iz iA"),"6e.V");if(G.65)3K.28("65"+b,H("51 9L"),"65.V");3K.3q=z(id){3L(O,id,G,G.b)}}u;C"3Y":if(G.59)O.2T("59"+b,"",J,"59.V",H("3Y"));u;C"3Z":if(G.5a)O.2T("5a"+b,"",J,"5a.V",H("3Z"));u;C"41":if(G.5b)O.2T("5b"+b,"",J,"5b.V",H("41"));u;C"4u":if(G.5c)O.2T("5c"+b,"",J,"5c.V",H("4u"));u;C"4v":if(G.5d)O.2T("5d"+b,"",J,"5d.V",H("4v"));u;C"52":if(G.5e)O.2T("5e"+b,"",J,"5e.V",H("52"));u;C"5Z":if(G.67)O.2T("67"+b,"2A",J,"iB.V",H("9O bi"));u;C"60":if(G.68)O.2T("68"+b,"2A",J,"iC.V",H("9O iD"));u;C"61":if(G.69)O.2T("69"+b,"2A",J,"iE.V",H("9O bj"));u;C"62":if(G.6a)O.2T("6a"+b,"2A",J,"iF.V",H("9O ea"));u;C"96":if(G.5f)O.2T("5f"+b,"ej",J,"iG.V",H("96"));u;C"97":if(G.5g)O.2T("5g"+b,"ej",J,"iH.V",H("97"));u;C"53":if(G.5h)O.1x("5h"+b,"5h.V",H("53"));u;C"54":if(G.5i)O.1x("5i"+b,"5i.V",H("54"));u;C"d9":if(G.5j)O.2T("5j"+b,"35",J,"5j.V",H("bi ek bj"));u;C"da":if(G.5k)O.2T("5k"+b,"35",J,"5k.V",H("bj ek bi"));u;C"5Y":O.3f("6b"+b,"em"+b,"6b.V",H("iI eo"));a 4F=1m 3g("em"+b);4F.bk(1m bl("iJ",G.30.6z()));u;C"aD":O.3f("6c"+b,"ep"+b,"6c.V",H("iK eo"));a 4F=1m 3g("ep"+b);4F.bk(1m bl("iL",G.31.6z()));u;C"8W":if(G.7i)O.1x("7i"+b,"7i.V",H("8W"));u;C"8X":if(G.7h)O.1x("7h"+b,"7h.V",H("8X"));u;C"d8":if(G.5l){O.3f("5l"+b,"7G"+b,"5l.V",H("iM"),37);a 7G=1m 3g("7G"+b);7G.3q=z(id){3L(O,id,G,G.b)};Q(a j=0;j<G.7s.F;j++){7G.28("iN"+j+b,G.7s[j][0])}}u;C"77":if(G.7j)O.1x("7j"+b,"7j.V",H("77"));u;C"8Y":if(G.7k)O.1x("7k"+b,"7k.V",H("8Y"));u;C"8Z":if(G.7l)O.1x("7l"+b,"7l.V",H("8Z"));u;C"91":if(G.7p)O.1x("7p"+b,"7p.V",H("91"));u;C"cZ":if(G.6h)O.1x("6h"+b,"6h.V",H("iO iP"));u;C"d0":if(G.6i)O.1x("6i"+b,"6i.V",H("eq er"));u;C"d1":if(G.6k)O.1x("6k"+b,"6k.V",H("eq 77"));u;C"d2":if(G.6j)O.1x("6j"+b,"6j.V",H("dJ"));u;C"33":if(G.6d){a 4G=[],5x=0;4G[5x++]="<1r 1n=\'iQ\' id=\'bm"+b+"\' k=\'2S:3e;21:#9P;\' 2t=0 2u=1 1u=1d>";Q(a m=0;m<8;m++){4G[5x++]="<18>";Q(a n=0;n<8;n++){4G[5x++]="<Y 3s=\'"+b+".9o(9)\' 4H=\'es(9);3H.iR=E;\' k=\'21:#4I;2a-1H:1a;1s:#iS 1a 1J;1n:et;1c:et;\' 1u=1d>&2U;</Y>"}4G[5x++]="</18>"}4G[5x++]="<18><Y 47=8 3s=\\""+b+".1k();1y(\'"+G.X+"iT.1b\',eu,ew);\\" 4H=\\"ex(c.M(\'bm"+b+"\'));9.1h=\'"+H("9Q 33 6f")+"\';9.k.1s=\'#7H 1a 1J\';9.k.2B=\'#ey\';9.k.1A=\'#4I\'\\" 5y=\\"9.k.1s=\'#9P 1a 1J\';9.k.2B=\'#9P\';9.k.1A=\'#4b\'\\" 2A=4J k=\'2a-4a:7I;2a-1H:7J;1A:#4b;1s:#9P 1a 1J;1F:1a 1a 1a 1a\' 1u=1d>"+H("9Q 33 6f")+"</Y></18>";4G[5x++]="</1r>";O.3f("6d"+b,"4F"+b,"6d.V",H("6f 33"));a 4F=1m 3g("4F"+b);4F.bk(1m bl("iU",4G.dY("")));O.3f("bn"+b,"ez"+b,"bn.V",H("5z 33/eA"));a 6A=1m 3g("ez"+b);6A.2y=O.2y;6A.3q=z(id){3L(O,id,G,G.b)};6A.28("bo"+b,H("33 44"),"iV.V");6A.28("bp"+b,H("5z 33"),"iW.V");6A.28("7K"+b,H("5z eA"),"iX.V")}u;C"aE":if(G.7q)O.1x("7q"+b,"7q.V",H("aE"));u;C"aF":if(G.7m)O.1x("7m"+b,"7m.V",H("aF"));u;C"92":if(G.9a)O.1x("9a"+b,"iY.V",H("iZ 92"));u;C"93":if(G.5m)O.1x("5m"+b,"5m.V",H("93"));u;C"94":if(G.7n){a bq=[[H("94"),"eB.1b","7L","9R"],[H("9L bs"),"eC.1b","eD","eE"],[H("ec"),"eF.1b","eG","eH"],[H("j0"),"eI.1b","3M","6X"],[H("j1 eJ"),"eK.1b","3M","9R"],[H("j2 bs"),"eL.1b","3M","eM"],[H("j3 bs"),"eN.1b","3M","eO"],[H("eJ"),"eP.1b","3M","6X"]];O.3f("7n"+b,"7M"+b,"7n.V",H("94 j4"));a 7M=1m 3g("7M"+b);7M.3q=z(id){3L(O,id,G,G.b)};Q(a j=0;j<bq.F;j++){7M.28("7n"+j+b,bq[j][0])}}u;C"78":if(G.7o)O.1x("7o"+b,"7o.V",H("bt 6y"));u;C"d4":if(G.9b)O.1x("9b"+b,"9S.V",H("9T/5z 9U"));u;C"d5":if(G.9c)O.1x("9c"+b,"9S.V",H("9T/5z 9U"));u;C"d6":if(G.4A)O.1x("4A"+b,"9S.V",H("9T/5z 9U"));u;C"aG":if(G.4B)O.1x("4B"+b,"9S.V",H("9T/5z 9U"));u;C"d7":if(G.9d)O.1x("9d"+b,"j5.V",H("j6 j7"));u;3e:Q(j=0;j<G.3p.F;j++){if(6r==G.3p[j][0]){bu=G.3p[j][0];bv=G.3p[j][2];bw=G.3p[j][3];if(G.3p[j][4])O.1x(bu+b,bw,bv,G.3p[j][4]);K O.1x(bu+b,bw,bv)}}u}}};z cV(s){N c.M(s+9.b)};z e5(){bb()};z bb(){};a 7N=[];z aw(7O,7P){9.eQ=7P;if(7P){9.b=7P+"."+7O;9.4K=7O+7P}K{9.b=7O;9.4K=7O}7N.e4(9.b);9.2I="j8.1b";9.b0=z(){N E};9.eR=z(){N E};9.7C=z(){N E};9.9x=z(){N E};9.9w=z(){N E};9.9V=eS;9.1k=eT;9.9W=eU;9.1A;9.4s=[];9.9X=9X;9.bx=J;9.9y="9z 6s";9.9A="b1 6s...";9.2A="6w";9.by="#4I";9.6z=6z;9.71=eV};z 6z(){a 6B=[["#j9","#ja","#jb","#jc","#jd","#je","#jf","#4b"],["#jg","#jh","#ji","#eW","#jj","#jk","#jl","#jm"],["#jn","#jo","#jp","#jq","#jr","#jt","#ju","#jv"],["#jw","#jx","#jy","#jz","#jA","#jB","#jC","#jD"],["#jE","#jF","#jG","#jH","#jI","#jJ","#jK","#4I"]];a 36="<1r id=bz"+9.4K+" k=\\"2S:3e;21-1A:#3d;1F:bA\\" 1u=1d 2t=0 2u=0 1n=jL><18><Y 1u=1d k=\'1F:1B;\'>";36+="<1r 2A=4J 2t=0 2u=0 1s=0 1u=1d>";Q(a i=0;i<6B.F;i++){36+="<18>";Q(a j=0;j<6B[i].F;j++)36+="<Y 3s=\\""+9.b+".1A=\'"+6B[i][j]+"\';"+9.b+".7C();"+9.b+".by=\'"+6B[i][j]+"\';"+9.b+".9W()\\" 4H=\\"9.k.1s=\'#7H 1a 1J\'\\" 5y=\\"9.k.1s=\'#3d 1a 1J\'\\" k=\\"1F:1B;2S:3e;1F:1a;1s:#3d 1a 1J;\\" 1u=1d>"+"<1r k=\'2m:1B;1n:9Y;1c:9Y;21:"+6B[i][j]+";1s:3D 1a 1J\' 2t=0 2u=0 1u=1d>"+"<18><Y 1u=1d k=\'1F:1B;\'></Y></18>"+"</1r></Y>";36+="</18>"}36+="<18><Y 47=8 id=bB"+9.4K+" k=\'1F:1B;\'></Y></18>";36+="<18>";36+="<Y 1u=1d k=\'1F:1B;\'>"+"<1r k=\'1F:1B;2m-6w:1a;1n:9Z;1c:9Z;21:#3d;\' 2t=0 2u=0 1u=1d>"+"<18><Y 3s=\\""+9.b+".9x();"+9.b+".by=\'\';"+9.b+".9W()\\" 4H=\\"9.k.1s=\'#7H 1a 1J\'\\" 5y=\\"9.k.1s=\'3D 1a 1J\'\\" k=\\"2S:3e;1F:1a;1s:3D 1a 1J;2a-4a:7I;2a-1H:7J;1A:#4b;3h-1c:6C;\\" 2A=4J 4E=2J 1u=1d>x</Y></18>"+"</1r></Y>";36+="<Y 47=7 1u=1d k=\'1F:1B;\'>"+"<1r k=\'1F:1B;2m:1a;1n:jM;1c:jN;21:#3d;1s:3D 1a 1J\' 2t=0 2u=0 1u=1d>"+"<18><Y id=\\""+9.b+"jO\\" 3s=\\""+9.b+".9w();"+9.b+".9W();1y(\'"+9.2I+"?"+9.b+"\', jP, eX, 2s,{\'b\':\'"+9.b+"\'})\\" 4H=\\"9.k.1s=\'#7H 1a 1J\';9.k.21=\'#ey\';9.k.1A=\'#4I\'\\" 5y=\\"9.k.1s=\'#3d 1a 1J\';9.k.21=\'#3d\';9.k.1A=\'#4b\'\\" k=\\"2S:3e;2a-4a:7I;2a-1H:6C;1A:#4b;3h-1c:6C;1F:1a\\" 2A=4J 4E=2J 5A 1u=1d>"+9.9A+"</Y></18>"+"</1r></Y>";36+="</18>";36+="</1r>";36+="</Y></18></1r>";N 36};z eV(){c.6V(9.6z())};z 9X(){9.4s=1L(9.eQ).4s;if(9.4s.F==0){c.M("bB"+9.4K).1h="";N}q="<1r 2t=0 2u=0 1n=26%><18><Y 47=8 k=\\"2a-4a:7I;2a-1H:6C;1A:#4b;3h-1c:6C;1F:1a\\">"+9.9y+":</Y></18></1r>";q+="<1r 2t=0 2u=0><18>";Q(a i=0;i<9.4s.F;i++){if(i<22){if(i==8||i==16||i==24||i==32)q+="</18></1r><1r 2t=0 2u=0><18>";q+="<Y 3s=\\""+9.b+".1A=\'"+9.4s[i]+"\';"+9.b+".7C()\\" 4H=\\"9.k.1s=\'#7H 1a 1J\'\\" 5y=\\"9.k.1s=\'#3d 1a 1J\'\\" k=\\"2S:3e;1F:1a;1s:#3d 1a 1J;\\" 1u=1d>"+"   <1r  k=\'2m:1B;1n:9Y;1c:9Y;21:"+9.4s[i]+";1s:3D 1a 1J\' 2t=0 2u=0 1u=1d>"+"   <18><Y 1u=1d></Y></18>"+"   </1r>"+"</Y>"}}q+="</18></1r>";c.M("bB"+9.4K).1h=q};z eS(1S){9.9X()};z eT(){9.eR();N;a 7Q=c.M("bz"+9.4K);7Q.k.2l="2Q";9.bx=J};z eU(){N;Q(a i=0;i<7N.F;i++){a 7Q=c.M("bz"+1L(7N[i]).4K);7Q.k.2l="2Q";1L(7N[i]).bx=J}};z 8y(q){a d=c.M("12"+9.b).15;a 4c=d.c.bC("5B/2O");if(9.75!=""){a 3I=1q(9.6n).3J(/<bD[^>]*>/ig);if(!3I){q=9.5o+"<2O><3N><bD a0=\\""+9.75+"\\"/>"+9.aS+"</3N><1j>"+q+"</1j></2O>"}}K{q=9.5o+"<2O><3N>"+9.aS+"</3N><1j>"+q+"</1j></2O>"}4c.6V(q);4c.bE();a me=9;d.c.5C("eY",1m 2H("bF("+9.b+")"),E);d.c.5C("eZ",z(e){bG(e,me.b)},E);d.c.5C("f0",1m 2H("a e=f1[0];bH(1L(e), "+9.b+")"),J);if(9.1G.F>0){a R=d.c.3C("6D");d.c.3O.17[0].5D(R);a 2L="";Q(a i=0;i<9.1G.F;i++){a1=9.1G[i][0];k=9.1G[i][3];2L+=a1+" { "+k+" } "}R.5D(d.c.bI(2L))}a 4d=d.c.3C("bJ");4d.a0=9.X+"bK.5X";4d.4L="f2";4d.id="bL";d.c.3O.17[0].5D(4d);if(9.5X!=""){4d=d.c.3C("bJ");4d.a0=9.5X;4d.4L="f2";d.c.3O.17[0].5D(4d)}9.3W()};z 72(q,f3){a d=c.M("12"+9.b).15;a 3I=1q(q).3J(/<!jQ[^>]*>/ig);if(3I)Q(a i=0;i<3I.F;i++){9.5o=3I[i]}K 9.5o="";a a2=1q(q).3J(/<5s[^>]*>/ig);if(a2)Q(a i=0;i<a2.F;i++){s=a2[i];s=s.D(/\\"[^\\"]*\\"/ig,z(x){x=x.D(/&/g,"&2R;").D(/</g,"&lt;").D(/>/g,"&gt;").D(/\'/g,"&f4;").D(/\\s+/ig,"#3a#");N x});s=s.D(/<([^ >]*)/ig,z(x){N x.2w()});s=s.D(/ ([^=]+)=([^" >]+)/ig," $1=\\"$2\\"");s=s.D(/ ([^=]+)=/ig,z(x){N x.2w()});s=s.D(/#3a#/ig," ");9.2O=s}K 9.2O="<2O>";if(9.75!=""){a 3I=q.3J(/<bD[^>]*>/ig);if(!3I){q="<6E jR=\\""+9.75+"\\"/>"+q}}if(f3){2q{d.c.2N="1d"}2r(e){}}a de=d.c.3O;a 5P=/<3N>([\\S\\s]*?)<\\/3N>/gi;a bM=5P.jS(q),6F="";if(bM)6F=bM[1];if(6F.1K("bK.5X")==-1){6F=6F+"<bN id=\'bL\' 4L=\'jT\' a0=\'"+9.X+"bK.5X"+"\' />"}q=q.D(5P,"<3N>"+6F+"</3N>");a 4c=d.c.bC("5B/2O","D");4c.6V(q);4c.bE();a me=9;d.c.5C("eY",1m 2H("bF("+me.b+")"),E);d.c.5C("eZ",z(e){bG(e,me.b)},E);d.c.5C("f0",1m 2H("a e=f1[0];bH(1L(e), "+9.b+")"),J);9.3W()}z ar(q){9.72(q,E)};z 7R(q){N q.D(/&/g,"&2R;").D(/</g,"&lt;").D(/>/g,"&gt;")};z 7S(q){a h=q.D(/<br 7E="bc" \\/>/gi,"").D(/<br 7E="bc">/gi,"");a 7T=h.3J(/<bN[^>]*>/ig);if(7T){Q(a i=0;i<7T.F;i++){if(7T[i].1K("bL")!=-1){h=h.D(1m cE(7T[i],"gi"),"")}}}N h};z aq(){a d=c.M("12"+9.b).15;a a3=d.c.1j.jU;a3=a3.D(/<!(?:--[\\s\\S]*?--\\s*)?>\\s*/gi,"");N a3};z 5U(){a d=c.M("12"+9.b).15;9.3W();q=3P(d.c.3O);q=1q(q).D(/ f5=E/gi,"");q=9.5o+q;q=14.6Z(q);if(9.7x)q=7R(q);q=7S(q);N q};z 5T(){a d=c.M("12"+9.b).15;9.3W();q=d.c.1j.1h;q=1q(q).D(/ f5=E/gi,"");q=14.6Z(q);if(9.7x)q=7R(q);q=7S(q);N q};a 2C="";z 5W(){a d=c.M("12"+9.b).15;9.3W();q=3P(d.c.3O);a 4e=q.3J(/<6E([^>]*)>/ig);if(4e!=1g)2C=4e[0];a 3Q=d.c.1O("6E");if(3Q.F!=1g){Q(a i=0;i<3Q.F;i++){3Q[i].1v.7U(3Q[i])}}2C=2C.D(/<([^ >]*)/ig,z(x){N x.2w()});2C=2C.D(/ [^=]+="[^"]+"/ig,z(x){x=x.D(/\\s+/ig,"#3a#");x=x.D(/^#3a#/," ");N x});2C=2C.D(/ ([^=]+)=([^" >]+)/ig," $1=\\"$2\\"");2C=2C.D(/ ([^=]+)=/ig,z(x){N x.2w()});2C=2C.D(/#3a#/ig," ");2C=2C.D(/>$/ig," \\/>").D(/\\/ \\/>$/ig,"\\/>");q=7V(d.c.3O,"");q=9.5o+9.2O+q+"\\n</2O>";q=q.D(/<3N>/i,"<3N>"+2C);q=14.6Z(q);if(9.7x)q=7R(q);q=7S(q);N q};z 5V(){a d=c.M("12"+9.b).15;9.3W();q=3P(d.c.3O);a 4e=q.3J(/<6E([^>]*)>/ig);if(4e!=1g)2C=4e[0];a 3Q=d.c.1O("6E");if(3Q.F!=1g){Q(a i=0;i<3Q.F;i++){3Q[i].1v.7U(3Q[i])}}q=7V(d.c.1j,"");q=14.6Z(q);if(9.7x)q=7R(q);q=7S(q);N q};z jV(b){a 1Y="";a 3r=c.M("3r"+b).15;Q(a i=0;i<3r.c.7W[0].6G.F;i++){a 1Q=3r.c.7W[0].6G[i].f6;if(1Q!=a4){2L=3r.c.7W[0].6G[i].k.bO.D(/"/g,"&a5;");a a6=1Q.4f(".").F;if(a6>1){6H=1Q.4f(".")[1];1Y+=",[\\""+1Q+"\\",E,\\""+6H+"\\",\\""+2L+"\\"]"}K 1Y+=",[\\""+1Q+"\\",J,\\"\\",\\""+2L+"\\"]"}}a 1G=1L("["+1Y.3n(1)+"]");if(1G.F>0){a d=c.M("12"+b).15;a R=d.c.3C("6D");d.c.3O.17[0].5D(R);a 2L="";Q(a i=0;i<1G.F;i++){a1=1G[i][0];k=1G[i][3].D(/&a5;/g,"\\"");2L+=a1+" { "+k+" } "}R.5D(d.c.bI(2L))}};z f7(b){a d=c.M("12"+b).15;a 1Y="";Q(a j=0;j<d.c.7W.F;j++){a 3r=d.c.7W[j];Q(a i=0;i<3r.6G.F;i++){1Q=3r.6G[i].f6;if(1Q!=a4){if(1Q.3J(/1r\\./gi)){a7}2L=3r.6G[i].k.bO.D(/"/g,"&a5;");a a6=1Q.4f(".").F;if(a6>1){6H=1Q.4f(".")[1];1Y+=",[\\""+1Q+"\\",E,\\""+6H+"\\",\\""+2L+"\\"]"}K 1Y+=",[\\""+1Q+"\\",J,\\"\\",\\""+2L+"\\"]"}}}a 1G=1L("["+1Y.3n(1)+"]");a 1U=1L(b);Q(a i=0;i<1G.F;i++){Q(a j=0;j<1U.1G.F;j++){if(1G[i][0].2w()==1U.1G[j][0].2w()){1G[i][1]=1U.1G[j][1];u}}}1U.1G=1G};z f8(b,2b){a d=c.M("12"+b).15;a L=d.1i();1L(b).1I();a 1l;if(14.3T){1l=14.3T;1l.3o=2b}K{1l=2x(L);if(7X(L)){if(L!=""){1L(b).8C([],2b)}K{if(1l.1o=="3i")N;1l.3o=2b}}K{if(1l.1o=="3i")N;1l.3o=2b}}34(1L(b))};z 7r(){if(!9.aP)f7(9.b);9.aP=E;a 2K=c.M("2K"+9.b);if(2K.1h!=""){if(2K.k.2l=="")2K.k.2l="2Q";K 2K.k.2l="";N}2K.k.2l="";a h=c.M("12"+9.b).f9-27;a 1G=9.1G;a q="";q+="<3G 1u=1d k=\'2m:bP;2m-2J:0;2m-48:0\' 2A=48>";q+="<1r k=\'2m:1a;2m-2J:bA;2m-45:jW;1n:9Z;1c:9Z;21:#jX;\' 2t=0 2u=0 1u=1d>"+"<18><Y 3s=\\""+9.b+".7r();\\" 4H=\\"9.k.1s=\'#eW 1a 1J\';9.k.1A=\'3D\';9.k.2B=\'jY\'\\" 5y=\\"9.k.1s=\'3D 1a 1J\';9.k.1A=\'bQ\';9.k.2B=\'\'\\" k=\\"2S:3e;1F:1a;1s:3D 1a 1J;2a-4a:7I;2a-1H:7J;1A:#4b;3h-1c:6C;\\" 2A=4J 4E=2J 1u=1d>x</Y></18>"+"</1r>";a bR="";Q(a i=0;i<1G.F;i++){1Q=1G[i][0];if(1Q=="1j")bR=1G[i][3]}q+="<3G 1u=1d k=\'7D:b6;1n:jZ;1c:"+h+"3t;\'>";q+="<1r 4D=\'bS"+9.b+"\' id=\'bS"+9.b+"\' 2t=0 2u=0 k=\'21:#k0;"+bR+";1c:26%;1n:26%;2m:0;\'>";Q(a i=0;i<1G.F;i++){1Q=1G[i][0];fa=1G[i][1];2L=1G[i][3];6H=1G[i][2];if(fa){if(1Q.4f(".").F>1){a bT=1Q;if(1Q.1K(":")>0)bT=1Q.1R(0,1Q.1K(":"));q+="<18 k=\\"2S:3e\\" 4H=\\"if(9.k.a8!=\'1a\'){9.k.21=\'"+9.as+"\';9.k.1A=\'"+9.at+"\'}\\" 5y=\\"if(9.k.a8!=\'1a\'){9.k.21=\'\';9.k.1A=\'\'}\\">";q+="<Y 1u=1d 3s=\\"f8(\'"+9.b+"\',\'"+bT.4f(".")[1]+"\')\\" k=\'1F:bA\'>";if(1Q.4f(".")[0]=="")q+="<2z 1u=1d k=\\""+2L+";2m:0;\\">"+6H+"</2z>";K q+="<2z 1u=1d k=\\""+2L+";2m:0;\\">"+1Q+"</2z>";q+="</Y></18>"}}}q+="<18><Y 1c=26%>&2U;</Y></18></1r></3G>";q+="</3G>";c.M("2K"+9.b).1h=q};z 8A(){a d=c.M("12"+9.b).15;a 5E=d.c.1j.1O("6I");if(5E.F==0)N J;a f;a l;2Y(5E.F>0){f=5E[0];if(f.bU&&f.17.F==1&&f.17[0].1P==1&&f.17[0].2c=="2V"){a 1M=f.17[0];4M(1M,f);l=d.c.2g();l.2h(f);l.4N(1M);l.2h(f);l.a9()}K if(f.1v.2c=="2V"&&f.1v.17.F==1){a 1M=f.1v;4M(1M,f);1M.1h=f.1h}K{a 1p=d.c.3C("2V");4M(1p,f);1p.1h=f.1h;f.1v.7Y(1p,f)}}N E};z 3E(1N,3b){a d=c.M("12"+9.b).15;if(1N.F==0)N J;a f;a l;2Y(1N.F>0){f=1N[0];if(f.bU&&f.17.F==1&&f.17[0].1P==1&&f.17[0].2c=="2V"){a 1M=f.17[0];if(3b=="4O")1M.k.bV="4O";if(3b=="4P")1M.k.bW="4P";if(3b=="3h-4Q")1M.k.6J="3h-4Q";if(3b=="3u")1M.k.6J="3u";l=d.c.2g();l.2h(f);l.4N(1M);l.2h(f);l.a9()}K if(f.1v.2c=="2V"&&f.1v.17.F==1){a 1M=f.1v;if(3b=="4O")1M.k.bV="4O";if(3b=="4P")1M.k.bW="4P";if(3b=="3h-4Q")1M.k.6J="3h-4Q";if(3b=="3u")1M.k.6J="3u";1M.1h=f.1h}K{a 1p=d.c.3C("2V");if(3b=="4O")1p.k.bV="4O";if(3b=="4P")1p.k.bW="4P";if(3b=="3h-4Q")1p.k.6J="3h-4Q";if(3b=="3u")1p.k.6J="3u";1p.1h=f.1h;f.1v.7Y(1p,f)}}N E};z 4r(fb,fc){a d=c.M("12"+9.b).15;a 1N=d.c.1j.1O(fb);2Y(1N.F>0){f=1N[0];a 1p=d.c.3C(fc);1p.1h=f.1h;f.1v.7Y(1p,f)}};z 3W(){a d=c.M("12"+9.b).15;a 1N;1N=d.c.1j.1O("bX");9.3E(1N,"4O");1N=d.c.1j.1O("B");9.3E(1N,"4O");1N=d.c.1j.1O("I");9.3E(1N,"4P");1N=d.c.1j.1O("fd");9.3E(1N,"4P");1N=d.c.1j.1O("fe");9.3E(1N,"3h-4Q");1N=d.c.1j.1O("S");9.3E(1N,"3h-4Q");1N=d.c.1j.1O("U");9.3E(1N,"3u");9.4r("ff","3V");9.4r("fg","3V");9.4r("k1","3V");9.4r("k2","9k");9.4r("fh","2V");1N=d.c.1j.1O("k3");2Y(1N.F>0){a f=1N[0];5F=f.1v;5F.7U(f)}9.8A();9.8z();N E};z 8C(2D,2b,3j){a 2W="2V";if(3j!=1g&&3j!="")2W=3j;a d=c.M("12"+9.b).15;a L=d.1i();a l;a R;if(!7X(L)){l=L.2k(0);R=2x(L);if(R.2c==2W)N R;N}9.1k();9.1D("fi","0");bY(d,2D,2b,2W);34(9)};z 8B(){9.1I();if(14.3T)a 1l=14.3T;K{a d=c.M("12"+9.b).15;a L=d.1i();1l=2x(L);if(7X(L)){if(L!=""){a l=L.2k(0);if(1l.1h!=l.5G()){9.1D(\'78\');34(9);N}}K{if(1l.1o=="3i")N}}K{if(1l.1o=="3i")N}}1l.3R("3o");1l.3R("k");if(1l.1o=="9e"||1l.1o=="9f"||1l.1o=="9g"||1l.1o=="9h"||1l.1o=="9i"||1l.1o=="9j"||1l.1o=="9k"||1l.1o=="P"||1l.1o=="3V"){9.1D(\'bZ\',\'<P>\')}9.1D(\'78\');34(9)};z 8z(){a c0=J;a d=c.M("12"+9.b).15;a 5P=/<\\s*2V\\s*>/gi;2Y(E){a 7Z=d.c.1O("2V");if(7Z.F==0)u;a 6K=[];Q(a i=0;i<7Z.F;i++){if(3P(7Z[i]).80(5P)==0)6K[6K.F]=7Z[i]}if(6K.F==0)u;a 1M,5F;Q(a i=0;i<6K.F;i++){1M=6K[i];5F=1M.1v;if(!5F)a7;if(1M.bU()){a l=d.c.2g();l.ao(1M);a 3k=l.fj();5F.7Y(3k,1M)}K{5F.7U(1M)}c0=E}}N c0};z 81(1p,2D,2b){if(2D){Q(a i=0;i<2D.F;i++){1p.k[2D[i][0]]=2D[i][1]}if(1p.k.bO=="")1p.3R("k",0)}if(2b)1p.3o=2b};z 4M(1p,f){if((f.c1!=1g)&&(f.c1!=""))1p.k.k4=f.c1;if((f.1H!=1g)&&(f.1H!="")){a 2n="";if(f.1H==1)2n="fk";K if(f.1H==2)2n="fl";K if(f.1H==3)2n="fm";K if(f.1H==4)2n="fn";K if(f.1H==5)2n="fo";K if(f.1H==6)2n="fp";K if(f.1H>=7)2n="fq";K if(f.1H<=-2||f.1H=="0")2n="fk";K if(f.1H=="-1")2n="fl";K if(f.1H==0)2n="fm";K if(f.1H=="+1")2n="fn";K if(f.1H=="+2")2n="fo";K if(f.1H=="+3")2n="fp";K if(f.1H=="+4"||f.1H=="+5"||f.1H=="+6")2n="fq";K 2n="";if(2n!="")1p.k.k5=2n}if((f.k.2B!=1g)&&(f.k.2B!=""))1p.k.2B=f.k.2B;if((f.1A!=1g)&&(f.1A!=""))1p.k.1A=f.1A;if((f.3o!=1g)&&(f.3o!=""))1p.3o=f.3o};z bY(d,2D,2b,3j){a 2W="2V";if(3j!=1g&&3j!="")2W=3j;a L=d.1i();a l=L.2k(0);a aa=82(l.2o,"6I");if(aa==1g)aa=l.2o.6L;aa.c2("c3","9");a 83=82(l.6M,"6I");if(83==1g)83=l.6M.k6;if(83!=1g)83.c2("c4","9");a 4R=l.2o;a 84=l.6M;a 5E=d.c.1O("6I");a 1p=1g;a f=1g;2Y(5E.F>0){f=5E[0];if(f.17&&f.17.F==1&&f.17[0].1P==1&&f.17[0].2c==2W){1p=f.17[0];a 3S=1p.1O(2W);if(3S){Q(a j=0;j<3S.F;j++){if(2D||2b)81(3S[j],2D,2b);K 4M(3S[j],f)}}if(2D||2b)81(1p,2D,2b);K 4M(1p,f);l=d.c.2g();if(f.87("c3")=="9")4R=1p;if(f.87("c4")=="9")84=1p;l.2h(f);l.4N(1p);l.2h(f);l.a9()}K{a 3S=f.1O(2W);if(3S){Q(a j=0;j<3S.F;j++){if(2D||2b)81(3S[j],2D,2b);K 4M(3S[j],f)}}1p=d.c.3C(2W);1p.1h=f.1h;if(2D||2b)81(1p,2D,2b);K 4M(1p,f);if(f.87("c3")=="9")4R=1p;if(f.87("c4")=="9")84=1p;f.1v.7Y(1p,f)}}l=d.c.2g();l.88(4R.17[0],0);a 3v=84.17[84.17.F-1];a ab=0;if(3v.1P==2v.3w){ab=3v.3c.F}K{ab=3v.17.F}l.89(3v,ab);L=d.1i();L.2F();L.2G(l)};z bF(G){if(G.8a){k7(G.8a);G.8a=1g}if(!G.8a)G.8a=b8(z(){34(G)},k8)};z bG(e,b){a 1U=1L(b);a fr=c.M("12"+1U.b);14.3T=1g;14.b=b;14.d=fr.15;14.11=1U;1U.1k();34(1U)};z 4S(1U){14.b=1U.b;14.d=c.M("12"+1U.b).15;14.11=1U};a 4e=[];z 82(R,fs){2Y(R!=1g&&R.1o!=fs){if(R.1o=="3i")N 1g;R=R.1v}N R};a 5H=[];z 34(1U){2q{a b=1U.b;a d=c.M("12"+b).15;a L=d.1i();a 1l=2x(L);a 11=1U;a 1e=11.1e;a T=1g;if(11.6d){a T=1e.1E["bn"+b];a 6N=8b[T.k9];6N.8c("bo"+b,E);6N.8c("bp"+b,E);6N.8c("7K"+b,E);a 4g=82(1l,"8d");if(4g){6N.8c("7K"+b,J);T.1z(1)}K T.1z(5);a 4h=82(1l,"ft");if(4h){6N.8c("7K"+b,E)}}a 1C=d.c;if(11.4x){T=1e.1E["4x"+b];T.1z(1C.2p("bZ")?1:5)}if(11.4y){T=1e.1E["4y"+b];T.1z(1C.2p("7a")?1:5)}if(11.4z){T=1e.1E["4z"+b];T.1z(1C.2p("7b")?1:5)}if(11.7g){T=1e.1E["7g"+b];T.1z(1C.2p("51")?1:5)}if(11.42){T=1e.1E["42"+b];T.1z(!11.3F[0]?5:1)}if(11.43){T=1e.1E["43"+b];T.1z(!11.7u[0]?5:1)}if(11.59){T=1e.1E["59"+b];T.1z(1C.2p("3Y")?(1C.3l("3Y")?4:1):5)}if(11.5a){T=1e.1E["5a"+b];T.1z(1C.2p("3Z")?(1C.3l("3Z")?4:1):5)}if(11.5b){T=1e.1E["5b"+b];T.1z(1C.2p("41")?(1C.3l("41")?4:1):5)}if(11.5c){T=1e.1E["5c"+b];T.1z(1C.2p("4u")?(1C.3l("4u")?4:1):5)}if(11.5d){T=1e.1E["5d"+b];T.1z(1C.2p("4v")?(1C.3l("4v")?4:1):5)}if(11.5e){T=1e.1E["5e"+b];T.1z(1C.2p("52")?(1C.3l("52")?4:1):5)}if(11.5f){T=1e.1E["5f"+b];T.1z(1C.2p("c5")?(1C.3l("c5")?4:1):5)}if(11.5g){T=1e.1E["5g"+b];T.1z(1C.2p("fu")?(1C.3l("fu")?4:1):5)}if(11.67){T=1e.1E["67"+b];T.1z(1C.2p("5Z")?(1C.3l("5Z")?4:1):5)}if(11.68){T=1e.1E["68"+b];T.1z(1C.2p("60")?(1C.3l("60")?4:1):5)}if(11.69){T=1e.1E["69"+b];T.1z(1C.2p("61")?(1C.3l("61")?4:1):5)}if(11.6a){T=1e.1E["6a"+b];T.1z(1C.2p("62")?(1C.3l("62")?4:1):5)}if(11.5h){T=1e.1E["5h"+b];T.1z(1C.2p("53")?1:5)}if(11.5i){T=1e.1E["5i"+b];T.1z(1C.2p("54")?1:5)}if(11.5j){T=1e.1E["5j"+b];T.1z(1l.35?(1l.35.2w()=="b5"?4:1):1)}if(11.5k){T=1e.1E["5k"+b];T.1z(1l.35?(1l.35.2w()=="fv"?4:1):1)}a v=(1l?1:5);if(11.6b)1e.1E["6b"+b].1z(v);if(11.6c)1e.1E["6c"+b].1z(v);if(11.5m)1e.1E["5m"+b].1z(v);2q{14.8t()}2r(e){}2q{11.8t()}2r(e){}a 2K=c.M("2K"+b);if(2K.1h!=""){a R;if(14.3T)R=14.3T;K R=2x(L);a fw=R.3o;a 4i=c.M("bS"+b).2d;Q(a i=0;i<4i.F-1;i++){6O=4i[i].17[0].17[0].1h;if(6O.4f(".").F>1&&6O!="")6O=6O.4f(".")[1];if(fw==6O){4i[i].k.a8="1a";4i[i].k.2B=11.as;4i[i].k.1A=11.at}K{4i[i].k.a8="";4i[i].k.2B="";4i[i].k.1A=""}}}if(11.9n){R=1l;a q="";a i=0;5H=[];2Y(R!=1g&&R.1o!="3i"&&R.1P==1){5H[i]=R;q="&2U; &lt;<2z id=1f"+b+i+" 1u=1d k=\'5B-ac:3u;2S:c6\' 3s=\\""+b+".7v("+i+")\\">"+R.1o+"</2z>&gt;"+q;R=R.1v;i++}q="&2U;&lt;3i&gt;"+q;c.M("c7"+b).1h=q;c.M("ad"+b).k.2l="2Q";Q(i=0;i<5H.F;i++){c.M("1f"+b+i).5C("dw",1m 2H(b+".7v("+i+")"),E)}}}2r(e){}};z fx(b){a d=c.M("12"+b).15;a fy=d.c.fz("7a");a 2e=1L(b);a 6P=J;Q(a i=0;i<2e.4C.F;i++){if(fy==2e.4C[i]){6P=E;u}}if(6P){8b["9M"+b].fA("eg"+i+b,E)}K{8b["9M"+b].fB()}};z fC(b){a d=c.M("12"+b).15;a fD=d.c.fz("7b");a 2e=1L(b);a 6P=J;Q(a i=0;i<2e.5n.F;i++){if(fD==2e.5n[i][1]){6P=E;u}}if(6P){8b["9N"+b].fA("eh"+i+b,E)}K{8b["9N"+b].fB()}};z 6p(){a 2E=c.M("5v"+9.b);a c8=2E.ka-90;a b4=9.X.1R(0,9.X.1K("3m/"))+9.2y;a fE="<1r 1u=1d fF=\'"+9.b+".6p()\' 1n=\'26%\' 2t=0 2u=0 k=\'1s:#6t 1a 1J;1s-45:2Q\'><18 k=\'21-1A:#3d;2a-4a:fG;2a-1H:7J;1A:bQ;\'>"+"<Y id=c7"+9.b+" k=\'1F:1a;1n:"+c8+"3t\' 4E=2J>&2U;</Y>"+"<Y 2A=48 4E=\'4J\' 5A>"+"<2z id=ad"+9.b+" 1u=1d k=\'fH-2A:fI;2l:2Q;5B-ac:3u;2S:c6;1F-48:bP;\' 3s=\'"+9.b+".7w()\'>"+H("bt fJ")+"</2z>"+"</Y></18></1r>";a fK="<1r 1u=1d fF=\'"+9.b+".6p()\' 1n=\'26%\' 2t=0 2u=0 k=\'1s-6w:#6t 1a 1J;1s-48:#6t 1a 1J;\'><18 k=\'21-1A:#3d;2a-4a:fG;2a-1H:7J;1A:bQ;\'>"+"<Y id=c7"+9.b+" k=\'1F:1a;1n:"+c8+"3t\' 4E=2J>&2U;</Y>"+"<Y 2A=48 4E=\'4J\' 5A>"+"<2z id=ad"+9.b+" 1u=1d k=\'fH-2A:fI;2l:2Q;5B-ac:3u;2S:c6;1F-48:bP;\' 3s=\'"+9.b+".7w()\'>"+H("bt fJ")+"</2z>"+"</Y></18></1r>";a c9=c.M("dS"+9.b);a ca=c.M("dR"+9.b);a cb=c.M("dV"+9.b);a cc=c.M("dU"+9.b);if(9.5p=="2J"){c9.1h="";cb.1h=fK;ca.k.2l="2Q";cc.k.2l="";9.5p="45"}K{c9.1h=fE;cb.1h="";ca.k.2l="";cc.k.2l="2Q";9.5p="2J"}};z 7v(i){if(!9.9n)N;a d=c.M("12"+9.b).15;a l=d.c.2g();l.2h(5H[i]);a L=d.1i();L.2F();L.2G(l);5I=5H[i];if(5I.1o!="ft"&&5I.1o!="fL"&&5I.1o!="fM"&&5I.1o!="kb")c.M("ad"+9.b).k.2l="";Q(a j=0;j<5H.F;j++)c.M("1f"+9.b+j).k.21="";c.M("1f"+9.b+i).k.21="kc";if(5I)14.3T=5I;9.1V()};z 7w(){9.1I();a d=c.M("12"+9.b).15;a L=d.1i();a 1l=2x(L);a cd=1l.6L==1g?(1l.fN==1g?1l.1v:1l.fN):1l.6L;5w(1l.2c){C"8d":;C"ce":;C"fO":;C"fP":;C"fQ":1l.1v.7U(1l);u;3e:L=d.1i();a l=L.2k(0);a 3k=l.cf(1l.1h);l.a9();l.4N(3k);2q{d.c.2N="1d"}2r(e){}u}L=d.1i();L.2F();a l=d.c.2g();l.88(cd,0);l.89(cd,0);L.2G(l);9.1V();34(9)};z 1D(3x,fR){if(3x=="3Y"||3x=="3Z"||3x=="41"||3x=="4u"||3x=="4v"||3x=="52"||3x=="53"||3x=="54"||3x=="fS")9.1I();a d=c.M("12"+9.b).15;d.c.cg(3x,J,fR);34(9)};z 4Z(6W,8e){9.1k();9.1V();a d=c.M("12"+9.b).15;9.1I();if(8e!=1g&&8e!=""){d.c.cg(6W,J,8e);a 2i=d.1i();a l=2i.2k(0);if(l.2o.1P==2v.3w){a el=l.2o.6L;if(el){l=d.c.2g();l.2h(el);2i=d.1i();2i.2F();2i.2G(l)}}}K{a el=2x(d.1i());if(6W=="5Y"){el.k.1A=""}K if(6W=="dI"){el.k.2B=""}}34(9);if(8e=="")N};z 8D(6Q){a d=c.M("12"+9.b).15;a L=d.1i();9.1k();9.1I();9.1D("bZ",6Q)};z 8E(6Q){a d=c.M("12"+9.b).15;a L=d.1i();9.1k();9.1I();9.1D("kd",6Q)};z 8F(6Q){a d=c.M("12"+9.b).15;a L=d.1i();9.1k();9.1I();9.1D("fi",6Q);bY(d);34(9)};z 8G(){9.1I();9.1D("ke");9.1e.1E["5f"+9.b].1z(1);a d=c.M("12"+9.b).15;a L=d.1i();a R=2x(L);2Y(R!=1g&&R.1o!="ch"&&R.1o!="ci"){if(R.1o=="3i")N;R=R.1v}R.3R("4p",0);R.k.fT=""};z 8H(){9.1I();9.1D("c5");9.1e.1E["5g"+9.b].1z(1);a d=c.M("12"+9.b).15;a L=d.1i();a R=2x(L);2Y(R!=1g&&R.1o!="ch"&&R.1o!="ci"){if(R.1o=="3i")N;R=R.1v}R.3R("4p",0);R.k.fT=""};z 8I(){9.1I();9.1D("5Z")};z 8J(){9.1I();9.1D("60")};z 8K(){9.1I();9.1D("61")};z 8L(){9.1I();9.1D("62")};z 8M(){9.1I();a d=c.M("12"+9.b).15;a L=d.1i();a 1S=2x(L);if(1S.35)1S.3R("35");K 1S.35="b5";9.1V()};z 8N(){9.1I();a d=c.M("12"+9.b).15;a L=d.1i();a 1S=2x(L);if(1S.35)1S.3R("35");K 1S.35="fv";9.1V()};z 8Q(fU){9.74(9.7s[fU][1]);9.1k();9.1V()};z 76(){a d=c.M("12"+9.b).15;a L=d.1i();a l=L.2k(0);if(l.2o.1P==2v.3w){if(l.5G()==""){a 4j=l.3y;a 6R=l.ae;a 4R=l.2o;a Z=4R.3c;4j=Z.1R(0,l.3y).80(/(\\W+\\w*)$/i);4j=4j==-1?0:4j;a cj=Z.1R(4j,l.3y).80(/\\w+/i);4j+=(cj==-1?Z.1R(4j,l.3y).F:cj);6R=Z.3n(l.ae).80(/\\W+/i);6R=6R==-1?Z.F:6R+l.ae;l=d.c.2g();l.88(4R,4j);l.89(4R,6R);L=d.1i();L.2F();L.2G(l)}}N};z 8R(){a d=c.M("12"+9.b).15;a L=d.1i();a ck=2x(L);if(ck){if(L.2k(0).5G()==""){a R=ck;2Y(R!=1g&&R.1o!="9e"&&R.1o!="9f"&&R.1o!="9g"&&R.1o!="9h"&&R.1o!="9i"&&R.1o!="9j"&&R.1o!="9k"&&R.1o!="P"&&R.1o!="3V"){if(R.1o=="3i")N;R=R.1v}a l=d.c.2g();l.2h(R);L=d.1i();L.2F();L.2G(l)}}};z 74(q){a d=c.M("12"+9.b).15;a L=d.1i();a l=L.2k(0);9.1I();a 3k=l.cf(q);l.2Z(J);a 3v=3k.17[3k.17.F-1];l.4N(3k);2q{d.c.2N="1d"}2r(e){}if(3v.1P==2v.3w){l=d.c.2g();l.88(3v,3v.3c.F);l.89(3v,3v.3c.F);L=d.1i();L.2F();L.2G(l);a af=l.kf;if(af&&af.1v){2q{af.1v.kg()}2r(e){}}}};z aM(2I,6S,8f,4L){a d=c.M("12"+9.b).15;a L=d.1i();a l=L.2k(0);9.1I();a 5J=J;if(l.5G()==""){if(l.2o.1P==2v.8g){if(l.2o.17[l.3y].1P!=2v.3w){if(l.2o.17[l.3y].2c=="5R")5J=E;K 5J=J}K{5J=E}}K{5J=E}if(5J){a cl=(6S!=""&&6S!=1g?6S:2I);a 1t=d.c.bI(cl);l.4N(1t);2q{d.c.2N="1d"}2r(e){}l=d.c.2g();l.88(1t,0);l.89(1t,cl.F);L=d.1i();L.2F();L.2G(l)}}a fV=(l.2o.1P==2v.3w)&&(l.3y>0);d.c.cg("kh",J,2I);L=d.1i();l=L.2k(0);if(l.2o.1P==2v.3w){a 1t=(5J||!fV?l.2o.1v:l.2o.6L);l=d.c.2g();l.2h(1t);L=d.1i();L.2F();L.2G(l)}a 1S=l.2o.17[l.3y];if(1S){if(8f!=""&&8f!=a4)1S.8f=8f;if(4L!=""&&4L!=a4)1S.c2("4L",4L)}};z 8P(){if(ki(H("kj fW kk fW kl km kn 70 ko?"))==E){9.1I();a d=c.M("12"+9.b).15;d.c.1j.1h="<5R>";d.1V()}};z au(3j){a 2W="2V";if(3j!=1g&&3j!="")2W=3j;a d=c.M("12"+9.b).15;a L=d.1i();a l;a R;a q;if(!7X(L)){l=L.2k(0);R=2x(L);if(R.2c==2W)N R;N}l=L.2k(0);q=l.5G();a 3k=l.fj();a 8h=d.c.3C(2W);8h.5D(3k);l.4N(8h);2q{d.c.2N="1d"}2r(e){}l=d.c.2g();l.2h(8h);L=d.1i();L.2F();L.2G(l);N 8h};z 8O(){a d=c.M("12"+9.b).15;a L=d.1i();a 1S=2x(L);9.1I();if(1S!=1g&&1S.2c!="3i"){if(1S.k.6v=="9D")1S.k.6v="";K 1S.k.6v="9D"}};z es(el){a 4h=el;a 4g=4h.1v.1v.1v;a 8i=4h.1v.fX;a 8j=4h.fY;a 2d=4g.2d;a 8k=2d[2d.F-1].17[0];8k.1h="<3G 2A=48>"+(8i*1+1)+" x "+(8j*1+1)+" "+H("33 kp 9L")+" ...  &2U;&2U;&2U;<2z k=\'5B-ac:3u\'>"+H("33 kq er")+"</2z>&2U;</3G>";8k.k.2B="";8k.k.1A="#4b";8k.k.1s="1B";Q(a i=0;i<2d.F-1;i++){a 4k=2d[i];Q(a j=0;j<4k.17.F;j++){a 5K=4k.17[j];if(i<=8i&&j<=8j)5K.k.2B="#kr";K 5K.k.2B="#4I"}}};z ex(el){a 4g=el;if(4g.2c!="8d")N;a 2d=4g.2d;2d[2d.F-1].17[0].1h=H("9Q 33 6f");Q(a i=0;i<2d.F-1;i++){a 4k=2d[i];Q(a j=0;j<4k.17.F;j++){a 5K=4k.17[j];5K.k.2B="#4I"}}};z 9p(){a 4g=c.M("bm"+9.b);a 2d=4g.2d;2d[2d.F-1].17[0].1h=H("9Q 33 6f");Q(a i=0;i<2d.F-1;i++){a 4k=2d[i];Q(a j=0;j<4k.17.F;j++){a 5K=4k.17[j];5K.k.2B="#4I"}}};z 9o(el){9.1k();a d=c.M("12"+9.b).15;a 4h=el;a 8i=4h.1v.fX+1;a 8j=4h.fY+1;9.1I();a q="<1r k=\'1s-2Z:2Z;1n:26%;\' 8l=\'8l\'>";Q(a i=1;i<=8i;i++){q+="<18>";Q(a j=1;j<=8j;j++){q+="<Y><br/></Y>"}q+="</18>"}q+="</1r>";a L=d.1i();a l=L.2k(0);l.2Z(E);a 3k=l.cf(q);l.4N(3k);2q{d.c.2N="1d"}2r(e){}a 8m=d.c.1O("8d");Q(a i=0;i<8m.F;i++){if(8m[i].87("8l")=="8l"){l=d.c.2g();l.2h(8m[i]);L=d.1i();L.2F();L.2G(l);8m[i].3R("8l");u}}34(9)};z bH(2j,11){if(!11.3F[0]){11.1I()}if(2j.ks){5w(2j.6T){C 86:if(11.dm){2j.7F();1y(11.X+"fZ.1b",8n,7L)}K{a 8o=c.M("9E"+11.b);a 4c=8o.15.c;a g0=4c.bC("5B/2O","D");g0.bE();4c.2N="1d";8o.15.1V();2s.b8(z(){11.9r()},1)}u;C 66:11.1D("3Y");2j.7F();u;C 73:11.1D("3Z");2j.7F();u;C 85:11.1D("41");2j.7F();u}}if(2j.6T==37||2j.6T==38||2j.6T==39||2j.6T==40){11.1I()}if(2j.6T==13){11.1I()}11.cR()};z cU(){a d=c.M("12"+9.b).15;a 2E=c.M("5v"+9.b);9.1k();if(9.8S){9.dA();9.8S=J;c.1j.k.7D="";c.M("9C").k.2m="1B";2E.k.6v="";2E.k.2J="1B";2E.k.6w="1B";if(9.1n.5G().1K("%")!=-1)2E.k.1n=9.1n;K 2E.k.1n=4T(9.1n)+"3t";if(9.1c.5G().1K("%")!=-1)2E.k.1c=9.1c;K 2E.k.1c=4T(9.1c)+"3t";Q(a i=0;i<14.2X.F;i++){if(14.2X[i]!=9.b){c.M("5v"+14.2X[i]).k.2l="";2q{c.M("12"+14.2X[i]).15.c.2N="1d"}2r(e){}}}}K{9.dz();9.8S=E;2s.kt(0,0);c.1j.k.7D="ku";c.M("9C").k.2m="kv";2E.k.6v="9D";2E.k.2J="1B";2E.k.6w="1B";2E.k.1n=2s.kw+"3t";2E.k.1c=2s.kx+"3t";2E.k.ky=kz;Q(a i=0;i<14.2X.F;i++){if(14.2X[i]!=9.b)c.M("5v"+14.2X[i]).k.2l="2Q"}d.1V()}2q{d.c.2N="1d"}2r(e){}a 2K=c.M("2K"+9.b);2K.1h="";c.3O.1V();d.1V();a l=d.c.2g();if(d.c.1j.17.F>0){a 8p=d.c.1j.17[d.c.1j.17.F-1];if(8p.1P==1&&8p.1o=="5R"){l.2h(8p);l.2Z(E)}K{l.2h(8p);l.2Z(J)}}K{l.ao(d.c.1j);l.2Z(J)}a 2i=d.1i();2i.2F();2i.2G(l)};z 1y(2I,1n,1c,p,3B){cm(2I,1n,1c,J,p,3B)};z 4U(2I,1n,1c,p,3B){cm(2I,1n,1c,E,p,3B)};z cm(2I,g1,hg,g2,p,3B){a id="kA"+(1m kB()).kC();a f=1m e3(id);f.2y=14.X.1R(0,14.X.1K("3m/"))+"cS/";f.9V({1n:g1+"3t",1c:hg+"3t",kD:g2,4J:E,2I:2I,kE:p,kF:3B})};z 1k(){kG();9.30.1k();9.31.1k();if(9.6d)9.9p()};z 5L(1f){6U=["\\n","",""];if(1f=="A"||1f=="B"||1f=="kH"||1f=="kI"||1f=="fd"||1f=="6I"||1f=="I"||1f=="kJ"||1f=="fe"||1f=="kK"||1f=="bX"||1f=="kL"||1f=="kM"||1f=="U"||1f=="kN"||1f=="S"||1f=="kO"||1f=="fh"||1f=="kP"||1f=="kQ"||1f=="2V"||1f=="ce")6U=["","",""];if(1f=="3U"||1f=="8d"||1f=="kR"||1f=="fM"||1f=="fL"||1f=="ch"||1f=="ci"||1f=="ff"||1f=="fg"||1f=="fP"||1f=="fQ"||1f=="kS"||1f=="kT"||1f=="kU"||1f=="3i"||1f=="5s")6U=["\\n","","\\n"];if(1f=="6D"||1f=="cn")6U=["\\n","",""];if(1f=="5R"||1f=="g3")6U=["","\\n",""];N 6U};z kV(s){s=1q(s).D(/&/g,"&2R;");s=1q(s).D(/</g,"&lt;");s=1q(s).D(/"/g,"&a5;");N s};z g4(s){s=1q(s).D(/&/g,"&2R;");s=1q(s).D(/</g,"&lt;");a x=kW(s);x=kX(x.D(/\\%kY/gi,"-*g5*-"));s=x.D(/-\\*g5\\*-/gi,"&2U;");N s};z 7V(1S,ag){a q="";Q(a i=0;i<1S.17.F;i++){a 23=1S.17[i];if(23.1P==1){a 1w=23.2c;a co=J;if(1w.1R(0,1)=="/"){co=E}K{a 1T=ag;q+=5L(1w)[0];if(5L(1w)[0]!="")q+=1T}if(co){}K if(1w=="kZ"||1w=="g6"){s=3P(23);s=s.D(/\\"[^\\"]*\\"/ig,z(x){x=x.D(/&/g,"&2R;").D(/</g,"&lt;").D(/>/g,"&gt;").D(/\'/g,"&f4;").D(/\\s+/ig,"#3a#").D(/&2R;2R;/gi,"&2R;");N x});s=s.D(/<([^ >]*)/ig,z(x){N x.2w()});s=s.D(/ ([^=]+)=([^"\' >]+)/ig," $1=\\"$2\\"");s=s.D(/ ([^=]+)=/ig,z(x){N x.2w()});s=s.D(/#3a#/ig," ");s=s.D(/<ah([^>]*)>/ig,"\\n<ah$1 />").D(/\\/ \\/>$/ig," \\/>");if(1w=="g6")if(23.1h=="")s=s.D(/>$/ig," \\/>").D(/\\/ \\/>$/ig,"\\/>");s=s.D(/<ah 4D=\\"g7\\" 6q=\\"0\\" \\/>/,"<ah 4D=\\"g7\\" 6q=\\"-1\\" \\/>");q+=s}K if(1w=="l0"){q+="<6S>"+23.1h+"</6S>"}K{if(1w=="cp"){a g8=23.cq;a g9=23.cr}a ga=23.l1(J);s=3P(ga).D(/<\\/[^>]*>/,"");if(1w=="6D"){a 4e=s.3J(/<[^>]*>/ig);s=4e[0]}s=s.D(/\\"[^\\"]*\\"/ig,z(x){x=x.D(/&/g,"&2R;").D(/&2R;2R;/g,"&2R;").D(/</g,"&lt;").D(/>/g,"&gt;").D(/\\s+/ig,"#3a#");N x});s=s.D(/<([^ >]*)/ig,z(x){N x.2w()});s=s.D(/ ([^=]+)=([^" >]+)/ig," $1=\\"$2\\"");s=s.D(/ ([^=]+)=/ig,z(x){N x.2w()});s=s.D(/#3a#/ig," ");s=s.D(/(<hr[^>]*)(gb="")/ig,"$l2=\\"gb\\"");s=s.D(/(<9F[^>]*)(gc="")/ig,"$l3=\\"gc\\"");s=s.D(/(<l4[^>]*)(gd="")/ig,"$l5=\\"gd\\"");s=s.D(/(<l6[^>]*)(l7="")/ig,"$l8=\\"E\\"");s=s.D(/(<9F[^>]*)(ge="")/ig,"$l9=\\"ge\\"");s=s.D(/(<9F[^>]*)(gf="")/ig,"$la=\\"gf\\"");s=s.D(/(<Y[^>]*)(5A="" )/ig,"$gg=\\"5A\\" ");s=s.D(/(<Y[^>]*)(5A=""\\>)/ig,"$gg=\\"5A\\"\\>");s=s.D(/ lb=\\"E\\"/ig,"");if(1w=="cp"){s=s.D(/ cq=\\"0,0,0,0\\"/ig," cq=\\""+g8+"\\"");s=s.D(/ cr=\\"lc\\"/ig," cr=\\""+g9+"\\"")}a cs=E;if(1w=="ce"||1w=="5R"||1w=="cp"||1w=="g3"||1w=="fO"||1w=="6E"||1w=="bJ"){s=s.D(/>$/ig," \\/>").D(/\\/ \\/>$/ig,"\\/>");cs=J}q+=s;if(1w!="3U")q+=5L(1w)[1];if(1w!="3U")if(5L(1w)[1]!="")q+=1T;if(cs){s=3P(23);if(1w=="cn"){s=s.D(/<3A([^>]*)>[\\n+\\s+\\t+]*/ig,"<3A$1>");s=s.D(/[\\n+\\s+\\t+]*<\\/3A>/ig,"<\\/3A>");s=s.D(/<3A([^>]*)>\\/\\/<!\\[ld\\[/ig,"");s=s.D(/\\/\\/\\]\\]><\\/3A>/ig,"");s=s.D(/<3A([^>]*)>/ig,"");s=s.D(/<\\/3A>/ig,"");s=s.D(/^\\s+/,\'\').D(/\\s+$/,\'\');q+="\\n"+1T+s+"\\n"+1T}if(1w=="6D"){s=s.D(/<k([^>]*)>[\\n+\\s+\\t+]*/ig,"<k$1>");s=s.D(/[\\n+\\s+\\t+]*<\\/k>/ig,"<\\/k>");s=s.D(/<k([^>]*)><!--/ig,"");s=s.D(/--><\\/k>/ig,"");s=s.D(/<k([^>]*)>/ig,"");s=s.D(/<\\/k>/ig,"");s=s.D(/^\\s+/,"").D(/\\s+$/,"");q+="\\n"+1T+"<!--\\n"+1T+s+"\\n"+1T+"-->\\n"+1T}if(1w=="3V"||1w=="P"){if(23.1h==""||23.1h=="&2U;"){q+="&2U;"}K q+=7V(23,1T+"\\t")}K if(1w=="6D"||1w=="cn"){}K{q+=7V(23,1T+"\\t")}if(1w!="3U")q+=5L(1w)[2];if(1w!="3U")if(5L(1w)[2]!="")q+=1T;q+="</"+1w.2w()+">"}}}K if(23.1P==3){q+=g4(23.3c).D(/^[\\t\\r\\n\\v\\f]*/,"").D(/[\\t\\r\\n\\v\\f]*$/,"")}K if(23.1P==8){if(3P(23).1R(0,2)=="<"+"%"){1Y=(3P(23).1R(2));1Y=1Y.1R(0,1Y.F-2);1Y=1Y.D(/^\\s+/,"").D(/\\s+$/,"");a 1T=ag;q+="\\n"+1T+"<%\\n"+1T+1Y+"\\n"+1T+"%>\\n"+1T}K{a 1T=ag;1Y=23.3c;1Y=1Y.D(/^\\s+/,"").D(/\\s+$/,"");q+="\\n"+1T+"<!--\\n"+1T+1Y+"\\n"+1T+"-->\\n"+1T}}K{}}N q};z 2x(2i){a l=2i.2k(0);a 1t=l.2o;if(1t.1P==2v.8g){if(l.3y>=1t.17.F)N 1t;1t=1t.17[l.3y]}if(1t.1P==2v.3w){if(1t.3c.F==l.3y){a el=1t.6L;if(el&&el.1P==2v.8g){if(l.6M.1P==2v.3w&&l.6M.3c.F==l.ae){if(el==l.6M.1v){N el}}}}2Y(1t!=1g&&1t.1P!=2v.8g){1t=1t.1v}}N 1t};z 7X(2i){a l=2i.2k(0);if(l!=1g&&l.2o!=1g){N(l.2o.1P==2v.3w)}N J};z 3P(1t){a q="";5w(1t.1P){C 2v.8g:q="<"+1t.2c;a ct="";Q(a 4l=0;4l<1t.5M.F;4l++){if(1t.5M[4l].2c.3n(0,4)=="gh")a7;if(1t.5M[4l].3c.3n(0,4)=="gh")a7;if(1t.2c==\'3U\'&&1t.5M[4l].2c.2w()==\'6q\'){ct=1t.5M[4l].3c}K{q+=\' \'+1t.5M[4l].2c+\'="\'+1t.5M[4l].3c.D(/"/gi,"\'")+\'"\'}}q+=\'>\';q+=(1t.2c!=\'3U\'?1t.1h:ct);q+="</"+1t.2c+">";u;C 2v.le:q="<!"+"--"+1t.3c+"--"+">";u;C 2v.3w:q=1t.3c;u}N q};z b2(O,id,2e,ai){a e=2e,aj=ai,T=id.1R(0,id.gj(aj));5w(T){C"55":e.dv();u;C"7c":e.cT();u;C"7d":e.1V();c.M("12"+2e.b).15.lf();u;C"7e":e.1k();1y(e.X+"80.1b",lg,cD);u;C"7f":e.1k();if(e.9q=="aV");K if(e.9q=="lh")li("12"+2e.b);u;C"db":e.1D("aB");u;C"dc":e.1D("aC");u;C"42":e.9l();u;C"43":e.9m();u;C"59":e.1D("3Y");u;C"5a":e.1D("3Z");u;C"5b":e.1D("41");u;C"5c":e.1D("4u");u;C"5d":e.1D("4v");u;C"5e":e.1D("52");u;C"67":e.8I();u;C"68":e.8J();u;C"69":e.8K();u;C"6a":e.8L();u;C"5f":e.8H();u;C"5g":e.8G();u;C"5h":e.1D("53");u;C"5i":e.1D("54");u;C"5j":e.8M();u;C"5k":e.8N();u;C"6b":e.30.9V(c.M(id));u;C"6c":e.31.9V(c.M(id));u;C"7i":e.1k();1y(e.X+"lj.1b",lk,ll);u;C"7h":e.1k();1y(e.X+"lm.1b",eu,ln);u;C"7j":e.1k();1y(e.X+"lo.1b",gk,lp);u;C"7k":e.1k();1y(e.X+"lq.1b",cu,lr);u;C"7p":e.1k();1y(e.X+"ls.1b",cu,lu);u;C"7l":e.1k();1y(e.X+"lv.1b",cu,lw);u;C"6h":e.1k();1L(e.aK);u;C"6i":e.1k();1L(e.aL);u;C"6k":e.1k();1L(e.aO);u;C"6j":e.1k();1L(e.aN);u;C"dd":e.lx(E);u;C"7q":e.1k();1y(e.X+"ly.1b",lz,lA);u;C"7m":e.8O();u;C"9a":e.1k();1y(e.X+"lB.1b",lC,lD);u;C"5m":e.1D("fS");u;C"7o":e.8B();u;C"9b":4S(2e);e.1k();4U(e.X+"lE.1b",8q,ak);u;C"9c":4S(2e);e.1k();4U(e.X+"lF.1b",8q,ak);u;C"4A":4S(2e);e.1k();4U(e.X+"lG.1b",8q,ak);u;C"4B":4S(2e);e.1k();4U(e.X+"lH.1b",8q,ak);u;C"9d":e.8P();u;C"99":e.1k();e.7r();u;C"4x":e.1k();e.8R();u;C"4y":e.1k();e.76();fx(e.b);u;C"4z":e.1k();e.76();fC(e.b);u;C"5l":e.1k();u;3e:Q(a i=0;i<e.3p.F;i++){if(e.3p[i][0]==T){1L(e.3p[i][1]);u}}}};z 3L(O,id,2e,ai){a aj=ai;a e=2e;a T=id.1R(0,id.gj(aj));5w(T){C"e7":4S(2e);4U(e.X+"cv.1b",lI,gl);u;C"e8":4S(2e);4U(e.X+"cv.1b",lJ,8q);u;C"e9":4S(2e);4U(e.X+"cv.1b",lK,lL);u;C"56":1y(e.X+"lM.1b",lN,gl);u;C"4w":1y(e.X+"lO.1b",lP,lQ);u;C"57":1y(e.X+"lR.1b",lS,lT);u;C"58":1y(e.X+"7Q.1b",lU,lV);u;C"63":1y(e.X+"lW.1b",ew,lX);u;C"64":1y(e.X+"lY.1b",eX,lZ);u;C"m0":1y(e.X+"eB.1b",7L,9R);u;C"m1":1y(e.X+"eC.1b",eD,eE);u;C"m2":1y(e.X+"eF.1b",eG,eH);u;C"m3":1y(e.X+"eI.1b",3M,6X);u;C"m4":1y(e.X+"eK.1b",3M,9R);u;C"m5":1y(e.X+"eL.1b",3M,eM);u;C"m6":1y(e.X+"eN.1b",3M,eO);u;C"m7":1y(e.X+"eP.1b",3M,6X);u;C"bo":1y(e.X+"m8.1b",m9,ma);u;C"bp":1y(e.X+"mb.1b",8n,8n);u;C"7K":1y(e.X+"mc.1b",md,gk);u;C"6e":1y(e.X+"mf.1b",8n,7L);u;C"65":1y(e.X+"fZ.1b",8n,7L);u}a 4m=0;if(T.1K("4w")!=-1){}K if(T.1K("4x")!=-1){4m=T.3n(T.1K("3a")+1);e.8D(e.6l[4T(4m)][1])}K if(T.1K("4y")!=-1){4m=T.3n(T.1K("3a")+1);e.8E(e.4C[4T(4m)])}K if(T.1K("4z")!=-1){4m=T.3n(T.1K("3a")+1);e.8F(e.5n[4T(4m)][1])}K if(T.1K("5l")!=-1){4m=T.3n(T.1K("3a")+1);e.8Q(4T(4m))}};z 7y(v){a cH=1q(9.1c);a 1U=c.M("5v"+9.b);if(cH.1K("%")>-1){cH=1U.17[0].f9}if(!9.gm)9.gm=4T(cH,10);a cw=4T(cH,10)+v;if(v<0){a 1e=9.1e;9.1c=cw+"3t";1U.k.1c=9.1c}K if(v>0){a 1e=9.1e;9.1c=cw+"3t";1U.k.1c=9.1c}};z 9r(){a 8o=c.M("9E"+9.b);a 8r=8o.15;Q(a i=0;i<8r.c.1j.1O("*").F;i++){8r.c.1j.1O("*")[i].3R("7E");8r.c.1j.1O("*")[i].3R("k")}a Z=8r.c.1j.1h;Z=Z.D(/<!(?:--[\\s\\S]*?--\\s*)?>\\s*/gi,"");Z=1q(Z).D(/<\\\\?\\?mg[^>]*>/g,"");Z=1q(Z).D(/<\\/?o:p[^>]*>/g,"");Z=1q(Z).D(/<\\/?mh:p[^>]*>/gi,"");Z=1q(Z).D(/<\\/?v:[^>]*>/g,"");Z=1q(Z).D(/<\\/?o:[^>]*>/g,"");Z=1q(Z).D(/<\\/?mi:[^>]*>/g,"");Z=1q(Z).D(/<\\/?w:mj[^>]*>/gi,"");Z=1q(Z).D(/<\\/?w:mk[^>]*>/gi,"");Z=1q(Z).D(/&2U;/g,"");Z=1q(Z).D(/<\\/?2V[^>]*>/g,"");Z=1q(Z).D(/<\\/?6I[^>]*>/g,"");Z=1q(Z).D(/<\\/?bX[^>]*>/g,"");Z=1q(Z).D(/<\\/?9e[^>]*>/g,"");Z=1q(Z).D(/<\\/?9f[^>]*>/g,"");Z=1q(Z).D(/<\\/?9g[^>]*>/g,"");Z=1q(Z).D(/<\\/?9h[^>]*>/g,"");Z=1q(Z).D(/<\\/?9i[^>]*>/g,"");Z=1q(Z).D(/<\\/?9j[^>]*>/g,"");Z=1q(Z).D(/<\\/?P[^>]*><\\/P>/g,"");Z=1q(Z).D(/<!--\\[if[^>]*>/gi,"");Z=1q(Z).D(/<!--\\[gn\\]-->/gi,"");Z=1q(Z).D(/<!\\[gn\\]-->/gi,"");Z=1q(Z).D(/<\\/?ml[^>]*>/g,"");Z=1q(Z).D(/<\\/?bN[^>]*>/g,"");Z=1q(Z).D(/<\\/?k[^>]*>/g,"");9.74(Z)}',62,1386,'|||||||||this|var|oName|document|oEditor|||||||style|range|||||sHTML||||break|||||function|||case|replace|true|length|oEdt|getTxt||false|else|oSel|getElementById|return|tb||for|oElement||btn||gif||scriptPath|td|str||obj|idContent||oUtil|contentWindow||childNodes|tr||1px|htm|height|on|tbar|tag|null|innerHTML|getSelection|body|hide|element|new|width|tagName|newSpan|String|table|border|node|unselectable|parentNode|sTagName|addButton|modelessDialogShow|setState|color|0px|doc|doCmd|btns|padding|arrStyle|size|saveForUndo|solid|indexOf|eval|theSpan|elements|getElementsByTagName|nodeType|sSelector|substring|oEl|sT|edtObj|focus|sContent|sPreloadHTML|sTmp|tmp||background||oNode|||100||addItem||font|sClassName|nodeName|rows|edt|oEdit|createRange|selectNode|sel|evt|getRangeAt|display|margin|nSize|startContainer|queryCommandEnabled|try|catch|window|cellpadding|cellspacing|Node|toLowerCase|getSelectedElement|iconPath|span|align|backgroundColor|sBaseHREF|arrStyles|edtArea|removeAllRanges|addRange|Function|url|top|idStyles|sCssText|txt|designMode|html|mode|none|amp|cursor|addToggleButton|nbsp|SPAN|useBlock|arrEditor|while|collapse|oColor1|oColor2||Table|realTime|dir|sHTMLColor||||_|sVal|nodeValue|f4f4f4|default|addDropdownButton|ISDropdown|line|BODY|blockTag|docFrag|queryCommandState|moz|substr|className|arrCustomButtons|onClick|myStyle|onclick|px|underline|lastNode|TEXT_NODE|sCmd|startOffset|oScripts|script|opt|createElement|white|cleanTags|arrUndoList|div|event|arrA|match|pvDD|ddAction|235|head|documentElement|getOuterHTML|arrBase|removeAttribute|spans|activeElement|TEXTAREA|DIV|cleanDeprecated|buttonMap|Bold|Italic||Underline|btnUndo|btnRedo|Size|bottom|tmpTb|colspan|right|ddFmt|family|000000|oDoc|objL|arrTmp|split|oTable|oTD|oRows|sPos|oRow|atr|idx|src|tselector|type|wnd|replaceTags|customColors|BRK|Strikethrough|Superscript|btnParagraphFormatting|btnParagraph|btnFontName|btnFontSize|btnXHTMLFullSource|btnXHTMLSource|arrFontName|name|valign|ddTable|sdd|onmouseover|ffffff|center|oRenderName|rel|copyAttribute|insertNode|bold|italic|through|startCont|setActiveEditor|parseInt|modalDialogShow|editor|bInside|allText|nd|applyColor|features|Paste|Subscript|Indent|Outdent|btnSave|btnTextFormatting|btnListFormatting|btnBoxFormatting|btnBold|btnItalic|btnUnderline|btnStrikethrough|btnSuperscript|btnSubscript|btnNumbering|btnBullets|btnIndent|btnOutdent|btnLTR|btnRTL|btnCustomTag|btnLine|arrFontSize|docType|TagSelectorPosition|idTextArea|listA|HTML|tmpGrp|orTb|idArea|switch|sZ|onmouseout|Edit|nowrap|text|addEventListener|appendChild|allFonts|theParent|toString|arrTmp2|oActiveElement|emptySel|oCol|lineBreak1|attributes|sSrc|innovaeditor|reg|objStyle|BR|iconHeight|getHTMLBody|getHTML|getXHTMLBody|getXHTML|css|ForeColor|JustifyLeft|JustifyCenter|JustifyRight|JustifyFull|btnCssText|btnCssBuilder|btnPasteText||btnJustifyLeft|btnJustifyCenter|btnJustifyRight|btnJustifyFull|btnForeColor|btnBackColor|btnTable|btnPasteWord|Insert|groups|btnContentBlock|btnInternalLink|btnCustomObject|btnInternalImage|arrParagraph|Heading|preloadHTML|originalContent|moveTagSelector|value|sButtonName|Colors|cfcfcf|iframe|position|left|resizeInit|Formatting|generateHTML|ddTblEdit|arrColors|9px|STYLE|BASE|hcnt|cssRules|sCaption|FONT|textDecoration|emptySpans|nextSibling|endContainer|ddTbl|sClass|found|val|ePos|title|keyCode|arrReturn|write|sType|174|spcChar|replaceSpecialChar|all|RENDER|loadHTMLFull||insertHTML|publishingPath|expandSelection|Image|RemoveFormat|Paragraph|FontName|FontSize|btnFullScreen|btnPrint|btnSearch|btnSpellCheck|btnPaste|btnHyperlink|btnBookmark|btnImage|btnFlash|btnMedia|btnAbsolute|btnForm|btnRemoveFormat|btnYoutubeVideo|btnAutoTable|openStyleSelect|arrCustomTag|doUndoRedo|arrRedoList|selectElement|removeTag|encodeIO|changeHeight|XHTMLBody|dvId|oForm|onPickColor|overflow|class|preventDefault|ddCustomTag|777777|verdana|10px|mnuCellEdit|280|ddForm|arrColorPickerObjects|sName|sParent|box|encodeHTMLCode|cleanHTML|sMatch|removeChild|recur|styleSheets|isTextSelected|replaceChild|allSpans|search|copyStyleClass|GetElement|endFont|endCont|||getAttribute|setStart|setEnd|tmKeyup|isDDs|enableItem|TABLE|sColor|target|ELEMENT_NODE|idSpan|nRow|nCol|custCell|selThis|allTabs|400|pasteFrame|last|600|idSource|langDir|onSelectionChanged|spcCharCode|edtCnt|REPLACE|parent|loadHTML|cleanEmptySpan|cleanFonts|doClean|applySpanStyle|applyParagraph|applyFontName|applyFontSize|applyBullets|applyNumbering|applyJustifyLeft|applyJustifyCenter|applyJustifyRight|applyJustifyFull|applyBlockDirLTR|applyBlockDirRTL|makeAbsolute|clearAll|insertCustomTag|selectParagraph|stateFullScreen|Search|Undo|Redo|Bookmark|Hyperlink|Flash|Media||YoutubeVideo|Characters|Line|Form|Styles|Numbering|Bullets|btnPreview|btnStyles|btnCharacters|btnHTMLFullSource|btnHTMLSource|btnClearAll|H1|H2|H3|H4|H5|H6|PRE|doUndo|doRedo|useTagSelector|doClick_TabCreate|doRefresh_TabCreate|spellCheckMode|fixWord|listB|onsubmit_original|HTMLBody|XHTML|onMoreColor|onRemoveColor|txtCustomColors|Custom|txtMoreColors|grpMap|id_refresh_z_index|absolute|idContentWord|input|screenX|screenY|isWindow|resizeOffset|cnt|Text|ddFontName|ddFontSize|Justify|f3f3f8|Advanced|177|btnSource|View|Source|show|hideAll|refreshCustomColor|13px|14px|href|selector|arrB|sText|undefined|quot|itemCount|continue|marginRight|deleteContents|startFont|endOffsetPos|decoration|idElCommand|endOffset|comCon|sTab|param|sfx|oN|450|setEdit|bOnLoadReplaced|checkFocus|selectNodeContents|setFocus|getTextBody|putHTML|styleSelectionHoverBg|styleSelectionHoverFg|applySpan|iconWidth|ColorPicker|Save|FullScreen|Preview|Print|Cut|Copy|BackColor|AutoTable|Absolute|XHTMLSource|StyleAndFormatting|tabs|toolbarMode|cmdContentBlock|cmdInternalLink|insertLink|cmdCustomObject|cmdInternalImage|isCssLoaded|Arial|Lucida|headContent|isContentChanged|iwe_btnSubmit|ieSpell|bOnSubmitOriginalSaved|oTextArea|onsubmit|bBtnExists|onShow|More|tbAction|buildToolbar|icPath|ltr|auto|edtStr|setTimeout|currentResized|onload|onload_original|innova|btnMap|ddPar|ddFont||ddFs|Left|Right|add|ISCustomDDItem|dropTableCreate|btnTableEdit|mnuTableSize|mnuTableEdit|arrFormMenu||Field|Remove|sCbName|sCbCaption|sCbImage|isActive|currColor|dropColor|2px|idCustomColor|open|base|close|editorDoc_onkeyup|editorDoc_onmouseup|doKeyPress|createTextNode|LINK|default_edit|tmp_xxinnova|res|link|cssText|5px|black|sBody|tblStyles|tmpSelector|hasChildNodes|fontWeight|fontStyle|STRONG|replaceWithSpan|FormatBlock|bReturn|face|setAttribute|startcont|endcont|InsertOrderedList|pointer|idElNavigate|nWidth|selTop|selTopRow|selBottom|selBottomRow|nearElement|IMG|createContextualFragment|execCommand|OL|UL|tPos|selParent|cap|windowOpen|SCRIPT|bDoNotProcess|AREA|coords|shape|bClosingTag|tagVal|340|preview|newHeight|InnovaEditorUtil|US|LanguageDirectory|scriptPathLang|scr|ipt|163|RegExp|InnovaEditor|getComputedStyle||currentStyle|iwe_focus|createEvent|KeyboardEvent|initKeyEvent|keypress|dispatchEvent|init|initISEditor|onKeyPress|icons|fullScreen|doFullScreen|iwe_getElm|SpellCheck|PasteWord|PasteText|ContentBlock|InternalLink|InternalImage|CustomObject|Guidelines|HTMLFullSource|HTMLSource|XHTMLFullSource|ClearAll|CustomTag|LTR|RTL|btnCut|btnCopy|btnGuidelines||grpEdit|grpFont|grpPara|grpInsert|grpTables|grpMedia|showResizeBar|pasteTextOnCtrlV|Normal|Style|Gothic|Sans|MS|New|Roman|serif|onSave|click|||onFullScreen|onNormalScreen|alert|caption|here|cloneRange|onsubmit_new|bUseFeature|sHTMLDropMenus|HiliteColor|Object|createToolbar|btnWidth|btnHeight|eTab|createTbGroup|grp|addGroup|idTagSelTopRow|idTagSelTop|1000px|idTagSelBottomRow|idTagSelBottom|resize|onEditorStartResize|join|onmousemove|onEditorResize|onmouseup|onEditorStopResize|ISWindow|push|onload_new|ddPreview|btnPreview1|btnPreview2|btnPreview3|Full|ddFormatting|List|CSS|ddParagraph|Font|btnFontName_|btnFontSize_|ddPaste|bullet|To||ddForeColor||Color|ddBackColor|Internal|Link|doOver_TabCreate|20px|380||360|doOut_TabCreate|444444|ddTableEdit|Cell|form_form|form_text|285|289|form_list|295|332|form_check|Button|form_radio|form_hidden|152|form_file|132|form_button|oParent|onHide|showColorPicker|hideColorPicker|hideColorPickerAll|drawColorPicker|708090|430|keyup|mouseup|keydown|arguments|StyleSheet|firstLoad|apos|contentEditable|selectorText|ApplyExternalStyle|doApplyStyle|offsetHeight|isOnSelection|sFrom|sTo|EM|STRIKE|DIR|MENU|BASEFONT|fontsize|extractContents|8pt|10pt|12pt|14pt|18pt|24pt|36pt|edtFrm|sMatchTag|TD|InsertUnorderedList|rtl|sCurrClass|realtimeFontSelect|sFontName|queryCommandValue|selectItem|clearSelection|realtimeSizeSelect|sFontSize|sTagSelTop|ondblclick|arial|vertical|middle|Tag|sTagSelBottom|TR|TBODY|previousSibling|INPUT|FORM|SELECT|sOption|InsertHorizontalRule|listStyleImage|index|isSelInMidText|you|rowIndex|cellIndex|paste_text|oHTML|wd|ov|HR|fixVal|REPL|EMBED|Play|sCoords|sShape|oNode2|noshade|checked|multiple|readonly|disabled|1nowrap|_moz||lastIndexOf|440|480|minHeight|endif|Array|scripts|language|editor_lang|useSelection||activeModalWin|169|copy|pound|233|eacute|201|Eacute|8364|euro|8220|fromCharCode|initializeEditor|typeof|object|editorarea|insertBefore|edtWin|start|contentDocument|Body|cccccc|700px|350px|dropTopAdjustment_moz|dropLeftAdjustment_moz|heightAdjustment|useLastForeColor|useLastBackColor|stateForeColor|stateBackColor|getElm|tabHome|Home|tabStyle|cmdAssetManager|cmdFileManager|cmdImageManager|cmdMediaManager|cmdFlashManager|Preformatted|Black|Narrow|Book|Antiqua|Bookman|Old|Century||Comic|Courier|Franklin|Medium|Garamond|Georgia|Impact|Console|Unicode|Modern||Monotype|Corsiva|Palatino|Linotype|Script|Small|Fonts|Symbol|Tahoma|Times|Trebuchet|Verdana|Webdings|Wingdings|sans|cursive|fantasy|monospace|initialRefresh|CustomName1|CustomName2|ISToolbarManager|form|sHTMLIcons|color_picker_fg|color_picker_bg|hilitecolor|toolbar|main_istoolbar|createTbTab|tabCtl|addTab|render|cntContainer|blank|idResizeBar|resize_bar|onmousedown|submit|SUBMIT|elm|onselectstart|ondragstart|showOverlay|hideOverlay|addSeparator|addBreak||640x480|||800x600|1024x768|Screen|Check|Spelling|btnStyleAndFormat||btnStyle|Box|btnCustomCss|Builder|btnStyleSelect||Selection|btnParagraph_|4px|Name|tahoma|from|Word|btnLeft|btnCenter|Center|btnRight|btnFull|btnNumber|btnList|Foreground|btnInsertForeColor|Background|btnInsertBackColor|Tags|btnCustomTag_|Content|Block|175|cancelBubble|d3d3d3|table_insert|btnInsertTable|btnTableSize|btnEditTable|btnEditCell|btnSymbol|Special|Checkbox|Radio|Hidden|File|Editor|btnDelete|Clear|All|color_picker|800000|8b4513|006400|2f4f4f|000080|4b0082|800080|ff0000|daa520|6b8e23|0000cd|483d8b|c71585|696969|ff4500|ffa500|808000|4682b4|1e90ff||9400d3|ff1493|a9a9a9|ff6347|ffd700|32cd32|87ceeb|00bfff|9370db|ff69b4|dcdcdc|ffdab9|ffffe0|98fb98|e0ffff|87cefa|e6e6fa|dda0dd|145px|117px|16px|moreColTd|444|DOCTYPE|HREF|exec|stylesheet|textContent|ApplyCSS|3px|E9E8F2|9FA7BB|200px|fcfcfc|CENTER|XMP|APPLET|fontFamily|fontSize|prevSibling|clearTimeout|1000|ddId|offsetWidth|LI|DarkGray|fontname|InsertUnOrderedList|commonAncestorContainer|normalize|CreateLink|confirm|Are|sure|wish|to|delete|contents|Dimension|Advance|316ac5|ctrlKey|scroll|hidden|70px|innerWidth|innerHeight|zIndex|2000|ID|Date|getTime|overlay|openerWin|options|hideAllDD|CITE|CODE|SMALL|BIG|SUB|SUP|SAMP|VAR|KBD|TT|THEAD|MAP|DL|HEAD|fixAttr|escape|unescape|A0|OBJECT|TITLE|cloneNode|1noshade|1checked|select|1multiple|option|selected|1selected|1readonly|1disabled|contenteditable|RECT|CDATA|COMMENT_NODE|print|375|NetSpell|checkSpellingById|bookmark|245|216|hyperlink|220|image|351|flash|275|youtube_video||125|media|272|runtimeBorder|table_format|320|225|characters|495|160|source_html_full|source_html|source_xhtml_full|source_xhtml|640|800|1024|768|text1|511|paragraph|460|284|list|303|335|498|395|styles_cssText|352|styles_cssText2|445|btnForm0|btnForm1|btnForm2|btnForm3|btnForm4|btnForm5|btnForm6|btnForm7|table_size|240|282|table_edit|table_editCell|427||paste_word|xml|u1|st1|wrap|anchorlock|meta'.split('|'),0,{}))


var editor = new Array();
var oUtil = new InnovaEditorUtil();
function InnovaEditorUtil() {
	this.langDir = "en-US";
	try {
		if (LanguageDirectory) this.langDir = LanguageDirectory
	} catch(e) {}
	var oScripts = document.getElementsByTagName("script");
	for (var i = 0; i < oScripts.length; i++) {
		var sSrc = oScripts[i].src.toLowerCase();
		if (sSrc.indexOf("moz/editor.js") != -1) {
			this.scriptPath = oScripts[i].src.replace(/editor.js/, "")
		} else if (sSrc.indexOf("scripts/innovaeditor.js") != -1) {
			if (!this.scriptPath) this.scriptPath = oScripts[i].src.replace(/innovaeditor.js/, "") + "moz/"
		}
	}
	this.scriptPathLang = this.scriptPath.replace(/\/moz/, "") + "language/" + this.langDir + "/";
	if (this.langDir == "en-US") document.write("<scr" + "ipt src='" + this.scriptPathLang + "editor_lang.js'></scr" + "ipt>");
	this.oName;
	this.oEditor;
	this.obj;
	this.oSel;
	this.sType;
	this.bInside = bInside;
	this.useSelection = true;
	this.arrEditor = [];
	this.onSelectionChanged = function () {
		return true
	};
	this.activeElement;
	this.activeModalWin;
	this.setEdit = setEdit;
	this.bOnLoadReplaced = false;
	this.spcCharCode = [[169, "&copy;"], [163, "&pound;"], [174, "&reg;"], [233, "&eacute;"], [201, "&Eacute;"], [8364, "&euro;"], [8220, "\""]];
	this.spcChar = [];
	for (var i = 0; i < this.spcCharCode.length; i++) {
		this.spcChar[i] = [new RegExp(String.fromCharCode(this.spcCharCode[i][0]), "g"), this.spcCharCode[i][1]]
	}
	this.replaceSpecialChar = function (sHTML) {
		for (var i = 0; i < this.spcChar.length; i++) {
			sHTML = sHTML.replace(this.spcChar[i][0], this.spcChar[i][1])
		}
		return sHTML
	};
	this.initializeEditor = function (tselector, opt) {
		var allText = [],
		txt,
		edtCnt;
		if (typeof(tselector) == "object" && tselector.tagName && tselector.tagName == "TEXTAREA") {
			allText[0] = tselector
		} else if (tselector.substr(0, 1) == "#") {
			txt = document.getElementById(tselector.substr(1));
			if (!txt) return;
			allText[0] = txt
		} else {
			var all = document.getElementsByTagName("TEXTAREA");
			for (var i = 0; i < all.length; i++) {
				if (all[i].className == tselector) {
					allText[allText.length] = all[i]
				}
			}
		}
		for (var i = 0; i < allText.length; i++) {
			txt = allText[i];
			if (txt.id || txt.id == "") txt.id = "editorarea" + i;
			edtCnt = document.createElement("DIV");
			edtCnt.id = "innovaeditor" + i;
			txt.parentNode.insertBefore(edtCnt, txt);
			window["oEdit" + i] = new InnovaEditor("oEdit" + i);
			var objStyle;
			if (window.getComputedStyle) {
				objStyle = window.getComputedStyle(txt, null)
			} else if (txt.currentStyle) {
				objStyle = txt.currentStyle
			} else {
				objStyle = {
					width: window["oEdit" + i].width,
					height: window["oEdit" + i].height
				}
			}
			window["oEdit" + i].width = objStyle.width;
			window["oEdit" + i].height = objStyle.height;
			if (opt) {
				for (var it in opt) {
					window["oEdit" + i][it] = opt[it]
				}
			}
			window["oEdit" + i].REPLACE(txt.id, "innovaeditor" + i)
		}
	}
};
function bInside(oElement) {
	while (oElement != null) {
		if (oElement.designMode && oElement.designMode == "on") return true;
		oElement = oElement.parentNode
	}
	return false
};
function checkFocus() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var parent = getSelectedElement(oSel);
	if (parent != null) {
		if (!bInside(parent)) return false
	} else {
		if (!bInside(parent)) return false
	}
	return true
};
function iwe_focus(type) {
	var oEditor = document.getElementById("idContent" + this.oName);
	if (oEditor) {
		oEditor = oEditor.contentWindow;
		oEditor.focus()
	}
	if (type && oEditor) {
		var edtWin;
		var range = oEditor.document.createRange();
		if (oEditor.document.body.childNodes.length > 0) {
			var nd = null;
			if (type == "start") {
				nd = oEditor.document.body.childNodes[0];
				range.selectNode(nd);
				range.collapse(true)
			} else {
				nd = oEditor.document.body.childNodes[oEditor.document.body.childNodes.length - 1];
				range.selectNode(nd);
				if (nd.nodeType == 1 && nd.tagName == "BR") {
					range.collapse(true)
				} else {
					range.collapse(false)
				}
			}
		} else {
			range.selectNodeContents(oEditor.document.body);
			range.collapse(false)
		}
		var sel = oEditor.getSelection();
		sel.removeAllRanges();
		sel.addRange(range);
		var evt = oEditor.document.createEvent("KeyboardEvent");
		evt.initKeyEvent("keypress", true, true, null, false, false, false, false, 0, 32);
		oEditor.document.dispatchEvent(evt);
		evt = oEditor.document.createEvent("KeyboardEvent");
		evt.initKeyEvent("keypress", true, true, null, false, false, false, false, 8, 0);
		oEditor.document.dispatchEvent(evt)
	}
};
function setFocus(type) {
	this.focus(type)
};
function setEdit(oName) {
	if ((oName != null) && (oName != "")) {
		try {
			var wnd = document.getElementById("idContent" + oName);
			wnd.contentDocument.designMode = "on";
			wnd.focus()
		} catch(e) {}
	} else {
		for (var i = 0; i < this.arrEditor.length; i++) {
			try {
				var wnd = document.getElementById("idContent" + this.arrEditor[i]).contentWindow;
				wnd.document.designMode = "on";
				var r = wnd.getSelection().getRangeAt(0);
				r.selectNode(wnd.document.getElementsByTagName("Body")[0]);
				r.collapse(true);
				wnd.focus()
			} catch(e) {}
		}
	}
};
var iconHeight;
function InnovaEditor(oName) {
	this.oName = oName;
	this.init = initISEditor;
	this.RENDER = RENDER;
	this.loadHTML = loadHTML;
	this.loadHTMLFull = loadHTMLFull;
	this.getHTMLBody = getHTMLBody;
	this.getHTML = getHTML;
	this.getXHTMLBody = getXHTMLBody;
	this.getXHTML = getXHTML;
	this.getTextBody = getTextBody;
	this.putHTML = putHTML;
	this.css = "";
	this.onKeyPress = function () {
		return true
	};
	this.styleSelectionHoverBg = "#cccccc";
	this.styleSelectionHoverFg = "white";
	this.cleanEmptySpan = cleanEmptySpan;
	this.cleanFonts = cleanFonts;
	this.cleanTags = cleanTags;
	this.replaceTags = replaceTags;
	this.cleanDeprecated = cleanDeprecated;
	this.doClean = doClean;
	this.applySpanStyle = applySpanStyle;
	this.bInside = bInside;
	this.checkFocus = checkFocus;
	this.focus = iwe_focus;
	this.setFocus = setFocus;
	this.doCmd = doCmd;
	this.applyParagraph = applyParagraph;
	this.applyFontName = applyFontName;
	this.applyFontSize = applyFontSize;
	this.applyBullets = applyBullets;
	this.applyNumbering = applyNumbering;
	this.applyJustifyLeft = applyJustifyLeft;
	this.applyJustifyCenter = applyJustifyCenter;
	this.applyJustifyRight = applyJustifyRight;
	this.applyJustifyFull = applyJustifyFull;
	this.applyBlockDirLTR = applyBlockDirLTR;
	this.applyBlockDirRTL = applyBlockDirRTL;
	this.applySpan = applySpan;
	this.makeAbsolute = makeAbsolute;
	this.insertHTML = insertHTML;
	this.clearAll = clearAll;
	this.insertCustomTag = insertCustomTag;
	this.selectParagraph = selectParagraph;
	this.hide = hide;
	this.width = "700px";
	this.height = "350px";
	this.publishingPath = "";
	var oScripts = document.getElementsByTagName("script");
	for (var i = 0; i < oScripts.length; i++) {
		var sSrc = oScripts[i].src.toLowerCase();
		if (sSrc.indexOf("moz/editor.js") != -1) {
			this.scriptPath = oScripts[i].src.replace(/editor.js/, "");
			break
		} else if (sSrc.indexOf("innovaeditor.js") != -1) {
			this.scriptPath = oScripts[i].src.replace(/innovaeditor.js/, "moz/");
			break
		}
	}
	this.iconPath = "icons/";
	this.iconWidth = 29;
	this.iconHeight = 25;
	this.dropTopAdjustment_moz = 0;
	this.dropLeftAdjustment_moz = 0;
	this.heightAdjustment = 0;
	this.applyColor = applyColor;
	this.customColors = [];
	this.oColor1 = new ColorPicker("oColor1", this.oName);
	this.oColor2 = new ColorPicker("oColor2", this.oName);
	this.expandSelection = expandSelection;
	this.useLastForeColor = false;
	this.useLastBackColor = false;
	this.stateForeColor = "";
	this.stateBackColor = "";
	this.fullScreen = doFullScreen;
	this.stateFullScreen = false;
	this.getElm = iwe_getElm;
	this.features = [];
	this.buttonMap = ["Save", "FullScreen", "Preview", "Print", "Search", "SpellCheck", "Cut", "Copy", "Paste", "PasteWord", "PasteText", "Undo", "Redo", "ForeColor", "BackColor", "Bookmark", "Hyperlink", "Image", "Flash", "Media", "YoutubeVideo", "ContentBlock", "InternalLink", "InternalImage", "CustomObject", "Table", "AutoTable", "Guidelines", "Absolute", "Characters", "Line", "Form", "RemoveFormat", "HTMLFullSource", "HTMLSource", "XHTMLFullSource", "XHTMLSource", "ClearAll", "BRK", "StyleAndFormatting", "Styles", "CustomTag", "Paragraph", "FontName", "FontSize", "Bold", "Italic", "Underline", "Strikethrough", "Superscript", "Subscript", "JustifyLeft", "JustifyCenter", "JustifyRight", "JustifyFull", "Numbering", "Bullets", "Indent", "Outdent", "LTR", "RTL"];
	this.btnSave = false;
	this.btnPreview = true;
	this.btnFullScreen = true;
	this.btnPrint = false;
	this.btnSearch = true;
	this.btnSpellCheck = false;
	this.btnTextFormatting = true;
	this.btnListFormatting = true;
	this.btnBoxFormatting = true;
	this.btnParagraphFormatting = true;
	this.btnCssText = true;
	this.btnCssBuilder = false;
	this.btnStyles = false;
	this.btnParagraph = true;
	this.btnFontName = true;
	this.btnFontSize = true;
	this.btnCut = true;
	this.btnCopy = true;
	this.btnPaste = true;
	this.btnPasteText = false;
	this.btnUndo = true;
	this.btnRedo = true;
	this.btnBold = true;
	this.btnItalic = true;
	this.btnUnderline = true;
	this.btnStrikethrough = false;
	this.btnSuperscript = false;
	this.btnSubscript = false;
	this.btnJustifyLeft = true;
	this.btnJustifyCenter = true;
	this.btnJustifyRight = true;
	this.btnJustifyFull = true;
	this.btnNumbering = true;
	this.btnBullets = true;
	this.btnIndent = true;
	this.btnOutdent = true;
	this.btnLTR = false;
	this.btnRTL = false;
	this.btnForeColor = true;
	this.btnBackColor = true;
	this.btnHyperlink = true;
	this.btnBookmark = true;
	this.btnCharacters = true;
	this.btnCustomTag = false;
	this.btnImage = true;
	this.btnFlash = false;
	this.btnMedia = false;
	this.btnTable = true;
	this.btnGuidelines = true;
	this.btnAbsolute = true;
	this.btnPasteWord = true;
	this.btnLine = true;
	this.btnForm = true;
	this.btnRemoveFormat = true;
	this.btnHTMLFullSource = false;
	this.btnHTMLSource = false;
	this.btnXHTMLFullSource = false;
	this.btnXHTMLSource = true;
	this.btnClearAll = false;
	this.btnYoutubeVideo = true;
	this.btnAutoTable = false;
	this.tabs = [["tabHome", "Home", ["grpEdit", "grpFont", "grpPara"]], ["tabStyle", "Insert", ["grpInsert", "grpTables", "grpMedia"]]];
	this.groups = [["grpEdit", "", ["XHTMLSource", "FullScreen", "Search", "RemoveFormat", "BRK", "Undo", "Redo", "Cut", "Copy", "Paste", "PasteWord", "PasteText"]], ["grpFont", "", ["FontName", "FontSize", "Strikethrough", "Superscript", "BRK", "Bold", "Italic", "Underline", "ForeColor", "BackColor"]], ["grpPara", "", ["Paragraph", "Indent", "Outdent", "Styles", "StyleAndFormatting", "BRK", "JustifyLeft", "JustifyCenter", "JustifyRight", "JustifyFull", "Numbering", "Bullets"]], ["grpInsert", "", ["Hyperlink", "Bookmark", "BRK", "Image"]], ["grpTables", "", ["Table", "BRK", "Guidelines"]], ["grpMedia", "", ["Media", "Flash", "YoutubeVideo", "BRK", "Characters", "Line"]]];
	this.toolbarMode = 1;
	this.showResizeBar = true;
	this.pasteTextOnCtrlV = false;
	this.cmdAssetManager = "";
	this.cmdFileManager = "";
	this.cmdImageManager = "";
	this.cmdMediaManager = "";
	this.cmdFlashManager = "";
	this.btnContentBlock = false;
	this.cmdContentBlock = ";";
	this.btnInternalLink = false;
	this.cmdInternalLink = ";";
	this.insertLink = insertLink;
	this.btnCustomObject = false;
	this.cmdCustomObject = ";";
	this.btnInternalImage = false;
	this.cmdInternalImage = ";";
	this.arrStyle = [];
	this.isCssLoaded = false;
	this.openStyleSelect = openStyleSelect;
	this.arrParagraph = [[getTxt("Heading 1"), "H1"], [getTxt("Heading 2"), "H2"], [getTxt("Heading 3"), "H3"], [getTxt("Heading 4"), "H4"], [getTxt("Heading 5"), "H5"], [getTxt("Heading 6"), "H6"], [getTxt("Preformatted"), "PRE"], [getTxt("Normal (P)"), "P"], [getTxt("Normal (DIV)"), "DIV"]];
	this.arrFontName = ["Arial", "Arial Black", "Arial Narrow", "Book Antiqua", "Bookman Old Style", "Century Gothic", "Comic Sans MS", "Courier New", "Franklin Gothic Medium", "Garamond", "Georgia", "Impact", "Lucida Console", "Lucida Sans", "Lucida Unicode", "Modern", "Monotype Corsiva", "Palatino Linotype", "Roman", "Script", "Small Fonts", "Symbol", "Tahoma", "Times New Roman", "Trebuchet MS", "Verdana", "Webdings", "Wingdings", "serif", "sans-serif", "cursive", "fantasy", "monospace"];
	this.arrFontSize = [[getTxt("Size 1"), "1"], [getTxt("Size 2"), "2"], [getTxt("Size 3"), "3"], [getTxt("Size 4"), "4"], [getTxt("Size 5"), "5"], [getTxt("Size 6"), "6"], [getTxt("Size 7"), "7"]];
	this.arrCustomTag = [];
	this.docType = "";
	this.html = "<html>";
	this.headContent = "";
	this.preloadHTML = "";
	this.originalContent = "";
	this.isContentChanged = isContentChanged;
	this.onSave = function () {
		document.getElementById("iwe_btnSubmit" + this.oName).click()
	};
	this.onFullScreen = function () {
		return true
	};
	this.onNormalScreen = function () {
		return true
	};
	this.initialRefresh = false;
	this.doUndo = doUndo;
	this.doRedo = doRedo;
	this.saveForUndo = saveForUndo;
	this.doUndoRedo = doUndoRedo;
	this.arrUndoList = [];
	this.arrRedoList = [];
	this.useTagSelector = true;
	this.TagSelectorPosition = "bottom";
	this.moveTagSelector = moveTagSelector;
	this.selectElement = selectElement;
	this.removeTag = removeTag;
	this.doClick_TabCreate = doClick_TabCreate;
	this.doRefresh_TabCreate = doRefresh_TabCreate;
	this.arrCustomButtons = [["CustomName1", "alert(0)", "caption here", "btnSave.gif"], ["CustomName2", "alert(0)", "caption here", "btnSave.gif"]];
	this.onSelectionChanged = function () {
		return true
	};
	this.spellCheckMode = "ieSpell";
	this.encodeIO = false;
	this.changeHeight = changeHeight;
	this.fixWord = fixWord;
	this.REPLACE = REPLACE;
	this.mode = "XHTMLBody";
	this.idTextArea;
	var me = this;
	this.tbar = new ISToolbarManager(this.oName);
	this.tbar.iconPath = this.scriptPath.substring(0, this.scriptPath.indexOf("moz/")) + this.iconPath;
	editor[editor.length] = this;
	return this
};
function saveForUndo() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var obj = this;
	if (obj.arrUndoList[0]) if (oEditor.document.body.innerHTML == obj.arrUndoList[0][0]) return;
	for (var i = 20; i > 1; i--) obj.arrUndoList[i - 1] = obj.arrUndoList[i - 2];
	obj.focus();
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	obj.arrUndoList[0] = [oEditor.document.body.innerHTML, range.cloneRange()];
	this.arrRedoList = [];
	if (this.btnUndo) this.tbar.btns["btnUndo" + this.oName].setState(1);
	if (this.btnRedo) this.tbar.btns["btnRedo" + this.oName].setState(5)
};
function doUndo() {
	this.doUndoRedo(this.arrUndoList, this.arrRedoList)
};
function doRedo() {
	this.doUndoRedo(this.arrRedoList, this.arrUndoList)
};
function doUndoRedo(listA, listB) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var obj = this;
	if (!listA[0]) return;
	for (var i = 20; i > 1; i--) listB[i - 1] = listB[i - 2];
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	listB[0] = [oEditor.document.body.innerHTML, range.cloneRange()];
	sHTML = listA[0][0];
	oEditor.document.body.innerHTML = sHTML;
	oSel = oEditor.getSelection();
	oSel.removeAllRanges();
	oSel.addRange(listA[0][1]);
	for (var i = 0; i < 19; i++) listA[i] = listA[i + 1];
	listA[19] = null;
	realTime(this)
};
var bOnSubmitOriginalSaved = false;
//-------------------------------------------------------------REPLACE-------------
function REPLACE(idTextArea, dvId)
{
	this.idTextArea = idTextArea;
	var oTextArea = document.getElementById(idTextArea);
        
        if(typeof(dvId) == "undefined")
        {
            dvId = document.createElement('div');
            oTextArea.parentNode.appendChild(dvId);
        }
	oTextArea.style.display = "none";
	var oForm = oTextArea.form;
	if (oForm) {
		if (!bOnSubmitOriginalSaved) {
			if (oForm.onsubmit) onsubmit_original = oForm.onsubmit;
			bOnSubmitOriginalSaved = true
		}
		oForm.onsubmit = new Function("return onsubmit_new()")
	}
	var sContent = document.getElementById(idTextArea).value;
	sContent = sContent.replace(/&/g, "&amp;");
	sContent = sContent.replace(/</g, "&lt;");
	sContent = sContent.replace(/>/g, "&gt;");
	this.RENDER(sContent, dvId)
};
function isContentChanged() {
	var sContent = "";
	if (this.mode == "HTMLBody") {
		sContent = this.getHTMLBody()
	} else if (this.mode == "HTML") {
		sContent = this.getHTML()
	} else if (this.mode == "XHTMLBody") {
		sContent = this.getXHTMLBody()
	} else if (this.mode == "XHTML") {
		sContent = this.getXHTML()
	}
	if (sContent != this.originalContent) {
		return true
	}
	return false
};
function onsubmit_new() {
	var sContent;
	for (var i = 0; i < oUtil.arrEditor.length; i++) {
		var oEdit = eval(oUtil.arrEditor[i]);
		if (oEdit.mode == "HTMLBody") sContent = oEdit.getHTMLBody();
		if (oEdit.mode == "HTML") sContent = oEdit.getHTML();
		if (oEdit.mode == "XHTMLBody") sContent = oEdit.getXHTMLBody();
		if (oEdit.mode == "XHTML") sContent = oEdit.getXHTML();
		document.getElementById(oEdit.idTextArea).value = sContent
	}
	if (onsubmit_original) return onsubmit_original()
};
function onsubmit_original() {};
function RENDER(sPreloadHTML, dvId) {
	iconHeight = this.iconHeight;
	if (sPreloadHTML.substring(0, 4) == "<!--" && sPreloadHTML.substring(sPreloadHTML.length - 3) == "-->") sPreloadHTML = sPreloadHTML.substring(4, sPreloadHTML.length - 3);
	if (sPreloadHTML.substring(0, 4) == "<!--" && sPreloadHTML.substring(sPreloadHTML.length - 6) == "--&gt;") sPreloadHTML = sPreloadHTML.substring(4, sPreloadHTML.length - 6);
	sPreloadHTML = sPreloadHTML.replace(/&lt;/g, "<");
	sPreloadHTML = sPreloadHTML.replace(/&gt;/g, ">");
	sPreloadHTML = sPreloadHTML.replace(/&amp;/g, "&");
	if (this.cmdContentBlock != ";") this.btnContentBlock = true;
	if (this.cmdInternalLink != ";") this.btnInternalLink = true;
	if (this.cmdInternalImage != ";") this.btnInternalImage = true;
	if (this.cmdCustomObject != ";") this.btnCustomObject = true;
	if (this.arrCustomTag.length > 0) this.btnCustomTag = true;
	if (this.mode == "HTMLBody") {
		this.btnXHTMLSource = true;
		this.btnXHTMLFullSource = false
	}
	if (this.mode == "HTML") {
		this.btnXHTMLFullSource = true;
		this.btnXHTMLSource = false
	}
	if (this.mode == "XHTMLBody") {
		this.btnXHTMLSource = true;
		this.btnXHTMLFullSource = false
	}
	if (this.mode == "XHTML") {
		this.btnXHTMLFullSource = true;
		this.btnXHTMLSource = false
	}
	var bUseFeature = false;
	if (this.features.length > 0) {
		bUseFeature = true;
		for (var i = 0; i < this.buttonMap.length; i++) eval(this.oName + ".btn" + this.buttonMap[i] + "=true");
		this.btnTextFormatting = false;
		this.btnListFormatting = false;
		this.btnBoxFormatting = false;
		this.btnParagraphFormatting = false;
		this.btnCssText = false;
		this.btnCssBuilder = false;
		for (var j = 0; j < this.features.length; j++) eval(this.oName + ".btn" + this.features[j] + "=true");
		for (var i = 0; i < this.buttonMap.length; i++) {
			sButtonName = this.buttonMap[i];
			bBtnExists = false;
			for (var j = 0; j < this.features.length; j++) if (sButtonName == this.features[j]) bBtnExists = true;
			if (!bBtnExists) eval(this.oName + ".btn" + sButtonName + "=false")
		}
		this.buttonMap = this.features
	}
	this.preloadHTML = sPreloadHTML;
	var sHTMLDropMenus = "";
	var sHTMLIcons = "";
	var sTmp = "";
	this.oColor1.url = this.scriptPath + "color_picker_fg.htm";
	this.oColor1.onShow = new Function(this.oName + ".hide()");
	this.oColor1.onMoreColor = new Function(this.oName + ".hide()");
	this.oColor1.onPickColor = new Function(this.oName + ".applyColor('ForeColor', " + this.oName + ".oColor1.color)");
	this.oColor1.onRemoveColor = new Function(this.oName + ".applyColor('ForeColor','')");
	this.oColor1.txtCustomColors = getTxt("Custom Colors");
	this.oColor1.txtMoreColors = getTxt("More Colors...");
	this.oColor2.url = this.scriptPath + "color_picker_bg.htm";
	this.oColor2.onShow = new Function(this.oName + ".hide()");
	this.oColor2.onMoreColor = new Function(this.oName + ".hide()");
	this.oColor2.onPickColor = new Function(this.oName + ".applyColor('hilitecolor', " + this.oName + ".oColor2.color)");
	this.oColor2.onRemoveColor = new Function(this.oName + ".applyColor('HiliteColor','')");
	this.oColor2.txtCustomColors = getTxt("Custom Colors");
	this.oColor2.txtMoreColors = getTxt("More Colors...");
	var me = this;
	if (this.toolbarMode != 0) {
		var tmp = null,
		tmpTb, grpMap = new Object();
		for (var i = 0; i < this.buttonMap.length; i++) {
			eval(this.oName + ".btn" + this.buttonMap[i] + "=false")
		}
		for (var i = 0; i < this.groups.length; i++) {
			tmp = this.groups[i];
			tmpTb = this.tbar.createToolbar(this.oName + "tbar" + tmp[0]);
			tmpTb.onClick = function (id) {
				tbAction(tmpTb, id, me, me.oName)
			};
			tmpTb.style.toolbar = "main_istoolbar";
			tmpTb.iconPath = this.scriptPath.substring(0, this.scriptPath.indexOf("moz/")) + this.iconPath;
			tmpTb.btnWidth = this.iconWidth;
			tmpTb.btnHeight = this.iconHeight;
			for (var j = 0; j < tmp[2].length; j++) {
				eval(this.oName + ".btn" + tmp[2][j] + "=true")
			}
			buildToolbar(tmpTb, this, tmp[2]);
			grpMap[tmp[0]] = tmp[1]
		}
		if (this.toolbarMode == 1) {
			var eTab = this.tbar.createTbTab("tabCtl" + this.oName),
			tmpGrp;
			for (var i = 0; i < this.tabs.length; i++) {
				tmp = this.tabs[i];
				tmpGrp = this.tbar.createTbGroup(this.oName + "grp" + tmp[0]);
				for (var j = 0; j < tmp[2].length; j++) {
					tmpGrp.addGroup(this.oName + tmp[2][j], grpMap[tmp[2][j]], this.oName + "tbar" + tmp[2][j])
				}
				eTab.addTab(this.oName + tmp[0], tmp[1], tmpGrp)
			}
		} else if (this.groups.length > 0) {
			var tmpGrp;
			tmpGrp = this.tbar.createTbGroup(this.oName + "grp");
			for (var i = 0; i < this.groups.length; i++) {
				tmp = this.groups[i];
				tmpGrp.addGroup(this.oName + tmp[0], grpMap[tmp[0]], this.oName + "tbar" + tmp[0])
			}
		}
	} else {
		var orTb = this.tbar.createToolbar(this.oName);
		orTb.onClick = function (id) {
			tbAction(orTb, id, me, me.oName)
		};
		orTb.iconPath = this.scriptPath.substring(0, this.scriptPath.indexOf("moz/")) + this.iconPath;
		orTb.btnWidth = this.iconWidth;
		orTb.btnHeight = this.iconHeight;
		buildToolbar(orTb, this, this.buttonMap)
	}
	var sHTML = "";
	var icPath = this.scriptPath.substring(0, this.scriptPath.indexOf("moz/")) + this.iconPath;
	if (!document.getElementById("id_refresh_z_index")) sHTML += "<div id=id_refresh_z_index style='margin:0px'></div>";
	sHTML += "<table id=idArea" + this.oName + " name=idArea" + this.oName + " border='0px' " + "cellpadding=0 cellspacing=0 width='" + this.width + "' height='" + this.height + "' style='border-bottom:#cfcfcf 1px solid'>" + "<tr><td colspan=2 style=\"padding:0px;border:#cfcfcf 0px solid;background:url('" + icPath + "bg.gif')\">" + "<table cellpadding=0 cellspacing=0 border=0 width=100%><tr><td dir=ltr style='padding:0px;'>" + this.tbar.render() + "</td></tr></table>" + "</td></tr>" + "<tr id=idTagSelTopRow" + this.oName + "><td colspan=2 id=idTagSelTop" + this.oName + " height=0px style='padding:0px;'></td></tr>";
	sHTML += "<tr style='width:100%;height:100%'><td colspan=2 valign=top height=100% style='padding:0px;background:white;padding-right:0px;'>";
	sHTML += "<table id='cntContainer" + this.oName + "' cellpadding=0 cellspacing=0 width='100%' height='100%' style='margin-top:0px;'><tr style='width:100%;height:100%'><td width='100%' height='100%' style='padding:0px;border:solid 1px #cfcfcf;border-bottom:none'>";
	sHTML += "<iframe style='width:100%;height:100%;border:none;' " + " name=idContent" + this.oName + " id=idContent" + this.oName + "></iframe>";
	sHTML += "<iframe style='position:absolute;left:-1000px;top:-1000px;width:1px;height:1px;overflow:auto;' " + " name='idContentWord" + this.oName + "' id='idContentWord" + this.oName + "'></iframe>";
	sHTML += "<iframe style='width:1px;height:1px;overflow:auto;border:0px' id=\"myStyle" + this.oName + "\" name=\"myStyle" + this.oName + "\" src='" + this.scriptPath + "blank.gif'></iframe>";
	sHTML += "</td><td id=idStyles" + this.oName + " style='padding:0px;background:#f4f4f4'></td></tr></table>";
	sHTML += "</td></tr>";
	sHTML += "<tr id=idTagSelBottomRow" + this.oName + "><td colspan=2 id=idTagSelBottom" + this.oName + " style='padding:0px;'></td></tr>";
	if (this.showResizeBar) {
		sHTML += "<tr id=idResizeBar" + this.oName + "><td colspan=2 style='padding:0px;'><div style='cursor:n-resize;' class='resize_bar' onmousedown=\"onEditorStartResize(event, this, '" + this.oName + "')\" ></div></td></tr>"
	}
	sHTML += "</table>";
	sHTML += sHTMLDropMenus;
	sHTML += "<input type=submit name=iwe_btnSubmit" + this.oName + " id=iwe_btnSubmit" + this.oName + " value=SUBMIT style='display:none' >";
	if (typeof(dvId) == 'string')
        {
            document.getElementById(dvId).innerHTML = sHTML;
	}
        else if(typeof(dvId) == 'object')
        {
            dvId.innerHTML = sHTML;
        }
        else
        {
            document.write(sHTML);
	}
	var me = this;
	setTimeout(function (){
            me.init()
	},
	10)
};
function onEditorStartResize(ev, elm, oName) {
	document.onmousemove = onEditorResize;
	document.onmouseup = onEditorStopResize;
	document.onselectstart = function () {
		return false
	};
	document.ondragstart = function () {
		return false
	};
	document.body.style.cursor = "n-resize";
	oUtil.currentResized = eval(oName);
	oUtil.resizeInit = {
		x: ev.screenX,
		y: ev.screenY
	};
	if (!oUtil.isWindow) oUtil.isWindow = new ISWindow(oName);
	oUtil.isWindow.showOverlay();
	ev.preventDefault()
};
function onEditorStopResize(event) {
	oUtil.resizeOffset = {
		dx: event.screenX - oUtil.resizeInit.x,
		dy: event.screenY - oUtil.resizeInit.y
	};
	oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);
	oUtil.isWindow.hideOverlay();
	document.onmousemove = null;
	document.onmouseup = null;
	document.body.style.cursor = "default"
};
function onEditorResize(event) {
	oUtil.resizeOffset = {
		dx: event.screenX - oUtil.resizeInit.x,
		dy: event.screenY - oUtil.resizeInit.y
	};
	oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);
	oUtil.resizeInit = {
		x: event.screenX,
		y: event.screenY
	}
};
function initISEditor() {
	if (this.useTagSelector) {
		if (this.TagSelectorPosition == "bottom") this.TagSelectorPosition = "top";
		else this.TagSelectorPosition = "bottom";
		this.moveTagSelector()
	}
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	oUtil.oName = this.oName;
	oUtil.oEditor = oEditor;
	oUtil.obj = this;
	oUtil.arrEditor.push(this.oName);
	try {
		oEditor.document.designMode = "on"
	} catch(e) {}
	var arrA = String(this.preloadHTML).match(/<HTML[^>]*>/ig);
	if (arrA) {
		this.loadHTMLFull(this.preloadHTML)
	} else {
		this.loadHTML(this.preloadHTML)
	}
	if (!oUtil.bOnLoadReplaced) {
		if (window.onload) onload_original = window.onload;
		window.onload = new Function("onload_new()");
		oUtil.bOnLoadReplaced = true
	}
	this.focus();
	try {
		var cnt = oEditor.document.body.innerHTML;
		cnt = cnt.replace(/\s+/gi, "");
		if (cnt == "") {
			oEditor.document.body.innerHTML = "<br class=\"innova\" />"
		}
		var range = oEditor.document.createRange();
		range.selectNode(oEditor.document.body.childNodes[0]);
		range.collapse(true);
		var sel = oEditor.getSelection();
		sel.removeAllRanges();
		sel.addRange(range)
	} catch(e) {}
	switch (this.mode) {
	case "HTMLBody":
		this.originalContent = this.getHTMLBody();
		break;
	case "HTML":
		this.originalContent = this.getHTML();
		break;
	case "XHTMLBody":
		this.originalContent = this.getXHTMLBody();
		break;
	case "XHTML":
		this.originalContent = this.getXHTML();
		break
	};
	this.focus()
};
function buildToolbar(tb, oEdt, btnMap) {
	var oName = oEdt.oName;
	for (var i = 0; i < btnMap.length; i++) {
		sButtonName = btnMap[i];
		switch (sButtonName) {
		case "|":
			tb.addSeparator();
			break;
		case "BRK":
			tb.addBreak();
			break;
		case "Save":
			if (oEdt.btnSave) tb.addButton("btnSave" + oName, "btnSave.gif", getTxt("Save"));
			break;
		case "Preview":
			if (oEdt.btnPreview) {
				tb.addDropdownButton("btnPreview" + oName, "ddPreview" + oName, "btnPreview.gif", getTxt("Preview"));
				var pvDD = new ISDropdown("ddPreview" + oName);
				pvDD.addItem("btnPreview1" + oName, "640x480");
				pvDD.addItem("btnPreview2" + oName, "800x600");
				pvDD.addItem("btnPreview3" + oName, "1024x768");
				pvDD.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				}
			}
			break;
		case "FullScreen":
			if (oEdt.btnFullScreen) tb.addButton("btnFullScreen" + oName, "btnFullScreen.gif", getTxt("Full Screen"));
			break;
		case "Print":
			if (oEdt.btnPrint) tb.addButton("btnPrint" + oName, "btnPrint.gif", getTxt("Print"));
			break;
		case "Search":
			if (oEdt.btnSearch) tb.addButton("btnSearch" + oName, "btnSearch.gif", getTxt("Search"));
			break;
		case "SpellCheck":
			if (oEdt.btnSpellCheck) {
				if (oEdt.spellCheckMode != "ieSpell") tb.addButton("btnSpellCheck" + oName, "btnSpellCheck.gif", getTxt("Check Spelling"))
			}
			break;
		case "StyleAndFormatting":
			if (oEdt.btnTextFormatting || oEdt.btnParagraphFormatting || oEdt.btnListFormatting || oEdt.btnBoxFormatting || oEdt.btnCssText || oEdt.btnCssBuilder) {
				tb.addDropdownButton("btnStyleAndFormat" + oName, "ddFormatting" + oName, "btnStyle.gif", getTxt("Styles & Formatting"));
				var ddFmt = new ISDropdown("ddFormatting" + oName);
				ddFmt.iconPath = tb.iconPath;
				ddFmt.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				if (oEdt.btnTextFormatting) ddFmt.addItem("btnTextFormatting" + oName, getTxt("Text Formatting"), "btnTextFormatting.gif");
				if (oEdt.btnParagraphFormatting) ddFmt.addItem("btnParagraphFormatting" + oName, getTxt("Paragraph Formatting"), "btnParagraphFormatting.gif");
				if (oEdt.btnListFormatting) ddFmt.addItem("btnListFormatting" + oName, getTxt("List Formatting"), "btnListFormatting.gif");
				if (oEdt.btnBoxFormatting) ddFmt.addItem("btnBoxFormatting" + oName, getTxt("Box Formatting"), "btnBoxFormatting.gif");
				if (oEdt.btnCssText) ddFmt.addItem("btnCssText" + oName, getTxt("Custom CSS"), "btnCustomCss.gif");
				if (oEdt.btnCssBuilder) ddFmt.addItem("btnCssBuilder" + oName, getTxt("CSS Builder"))
			}
			break;
		case "Styles":
			if (oEdt.btnStyles) tb.addButton("btnStyles" + oName, "btnStyleSelect.gif", getTxt("Style Selection"));
			break;
		case "Paragraph":
			if (oEdt.btnParagraph) {
				tb.addDropdownButton("btnParagraph" + oName, "ddParagraph" + oName, "btnParagraph.gif", getTxt("Paragraph"), 37);
				var ddPar = new ISDropdown("ddParagraph" + oName);
				ddPar.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				for (var j = 0; j < oEdt.arrParagraph.length; j++) {
					ddPar.addItem("btnParagraph_" + j + oName, "<" + oEdt.arrParagraph[j][1] + " style=\"\margin-bottom:4px\"  unselectable=on> " + oEdt.arrParagraph[j][0] + "</" + oEdt.arrParagraph[j][1] + ">")
				}
			}
			break;
		case "FontName":
			if (oEdt.btnFontName) {
				tb.addDropdownButton("btnFontName" + oName, "ddFontName" + oName, "btnFontName.gif", getTxt("Font Name"), 37);
				var ddFont = new ISDropdown("ddFontName" + oName);
				ddFont.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				for (var j = 0; j < oEdt.arrFontName.length; j++) {
					ddFont.addItem("btnFontName_" + j + oName, "<span style='font-family:" + oEdt.arrFontName[j] + "' unselectable=on>" + oEdt.arrFontName[j] + "</span><span unselectable=on style='font-family:tahoma'>(" + oEdt.arrFontName[j] + ")</span>")
				}
			}
			break;
		case "FontSize":
			if (oEdt.btnFontSize) {
				tb.addDropdownButton("btnFontSize" + oName, "ddFontSize" + oName, "btnFontSize.gif", getTxt("Font Size"), 37);
				var ddFs = new ISDropdown("ddFontSize" + oName);
				ddFs.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				for (var j = 0; j < oEdt.arrFontSize.length; j++) {
					ddFs.addItem("btnFontSize_" + j + oName, "<font unselectable=on size=\"" + oEdt.arrFontSize[j][1] + "\">" + oEdt.arrFontSize[j][0] + "</font>")
				}
			}
			break;
		case "Undo":
			if (oEdt.btnUndo) tb.addButton("btnUndo" + oName, "btnUndo.gif", getTxt("Undo"));
			break;
		case "Redo":
			if (oEdt.btnRedo) tb.addButton("btnRedo" + oName, "btnRedo.gif", getTxt("Redo"));
			break;
		case "Paste":
			if (oEdt.btnPasteWord || oEdt.btnPasteText) {
				tb.addDropdownButton("btnPaste" + oName, "ddPaste" + oName, "btnPaste.gif", getTxt("Paste"));
				var pvDD = new ISDropdown("ddPaste" + oName);
				pvDD.iconPath = tb.iconPath;
				if (oEdt.btnPasteWord) pvDD.addItem("btnPasteWord" + oName, getTxt("Paste from Word"), "btnPasteWord.gif");
				if (oEdt.btnPasteText) pvDD.addItem("btnPasteText" + oName, getTxt("Paste Text"), "btnPasteText.gif");
				pvDD.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				}
			}
			break;
		case "Bold":
			if (oEdt.btnBold) tb.addToggleButton("btnBold" + oName, "", false, "btnBold.gif", getTxt("Bold"));
			break;
		case "Italic":
			if (oEdt.btnItalic) tb.addToggleButton("btnItalic" + oName, "", false, "btnItalic.gif", getTxt("Italic"));
			break;
		case "Underline":
			if (oEdt.btnUnderline) tb.addToggleButton("btnUnderline" + oName, "", false, "btnUnderline.gif", getTxt("Underline"));
			break;
		case "Strikethrough":
			if (oEdt.btnStrikethrough) tb.addToggleButton("btnStrikethrough" + oName, "", false, "btnStrikethrough.gif", getTxt("Strikethrough"));
			break;
		case "Superscript":
			if (oEdt.btnSuperscript) tb.addToggleButton("btnSuperscript" + oName, "", false, "btnSuperscript.gif", getTxt("Superscript"));
			break;
		case "Subscript":
			if (oEdt.btnSubscript) tb.addToggleButton("btnSubscript" + oName, "", false, "btnSubscript.gif", getTxt("Subscript"));
			break;
		case "JustifyLeft":
			if (oEdt.btnJustifyLeft) tb.addToggleButton("btnJustifyLeft" + oName, "align", false, "btnLeft.gif", getTxt("Justify Left"));
			break;
		case "JustifyCenter":
			if (oEdt.btnJustifyCenter) tb.addToggleButton("btnJustifyCenter" + oName, "align", false, "btnCenter.gif", getTxt("Justify Center"));
			break;
		case "JustifyRight":
			if (oEdt.btnJustifyRight) tb.addToggleButton("btnJustifyRight" + oName, "align", false, "btnRight.gif", getTxt("Justify Right"));
			break;
		case "JustifyFull":
			if (oEdt.btnJustifyFull) tb.addToggleButton("btnJustifyFull" + oName, "align", false, "btnFull.gif", getTxt("Justify Full"));
			break;
		case "Numbering":
			if (oEdt.btnNumbering) tb.addToggleButton("btnNumbering" + oName, "bullet", false, "btnNumber.gif", getTxt("Numbering"));
			break;
		case "Bullets":
			if (oEdt.btnBullets) tb.addToggleButton("btnBullets" + oName, "bullet", false, "btnList.gif", getTxt("Bullets"));
			break;
		case "Indent":
			if (oEdt.btnIndent) tb.addButton("btnIndent" + oName, "btnIndent.gif", getTxt("Indent"));
			break;
		case "Outdent":
			if (oEdt.btnOutdent) tb.addButton("btnOutdent" + oName, "btnOutdent.gif", getTxt("Outdent"));
			break;
		case "LTR":
			if (oEdt.btnLTR) tb.addToggleButton("btnLTR" + oName, "dir", false, "btnLTR.gif", getTxt("Left To Right"));
			break;
		case "RTL":
			if (oEdt.btnRTL) tb.addToggleButton("btnRTL" + oName, "dir", false, "btnRTL.gif", getTxt("Right To Left"));
			break;
		case "ForeColor":
			tb.addDropdownButton("btnForeColor" + oName, "ddForeColor" + oName, "btnForeColor.gif", getTxt("Foreground Color"));
			var ddTable = new ISDropdown("ddForeColor" + oName);
			ddTable.add(new ISCustomDDItem("btnInsertForeColor", oEdt.oColor1.generateHTML()));
			break;
		case "BackColor":
			tb.addDropdownButton("btnBackColor" + oName, "ddBackColor" + oName, "btnBackColor.gif", getTxt("Background Color"));
			var ddTable = new ISDropdown("ddBackColor" + oName);
			ddTable.add(new ISCustomDDItem("btnInsertBackColor", oEdt.oColor2.generateHTML()));
			break;
		case "Bookmark":
			if (oEdt.btnBookmark) tb.addButton("btnBookmark" + oName, "btnBookmark.gif", getTxt("Bookmark"));
			break;
		case "Hyperlink":
			if (oEdt.btnHyperlink) tb.addButton("btnHyperlink" + oName, "btnHyperlink.gif", getTxt("Hyperlink"));
			break;
		case "CustomTag":
			if (oEdt.btnCustomTag) {
				tb.addDropdownButton("btnCustomTag" + oName, "ddCustomTag" + oName, "btnCustomTag.gif", getTxt("Tags"), 37);
				var ddCustomTag = new ISDropdown("ddCustomTag" + oName);
				ddCustomTag.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				for (var j = 0; j < oEdt.arrCustomTag.length; j++) {
					ddCustomTag.addItem("btnCustomTag_" + j + oName, oEdt.arrCustomTag[j][0])
				}
			}
			break;
		case "Image":
			if (oEdt.btnImage) tb.addButton("btnImage" + oName, "btnImage.gif", getTxt("Image"));
			break;
		case "Flash":
			if (oEdt.btnFlash) tb.addButton("btnFlash" + oName, "btnFlash.gif", getTxt("Flash"));
			break;
		case "Media":
			if (oEdt.btnMedia) tb.addButton("btnMedia" + oName, "btnMedia.gif", getTxt("Media"));
			break;
		case "YoutubeVideo":
			if (oEdt.btnYoutubeVideo) tb.addButton("btnYoutubeVideo" + oName, "btnYoutubeVideo.gif", getTxt("YoutubeVideo"));
			break;
		case "ContentBlock":
			if (oEdt.btnContentBlock) tb.addButton("btnContentBlock" + oName, "btnContentBlock.gif", getTxt("Content Block"));
			break;
		case "InternalLink":
			if (oEdt.btnInternalLink) tb.addButton("btnInternalLink" + oName, "btnInternalLink.gif", getTxt("Internal Link"));
			break;
		case "InternalImage":
			if (oEdt.btnInternalImage) tb.addButton("btnInternalImage" + oName, "btnInternalImage.gif", getTxt("Internal Image"));
			break;
		case "CustomObject":
			if (oEdt.btnCustomObject) tb.addButton("btnCustomObject" + oName, "btnCustomObject.gif", getTxt("Object"));
			break;
		case "Table":
			if (oEdt.btnTable) {
				var sdd = [],
				sZ = 0;
				sdd[sZ++] = "<table width='175' id='dropTableCreate" + oName + "' style='cursor:default;background:#f3f3f8;' cellpadding=0 cellspacing=1 unselectable=on>";
				for (var m = 0; m < 8; m++) {
					sdd[sZ++] = "<tr>";
					for (var n = 0; n < 8; n++) {
						sdd[sZ++] = "<td onclick='" + oName + ".doClick_TabCreate(this)' onmouseover='doOver_TabCreate(this);event.cancelBubble=true;' style='background:#ffffff;font-size:1px;border:#d3d3d3 1px solid;width:20px;height:20px;' unselectable=on>&nbsp;</td>"
					}
					sdd[sZ++] = "</tr>"
				}
				sdd[sZ++] = "<tr><td colspan=8 onclick=\"" + oName + ".hide();modelessDialogShow('" + oEdt.scriptPath + "table_insert.htm',380,360);\" onmouseover=\"doOut_TabCreate(document.getElementById('dropTableCreate" + oName + "'));this.innerHTML='" + getTxt("Advanced Table Insert") + "';this.style.border='#777777 1px solid';this.style.backgroundColor='#444444';this.style.color='#ffffff'\" onmouseout=\"this.style.border='#f3f3f8 1px solid';this.style.backgroundColor='#f3f3f8';this.style.color='#000000'\" align=center style='font-family:verdana;font-size:10px;color:#000000;border:#f3f3f8 1px solid;padding:1px 1px 1px 1px' unselectable=on>" + getTxt("Advanced Table Insert") + "</td></tr>";
				sdd[sZ++] = "</table>";
				tb.addDropdownButton("btnTable" + oName, "ddTable" + oName, "btnTable.gif", getTxt("Insert Table"));
				var ddTable = new ISDropdown("ddTable" + oName);
				ddTable.add(new ISCustomDDItem("btnInsertTable", sdd.join("")));
				tb.addDropdownButton("btnTableEdit" + oName, "ddTableEdit" + oName, "btnTableEdit.gif", getTxt("Edit Table/Cell"));
				var ddTblEdit = new ISDropdown("ddTableEdit" + oName);
				ddTblEdit.iconPath = tb.iconPath;
				ddTblEdit.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				ddTblEdit.addItem("mnuTableSize" + oName, getTxt("Table Size"), "btnTableSize.gif");
				ddTblEdit.addItem("mnuTableEdit" + oName, getTxt("Edit Table"), "btnEditTable.gif");
				ddTblEdit.addItem("mnuCellEdit" + oName, getTxt("Edit Cell"), "btnEditCell.gif")
			}
			break;
		case "AutoTable":
			if (oEdt.btnAutoTable) tb.addButton("btnAutoTable" + oName, "btnAutoTable.gif", getTxt("AutoTable"));
			break;
		case "Absolute":
			if (oEdt.btnAbsolute) tb.addButton("btnAbsolute" + oName, "btnAbsolute.gif", getTxt("Absolute"));
			break;
		case "Characters":
			if (oEdt.btnCharacters) tb.addButton("btnCharacters" + oName, "btnSymbol.gif", getTxt("Special Characters"));
			break;
		case "Line":
			if (oEdt.btnLine) tb.addButton("btnLine" + oName, "btnLine.gif", getTxt("Line"));
			break;
		case "Form":
			if (oEdt.btnForm) {
				var arrFormMenu = [[getTxt("Form"), "form_form.htm", "280", "177"], [getTxt("Text Field"), "form_text.htm", "285", "289"], [getTxt("List"), "form_list.htm", "295", "332"], [getTxt("Checkbox"), "form_check.htm", "235", "174"], [getTxt("Radio Button"), "form_radio.htm", "235", "177"], [getTxt("Hidden Field"), "form_hidden.htm", "235", "152"], [getTxt("File Field"), "form_file.htm", "235", "132"], [getTxt("Button"), "form_button.htm", "235", "174"]];
				tb.addDropdownButton("btnForm" + oName, "ddForm" + oName, "btnForm.gif", getTxt("Form Editor"));
				var ddForm = new ISDropdown("ddForm" + oName);
				ddForm.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				for (var j = 0; j < arrFormMenu.length; j++) {
					ddForm.addItem("btnForm" + j + oName, arrFormMenu[j][0])
				}
			}
			break;
		case "RemoveFormat":
			if (oEdt.btnRemoveFormat) tb.addButton("btnRemoveFormat" + oName, "btnRemoveFormat.gif", getTxt("Remove Formatting"));
			break;
		case "HTMLFullSource":
			if (oEdt.btnHTMLFullSource) tb.addButton("btnHTMLFullSource" + oName, "btnSource.gif", getTxt("View/Edit Source"));
			break;
		case "HTMLSource":
			if (oEdt.btnHTMLSource) tb.addButton("btnHTMLSource" + oName, "btnSource.gif", getTxt("View/Edit Source"));
			break;
		case "XHTMLFullSource":
			if (oEdt.btnXHTMLFullSource) tb.addButton("btnXHTMLFullSource" + oName, "btnSource.gif", getTxt("View/Edit Source"));
			break;
		case "XHTMLSource":
			if (oEdt.btnXHTMLSource) tb.addButton("btnXHTMLSource" + oName, "btnSource.gif", getTxt("View/Edit Source"));
			break;
		case "ClearAll":
			if (oEdt.btnClearAll) tb.addButton("btnClearAll" + oName, "btnDelete.gif", getTxt("Clear All"));
			break;
		default:
			for (j = 0; j < oEdt.arrCustomButtons.length; j++) {
				if (sButtonName == oEdt.arrCustomButtons[j][0]) {
					sCbName = oEdt.arrCustomButtons[j][0];
					sCbCaption = oEdt.arrCustomButtons[j][2];
					sCbImage = oEdt.arrCustomButtons[j][3];
					if (oEdt.arrCustomButtons[j][4]) tb.addButton(sCbName + oName, sCbImage, sCbCaption, oEdt.arrCustomButtons[j][4]);
					else tb.addButton(sCbName + oName, sCbImage, sCbCaption)
				}
			}
			break
		}
	}
};
function iwe_getElm(s) {
	return document.getElementById(s + this.oName)
};
function onload_new() {
	onload_original()
};
function onload_original() {};
var arrColorPickerObjects = [];
function ColorPicker(sName, sParent) {
	this.oParent = sParent;
	if (sParent) {
		this.oName = sParent + "." + sName;
		this.oRenderName = sName + sParent
	} else {
		this.oName = sName;
		this.oRenderName = sName
	}
	arrColorPickerObjects.push(this.oName);
	this.url = "color_picker.htm";
	this.onShow = function () {
		return true
	};
	this.onHide = function () {
		return true
	};
	this.onPickColor = function () {
		return true
	};
	this.onRemoveColor = function () {
		return true
	};
	this.onMoreColor = function () {
		return true
	};
	this.show = showColorPicker;
	this.hide = hideColorPicker;
	this.hideAll = hideColorPickerAll;
	this.color;
	this.customColors = [];
	this.refreshCustomColor = refreshCustomColor;
	this.isActive = false;
	this.txtCustomColors = "Custom Colors";
	this.txtMoreColors = "More Colors...";
	this.align = "left";
	this.currColor = "#ffffff";
	this.generateHTML = generateHTML;
	this.RENDER = drawColorPicker
};
function generateHTML() {
	var arrColors = [["#800000", "#8b4513", "#006400", "#2f4f4f", "#000080", "#4b0082", "#800080", "#000000"], ["#ff0000", "#daa520", "#6b8e23", "#708090", "#0000cd", "#483d8b", "#c71585", "#696969"], ["#ff4500", "#ffa500", "#808000", "#4682b4", "#1e90ff", "#9400d3", "#ff1493", "#a9a9a9"], ["#ff6347", "#ffd700", "#32cd32", "#87ceeb", "#00bfff", "#9370db", "#ff69b4", "#dcdcdc"], ["#ffdab9", "#ffffe0", "#98fb98", "#e0ffff", "#87cefa", "#e6e6fa", "#dda0dd", "#ffffff"]];
	var sHTMLColor = "<table id=dropColor" + this.oRenderName + " style=\"cursor:default;background-color:#f4f4f4;padding:2px\" unselectable=on cellpadding=0 cellspacing=0 width=145px><tr><td unselectable=on style='padding:0px;'>";
	sHTMLColor += "<table align=center cellpadding=0 cellspacing=0 border=0 unselectable=on>";
	for (var i = 0; i < arrColors.length; i++) {
		sHTMLColor += "<tr>";
		for (var j = 0; j < arrColors[i].length; j++) sHTMLColor += "<td onclick=\"" + this.oName + ".color='" + arrColors[i][j] + "';" + this.oName + ".onPickColor();" + this.oName + ".currColor='" + arrColors[i][j] + "';" + this.oName + ".hideAll()\" onmouseover=\"this.style.border='#777777 1px solid'\" onmouseout=\"this.style.border='#f4f4f4 1px solid'\" style=\"padding:0px;cursor:default;padding:1px;border:#f4f4f4 1px solid;\" unselectable=on>" + "<table style='margin:0px;width:13px;height:13px;background:" + arrColors[i][j] + ";border:white 1px solid' cellpadding=0 cellspacing=0 unselectable=on>" + "<tr><td unselectable=on style='padding:0px;'></td></tr>" + "</table></td>";
		sHTMLColor += "</tr>"
	}
	sHTMLColor += "<tr><td colspan=8 id=idCustomColor" + this.oRenderName + " style='padding:0px;'></td></tr>";
	sHTMLColor += "<tr>";
	sHTMLColor += "<td unselectable=on style='padding:0px;'>" + "<table style='padding:0px;margin-left:1px;width:14px;height:14px;background:#f4f4f4;' cellpadding=0 cellspacing=0 unselectable=on>" + "<tr><td onclick=\"" + this.oName + ".onRemoveColor();" + this.oName + ".currColor='';" + this.oName + ".hideAll()\" onmouseover=\"this.style.border='#777777 1px solid'\" onmouseout=\"this.style.border='white 1px solid'\" style=\"cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;\" align=center valign=top unselectable=on>x</td></tr>" + "</table></td>";
	sHTMLColor += "<td colspan=7 unselectable=on style='padding:0px;'>" + "<table style='padding:0px;margin:1px;width:117px;height:16px;background:#f4f4f4;border:white 1px solid' cellpadding=0 cellspacing=0 unselectable=on>" + "<tr><td id=\"" + this.oName + "moreColTd\" onclick=\"" + this.oName + ".onMoreColor();" + this.oName + ".hideAll();modelessDialogShow('" + this.url + "?" + this.oName + "', 444, 430, window,{'oName':'" + this.oName + "'})\" onmouseover=\"this.style.border='#777777 1px solid';this.style.background='#444444';this.style.color='#ffffff'\" onmouseout=\"this.style.border='#f4f4f4 1px solid';this.style.background='#f4f4f4';this.style.color='#000000'\" style=\"cursor:default;font-family:verdana;font-size:9px;color:#000000;line-height:9px;padding:1px\" align=center valign=top nowrap unselectable=on>" + this.txtMoreColors + "</td></tr>" + "</table></td>";
	sHTMLColor += "</tr>";
	sHTMLColor += "</table>";
	sHTMLColor += "</td></tr></table>";
	return sHTMLColor
};
function drawColorPicker() {
	document.write(this.generateHTML())
};
function refreshCustomColor() {
	this.customColors = eval(this.oParent).customColors;
	if (this.customColors.length == 0) {
		document.getElementById("idCustomColor" + this.oRenderName).innerHTML = "";
		return
	}
	sHTML = "<table cellpadding=0 cellspacing=0 width=100%><tr><td colspan=8 style=\"font-family:verdana;font-size:9px;color:#000000;line-height:9px;padding:1px\">" + this.txtCustomColors + ":</td></tr></table>";
	sHTML += "<table cellpadding=0 cellspacing=0><tr>";
	for (var i = 0; i < this.customColors.length; i++) {
		if (i < 22) {
			if (i == 8 || i == 16 || i == 24 || i == 32) sHTML += "</tr></table><table cellpadding=0 cellspacing=0><tr>";
			sHTML += "<td onclick=\"" + this.oName + ".color='" + this.customColors[i] + "';" + this.oName + ".onPickColor()\" onmouseover=\"this.style.border='#777777 1px solid'\" onmouseout=\"this.style.border='#f4f4f4 1px solid'\" style=\"cursor:default;padding:1px;border:#f4f4f4 1px solid;\" unselectable=on>" + "   <table  style='margin:0px;width:13px;height:13px;background:" + this.customColors[i] + ";border:white 1px solid' cellpadding=0 cellspacing=0 unselectable=on>" + "   <tr><td unselectable=on></td></tr>" + "   </table>" + "</td>"
		}
	}
	sHTML += "</tr></table>";
	document.getElementById("idCustomColor" + this.oRenderName).innerHTML = sHTML
};
function showColorPicker(oEl) {
	this.refreshCustomColor()
};
function hideColorPicker() {
	this.onHide();
	return;
	var box = document.getElementById("dropColor" + this.oRenderName);
	box.style.display = "none";
	this.isActive = false
};
function hideColorPickerAll() {
	return;
	for (var i = 0; i < arrColorPickerObjects.length; i++) {
		var box = document.getElementById("dropColor" + eval(arrColorPickerObjects[i]).oRenderName);
		box.style.display = "none";
		eval(arrColorPickerObjects[i]).isActive = false
	}
};
function loadHTML(sHTML) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oDoc = oEditor.document.open("text/html");
	if (this.publishingPath != "") {
		var arrA = String(this.preloadHTML).match(/<base[^>]*>/ig);
		if (!arrA) {
			sHTML = this.docType + "<html><head><base href=\"" + this.publishingPath + "\"/>" + this.headContent + "</head><body>" + sHTML + "</body></html>"
		}
	} else {
		sHTML = this.docType + "<html><head>" + this.headContent + "</head><body>" + sHTML + "</body></html>"
	}
	oDoc.write(sHTML);
	oDoc.close();
	var me = this;
	oEditor.document.addEventListener("keyup", new Function("editorDoc_onkeyup(" + this.oName + ")"), true);
	oEditor.document.addEventListener("mouseup", function (e) {
		editorDoc_onmouseup(e, me.oName)
	},
	true);
	oEditor.document.addEventListener("keydown", new Function("var e=arguments[0];doKeyPress(eval(e), " + this.oName + ")"), false);
	if (this.arrStyle.length > 0) {
		var oElement = oEditor.document.createElement("STYLE");
		oEditor.document.documentElement.childNodes[0].appendChild(oElement);
		var sCssText = "";
		for (var i = 0; i < this.arrStyle.length; i++) {
			selector = this.arrStyle[i][0];
			style = this.arrStyle[i][3];
			sCssText += selector + " { " + style + " } "
		}
		oElement.appendChild(oEditor.document.createTextNode(sCssText))
	}
	var objL = oEditor.document.createElement("LINK");
	objL.href = this.scriptPath + "default_edit.css";
	objL.rel = "StyleSheet";
	objL.id = "tmp_xxinnova";
	oEditor.document.documentElement.childNodes[0].appendChild(objL);
	if (this.css != "") {
		objL = oEditor.document.createElement("LINK");
		objL.href = this.css;
		objL.rel = "StyleSheet";
		oEditor.document.documentElement.childNodes[0].appendChild(objL)
	}
	this.cleanDeprecated()
};
function loadHTMLFull(sHTML, firstLoad) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var arrA = String(sHTML).match(/<!DOCTYPE[^>]*>/ig);
	if (arrA) for (var i = 0; i < arrA.length; i++) {
		this.docType = arrA[i]
	} else this.docType = "";
	var arrB = String(sHTML).match(/<HTML[^>]*>/ig);
	if (arrB) for (var i = 0; i < arrB.length; i++) {
		s = arrB[i];
		s = s.replace(/\"[^\"]*\"/ig, function (x) {
			x = x.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/'/g, "&apos;").replace(/\s+/ig, "#_#");
			return x
		});
		s = s.replace(/<([^ >]*)/ig, function (x) {
			return x.toLowerCase()
		});
		s = s.replace(/ ([^=]+)=([^" >]+)/ig, " $1=\"$2\"");
		s = s.replace(/ ([^=]+)=/ig, function (x) {
			return x.toLowerCase()
		});
		s = s.replace(/#_#/ig, " ");
		this.html = s
	} else this.html = "<html>";
	if (this.publishingPath != "") {
		var arrA = sHTML.match(/<base[^>]*>/ig);
		if (!arrA) {
			sHTML = "<BASE HREF=\"" + this.publishingPath + "\"/>" + sHTML
		}
	}
	if (firstLoad) {
		try {
			oEditor.document.designMode = "on"
		} catch(e) {}
	}
	var de = oEditor.document.documentElement;
	var reg = /<head>([\S\s]*?)<\/head>/gi;
	var res = reg.exec(sHTML),
	hcnt = "";
	if (res) hcnt = res[1];
	if (hcnt.indexOf("default_edit.css") == -1) {
		hcnt = hcnt + "<link id='tmp_xxinnova' rel='stylesheet' href='" + this.scriptPath + "default_edit.css" + "' />"
	}
	sHTML = sHTML.replace(reg, "<head>" + hcnt + "</head>");
	var oDoc = oEditor.document.open("text/html", "replace");
	oDoc.write(sHTML);
	oDoc.close();
	var me = this;
	oEditor.document.addEventListener("keyup", new Function("editorDoc_onkeyup(" + me.oName + ")"), true);
	oEditor.document.addEventListener("mouseup", function (e) {
		editorDoc_onmouseup(e, me.oName)
	},
	true);
	oEditor.document.addEventListener("keydown", new Function("var e=arguments[0];doKeyPress(eval(e), " + this.oName + ")"), false);
	this.cleanDeprecated()
}
function putHTML(sHTML) {
	this.loadHTMLFull(sHTML, true)
};
function encodeHTMLCode(sHTML) {
	return sHTML.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;")
};
function cleanHTML(sHTML) {
	var h = sHTML.replace(/<br class="innova" \/>/gi, "").replace(/<br class="innova">/gi, "");
	var sMatch = h.match(/<link[^>]*>/ig);
	if (sMatch) {
		for (var i = 0; i < sMatch.length; i++) {
			if (sMatch[i].indexOf("tmp_xxinnova") != -1) {
				h = h.replace(new RegExp(sMatch[i], "gi"), "")
			}
		}
	}
	return h
};
function getTextBody() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var sText = oEditor.document.body.textContent;
	sText = sText.replace(/<!(?:--[\s\S]*?--\s*)?>\s*/gi, "");
	return sText
};
function getHTML() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	this.cleanDeprecated();
	sHTML = getOuterHTML(oEditor.document.documentElement);
	sHTML = String(sHTML).replace(/ contentEditable=true/gi, "");
	sHTML = this.docType + sHTML;
	sHTML = oUtil.replaceSpecialChar(sHTML);
	if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);
	sHTML = cleanHTML(sHTML);
	return sHTML
};
function getHTMLBody() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	this.cleanDeprecated();
	sHTML = oEditor.document.body.innerHTML;
	sHTML = String(sHTML).replace(/ contentEditable=true/gi, "");
	sHTML = oUtil.replaceSpecialChar(sHTML);
	if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);
	sHTML = cleanHTML(sHTML);
	return sHTML
};
var sBaseHREF = "";
function getXHTML() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	this.cleanDeprecated();
	sHTML = getOuterHTML(oEditor.document.documentElement);
	var arrTmp = sHTML.match(/<BASE([^>]*)>/ig);
	if (arrTmp != null) sBaseHREF = arrTmp[0];
	var arrBase = oEditor.document.getElementsByTagName("BASE");
	if (arrBase.length != null) {
		for (var i = 0; i < arrBase.length; i++) {
			arrBase[i].parentNode.removeChild(arrBase[i])
		}
	}
	sBaseHREF = sBaseHREF.replace(/<([^ >]*)/ig, function (x) {
		return x.toLowerCase()
	});
	sBaseHREF = sBaseHREF.replace(/ [^=]+="[^"]+"/ig, function (x) {
		x = x.replace(/\s+/ig, "#_#");
		x = x.replace(/^#_#/, " ");
		return x
	});
	sBaseHREF = sBaseHREF.replace(/ ([^=]+)=([^" >]+)/ig, " $1=\"$2\"");
	sBaseHREF = sBaseHREF.replace(/ ([^=]+)=/ig, function (x) {
		return x.toLowerCase()
	});
	sBaseHREF = sBaseHREF.replace(/#_#/ig, " ");
	sBaseHREF = sBaseHREF.replace(/>$/ig, " \/>").replace(/\/ \/>$/ig, "\/>");
	sHTML = recur(oEditor.document.documentElement, "");
	sHTML = this.docType + this.html + sHTML + "\n</html>";
	sHTML = sHTML.replace(/<head>/i, "<head>" + sBaseHREF);
	sHTML = oUtil.replaceSpecialChar(sHTML);
	if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);
	sHTML = cleanHTML(sHTML);
	return sHTML
};
function getXHTMLBody() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	this.cleanDeprecated();
	sHTML = getOuterHTML(oEditor.document.documentElement);
	var arrTmp = sHTML.match(/<BASE([^>]*)>/ig);
	if (arrTmp != null) sBaseHREF = arrTmp[0];
	var arrBase = oEditor.document.getElementsByTagName("BASE");
	if (arrBase.length != null) {
		for (var i = 0; i < arrBase.length; i++) {
			arrBase[i].parentNode.removeChild(arrBase[i])
		}
	}
	sHTML = recur(oEditor.document.body, "");
	sHTML = oUtil.replaceSpecialChar(sHTML);
	if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);
	sHTML = cleanHTML(sHTML);
	return sHTML
};
function ApplyCSS(oName) {
	var sTmp = "";
	var myStyle = document.getElementById("myStyle" + oName).contentWindow;
	for (var i = 0; i < myStyle.document.styleSheets[0].cssRules.length; i++) {
		var sSelector = myStyle.document.styleSheets[0].cssRules[i].selectorText;
		if (sSelector != undefined) {
			sCssText = myStyle.document.styleSheets[0].cssRules[i].style.cssText.replace(/"/g, "&quot;");
			var itemCount = sSelector.split(".").length;
			if (itemCount > 1) {
				sCaption = sSelector.split(".")[1];
				sTmp += ",[\"" + sSelector + "\",true,\"" + sCaption + "\",\"" + sCssText + "\"]"
			} else sTmp += ",[\"" + sSelector + "\",false,\"\",\"" + sCssText + "\"]"
		}
	}
	var arrStyle = eval("[" + sTmp.substr(1) + "]");
	if (arrStyle.length > 0) {
		var oEditor = document.getElementById("idContent" + oName).contentWindow;
		var oElement = oEditor.document.createElement("STYLE");
		oEditor.document.documentElement.childNodes[0].appendChild(oElement);
		var sCssText = "";
		for (var i = 0; i < arrStyle.length; i++) {
			selector = arrStyle[i][0];
			style = arrStyle[i][3].replace(/&quot;/g, "\"");
			sCssText += selector + " { " + style + " } "
		}
		oElement.appendChild(oEditor.document.createTextNode(sCssText))
	}
};
function ApplyExternalStyle(oName) {
	var oEditor = document.getElementById("idContent" + oName).contentWindow;
	var sTmp = "";
	for (var j = 0; j < oEditor.document.styleSheets.length; j++) {
		var myStyle = oEditor.document.styleSheets[j];
		for (var i = 0; i < myStyle.cssRules.length; i++) {
			sSelector = myStyle.cssRules[i].selectorText;
			if (sSelector != undefined) {
				if (sSelector.match(/table\./gi)) {
					continue
				}
				sCssText = myStyle.cssRules[i].style.cssText.replace(/"/g, "&quot;");
				var itemCount = sSelector.split(".").length;
				if (itemCount > 1) {
					sCaption = sSelector.split(".")[1];
					sTmp += ",[\"" + sSelector + "\",true,\"" + sCaption + "\",\"" + sCssText + "\"]"
				} else sTmp += ",[\"" + sSelector + "\",false,\"\",\"" + sCssText + "\"]"
			}
		}
	}
	var arrStyle = eval("[" + sTmp.substr(1) + "]");
	var edtObj = eval(oName);
	for (var i = 0; i < arrStyle.length; i++) {
		for (var j = 0; j < edtObj.arrStyle.length; j++) {
			if (arrStyle[i][0].toLowerCase() == edtObj.arrStyle[j][0].toLowerCase()) {
				arrStyle[i][1] = edtObj.arrStyle[j][1];
				break
			}
		}
	}
	edtObj.arrStyle = arrStyle
};
function doApplyStyle(oName, sClassName) {
	var oEditor = document.getElementById("idContent" + oName).contentWindow;
	var oSel = oEditor.getSelection();
	eval(oName).saveForUndo();
	var element;
	if (oUtil.activeElement) {
		element = oUtil.activeElement;
		element.className = sClassName
	} else {
		element = getSelectedElement(oSel);
		if (isTextSelected(oSel)) {
			if (oSel != "") {
				eval(oName).applySpanStyle([], sClassName)
			} else {
				if (element.tagName == "BODY") return;
				element.className = sClassName
			}
		} else {
			if (element.tagName == "BODY") return;
			element.className = sClassName
		}
	}
	realTime(eval(oName))
};
function openStyleSelect() {
	if (!this.isCssLoaded) ApplyExternalStyle(this.oName);
	this.isCssLoaded = true;
	var idStyles = document.getElementById("idStyles" + this.oName);
	if (idStyles.innerHTML != "") {
		if (idStyles.style.display == "") idStyles.style.display = "none";
		else idStyles.style.display = "";
		return
	}
	idStyles.style.display = "";
	var h = document.getElementById("idContent" + this.oName).offsetHeight - 27;
	var arrStyle = this.arrStyle;
	var sHTML = "";
	sHTML += "<div unselectable=on style='margin:5px;margin-top:0;margin-right:0' align=right>";
	sHTML += "<table style='margin:1px;margin-top:2px;margin-bottom:3px;width:14px;height:14px;background:#E9E8F2;' cellpadding=0 cellspacing=0 unselectable=on>" + "<tr><td onclick=\"" + this.oName + ".openStyleSelect();\" onmouseover=\"this.style.border='#708090 1px solid';this.style.color='white';this.style.backgroundColor='9FA7BB'\" onmouseout=\"this.style.border='white 1px solid';this.style.color='black';this.style.backgroundColor=''\" style=\"cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;\" align=center valign=top unselectable=on>x</td></tr>" + "</table>";
	var sBody = "";
	for (var i = 0; i < arrStyle.length; i++) {
		sSelector = arrStyle[i][0];
		if (sSelector == "body") sBody = arrStyle[i][3]
	}
	sHTML += "<div unselectable=on style='overflow:auto;width:200px;height:" + h + "px;'>";
	sHTML += "<table name='tblStyles" + this.oName + "' id='tblStyles" + this.oName + "' cellpadding=0 cellspacing=0 style='background:#fcfcfc;" + sBody + ";height:100%;width:100%;margin:0;'>";
	for (var i = 0; i < arrStyle.length; i++) {
		sSelector = arrStyle[i][0];
		isOnSelection = arrStyle[i][1];
		sCssText = arrStyle[i][3];
		sCaption = arrStyle[i][2];
		if (isOnSelection) {
			if (sSelector.split(".").length > 1) {
				var tmpSelector = sSelector;
				if (sSelector.indexOf(":") > 0) tmpSelector = sSelector.substring(0, sSelector.indexOf(":"));
				sHTML += "<tr style=\"cursor:default\" onmouseover=\"if(this.style.marginRight!='1px'){this.style.background='" + this.styleSelectionHoverBg + "';this.style.color='" + this.styleSelectionHoverFg + "'}\" onmouseout=\"if(this.style.marginRight!='1px'){this.style.background='';this.style.color=''}\">";
				sHTML += "<td unselectable=on onclick=\"doApplyStyle('" + this.oName + "','" + tmpSelector.split(".")[1] + "')\" style='padding:2px'>";
				if (sSelector.split(".")[0] == "") sHTML += "<span unselectable=on style=\"" + sCssText + ";margin:0;\">" + sCaption + "</span>";
				else sHTML += "<span unselectable=on style=\"" + sCssText + ";margin:0;\">" + sSelector + "</span>";
				sHTML += "</td></tr>"
			}
		}
	}
	sHTML += "<tr><td height=100%>&nbsp;</td></tr></table></div>";
	sHTML += "</div>";
	document.getElementById("idStyles" + this.oName).innerHTML = sHTML
};
function cleanFonts() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var allFonts = oEditor.document.body.getElementsByTagName("FONT");
	if (allFonts.length == 0) return false;
	var f;
	var range;
	while (allFonts.length > 0) {
		f = allFonts[0];
		if (f.hasChildNodes && f.childNodes.length == 1 && f.childNodes[0].nodeType == 1 && f.childNodes[0].nodeName == "SPAN") {
			var theSpan = f.childNodes[0];
			copyAttribute(theSpan, f);
			range = oEditor.document.createRange();
			range.selectNode(f);
			range.insertNode(theSpan);
			range.selectNode(f);
			range.deleteContents()
		} else if (f.parentNode.nodeName == "SPAN" && f.parentNode.childNodes.length == 1) {
			var theSpan = f.parentNode;
			copyAttribute(theSpan, f);
			theSpan.innerHTML = f.innerHTML
		} else {
			var newSpan = oEditor.document.createElement("SPAN");
			copyAttribute(newSpan, f);
			newSpan.innerHTML = f.innerHTML;
			f.parentNode.replaceChild(newSpan, f)
		}
	}
	return true
};
function cleanTags(elements, sVal) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	if (elements.length == 0) return false;
	var f;
	var range;
	while (elements.length > 0) {
		f = elements[0];
		if (f.hasChildNodes && f.childNodes.length == 1 && f.childNodes[0].nodeType == 1 && f.childNodes[0].nodeName == "SPAN") {
			var theSpan = f.childNodes[0];
			if (sVal == "bold") theSpan.style.fontWeight = "bold";
			if (sVal == "italic") theSpan.style.fontStyle = "italic";
			if (sVal == "line-through") theSpan.style.textDecoration = "line-through";
			if (sVal == "underline") theSpan.style.textDecoration = "underline";
			range = oEditor.document.createRange();
			range.selectNode(f);
			range.insertNode(theSpan);
			range.selectNode(f);
			range.deleteContents()
		} else if (f.parentNode.nodeName == "SPAN" && f.parentNode.childNodes.length == 1) {
			var theSpan = f.parentNode;
			if (sVal == "bold") theSpan.style.fontWeight = "bold";
			if (sVal == "italic") theSpan.style.fontStyle = "italic";
			if (sVal == "line-through") theSpan.style.textDecoration = "line-through";
			if (sVal == "underline") theSpan.style.textDecoration = "underline";
			theSpan.innerHTML = f.innerHTML
		} else {
			var newSpan = oEditor.document.createElement("SPAN");
			if (sVal == "bold") newSpan.style.fontWeight = "bold";
			if (sVal == "italic") newSpan.style.fontStyle = "italic";
			if (sVal == "line-through") newSpan.style.textDecoration = "line-through";
			if (sVal == "underline") newSpan.style.textDecoration = "underline";
			newSpan.innerHTML = f.innerHTML;
			f.parentNode.replaceChild(newSpan, f)
		}
	}
	return true
};
function replaceTags(sFrom, sTo) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var elements = oEditor.document.body.getElementsByTagName(sFrom);
	while (elements.length > 0) {
		f = elements[0];
		var newSpan = oEditor.document.createElement(sTo);
		newSpan.innerHTML = f.innerHTML;
		f.parentNode.replaceChild(newSpan, f)
	}
};
function cleanDeprecated() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var elements;
	elements = oEditor.document.body.getElementsByTagName("STRONG");
	this.cleanTags(elements, "bold");
	elements = oEditor.document.body.getElementsByTagName("B");
	this.cleanTags(elements, "bold");
	elements = oEditor.document.body.getElementsByTagName("I");
	this.cleanTags(elements, "italic");
	elements = oEditor.document.body.getElementsByTagName("EM");
	this.cleanTags(elements, "italic");
	elements = oEditor.document.body.getElementsByTagName("STRIKE");
	this.cleanTags(elements, "line-through");
	elements = oEditor.document.body.getElementsByTagName("S");
	this.cleanTags(elements, "line-through");
	elements = oEditor.document.body.getElementsByTagName("U");
	this.cleanTags(elements, "underline");
	this.replaceTags("DIR", "DIV");
	this.replaceTags("MENU", "DIV");
	this.replaceTags("CENTER", "DIV");
	this.replaceTags("XMP", "PRE");
	this.replaceTags("BASEFONT", "SPAN");
	elements = oEditor.document.body.getElementsByTagName("APPLET");
	while (elements.length > 0) {
		var f = elements[0];
		theParent = f.parentNode;
		theParent.removeChild(f)
	}
	this.cleanFonts();
	this.cleanEmptySpan();
	return true
};
function applySpanStyle(arrStyles, sClassName, blockTag) {
	var useBlock = "SPAN";
	if (blockTag != null && blockTag != "") useBlock = blockTag;
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var range;
	var oElement;
	if (!isTextSelected(oSel)) {
		range = oSel.getRangeAt(0);
		oElement = getSelectedElement(oSel);
		if (oElement.nodeName == useBlock) return oElement;
		return
	}
	this.hide();
	this.doCmd("fontsize", "0");
	replaceWithSpan(oEditor, arrStyles, sClassName, useBlock);
	realTime(this)
};
function doClean() {
	this.saveForUndo();
	if (oUtil.activeElement) var element = oUtil.activeElement;
	else {
		var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
		var oSel = oEditor.getSelection();
		element = getSelectedElement(oSel);
		if (isTextSelected(oSel)) {
			if (oSel != "") {
				var range = oSel.getRangeAt(0);
				if (element.innerHTML != range.toString()) {
					this.doCmd('RemoveFormat');
					realTime(this);
					return
				}
			} else {
				if (element.tagName == "BODY") return
			}
		} else {
			if (element.tagName == "BODY") return
		}
	}
	element.removeAttribute("className");
	element.removeAttribute("style");
	if (element.tagName == "H1" || element.tagName == "H2" || element.tagName == "H3" || element.tagName == "H4" || element.tagName == "H5" || element.tagName == "H6" || element.tagName == "PRE" || element.tagName == "P" || element.tagName == "DIV") {
		this.doCmd('FormatBlock', '<P>')
	}
	this.doCmd('RemoveFormat');
	realTime(this)
};
function cleanEmptySpan() {
	var bReturn = false;
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var reg = /<\s*SPAN\s*>/gi;
	while (true) {
		var allSpans = oEditor.document.getElementsByTagName("SPAN");
		if (allSpans.length == 0) break;
		var emptySpans = [];
		for (var i = 0; i < allSpans.length; i++) {
			if (getOuterHTML(allSpans[i]).search(reg) == 0) emptySpans[emptySpans.length] = allSpans[i]
		}
		if (emptySpans.length == 0) break;
		var theSpan, theParent;
		for (var i = 0; i < emptySpans.length; i++) {
			theSpan = emptySpans[i];
			theParent = theSpan.parentNode;
			if (!theParent) continue;
			if (theSpan.hasChildNodes()) {
				var range = oEditor.document.createRange();
				range.selectNodeContents(theSpan);
				var docFrag = range.extractContents();
				theParent.replaceChild(docFrag, theSpan)
			} else {
				theParent.removeChild(theSpan)
			}
			bReturn = true
		}
	}
	return bReturn
};
function copyStyleClass(newSpan, arrStyles, sClassName) {
	if (arrStyles) {
		for (var i = 0; i < arrStyles.length; i++) {
			newSpan.style[arrStyles[i][0]] = arrStyles[i][1]
		}
		if (newSpan.style.cssText == "") newSpan.removeAttribute("style", 0)
	}
	if (sClassName) newSpan.className = sClassName
};
function copyAttribute(newSpan, f) {
	if ((f.face != null) && (f.face != "")) newSpan.style.fontFamily = f.face;
	if ((f.size != null) && (f.size != "")) {
		var nSize = "";
		if (f.size == 1) nSize = "8pt";
		else if (f.size == 2) nSize = "10pt";
		else if (f.size == 3) nSize = "12pt";
		else if (f.size == 4) nSize = "14pt";
		else if (f.size == 5) nSize = "18pt";
		else if (f.size == 6) nSize = "24pt";
		else if (f.size >= 7) nSize = "36pt";
		else if (f.size <= -2 || f.size == "0") nSize = "8pt";
		else if (f.size == "-1") nSize = "10pt";
		else if (f.size == 0) nSize = "12pt";
		else if (f.size == "+1") nSize = "14pt";
		else if (f.size == "+2") nSize = "18pt";
		else if (f.size == "+3") nSize = "24pt";
		else if (f.size == "+4" || f.size == "+5" || f.size == "+6") nSize = "36pt";
		else nSize = "";
		if (nSize != "") newSpan.style.fontSize = nSize
	}
	if ((f.style.backgroundColor != null) && (f.style.backgroundColor != "")) newSpan.style.backgroundColor = f.style.backgroundColor;
	if ((f.color != null) && (f.color != "")) newSpan.style.color = f.color;
	if ((f.className != null) && (f.className != "")) newSpan.className = f.className
};
function replaceWithSpan(oEditor, arrStyles, sClassName, blockTag) {
	var useBlock = "SPAN";
	if (blockTag != null && blockTag != "") useBlock = blockTag;
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	var startFont = GetElement(range.startContainer, "FONT");
	if (startFont == null) startFont = range.startContainer.nextSibling;
	startFont.setAttribute("startcont", "this");
	var endFont = GetElement(range.endContainer, "FONT");
	if (endFont == null) endFont = range.endContainer.prevSibling;
	if (endFont != null) endFont.setAttribute("endcont", "this");
	var startCont = range.startContainer;
	var endCont = range.endContainer;
	var allFonts = oEditor.document.getElementsByTagName("FONT");
	var newSpan = null;
	var f = null;
	while (allFonts.length > 0) {
		f = allFonts[0];
		if (f.childNodes && f.childNodes.length == 1 && f.childNodes[0].nodeType == 1 && f.childNodes[0].nodeName == useBlock) {
			newSpan = f.childNodes[0];
			var spans = newSpan.getElementsByTagName(useBlock);
			if (spans) {
				for (var j = 0; j < spans.length; j++) {
					if (arrStyles || sClassName) copyStyleClass(spans[j], arrStyles, sClassName);
					else copyAttribute(spans[j], f)
				}
			}
			if (arrStyles || sClassName) copyStyleClass(newSpan, arrStyles, sClassName);
			else copyAttribute(newSpan, f);
			range = oEditor.document.createRange();
			if (f.getAttribute("startcont") == "this") startCont = newSpan;
			if (f.getAttribute("endcont") == "this") endCont = newSpan;
			range.selectNode(f);
			range.insertNode(newSpan);
			range.selectNode(f);
			range.deleteContents()
		} else {
			var spans = f.getElementsByTagName(useBlock);
			if (spans) {
				for (var j = 0; j < spans.length; j++) {
					if (arrStyles || sClassName) copyStyleClass(spans[j], arrStyles, sClassName);
					else copyAttribute(spans[j], f)
				}
			}
			newSpan = oEditor.document.createElement(useBlock);
			newSpan.innerHTML = f.innerHTML;
			if (arrStyles || sClassName) copyStyleClass(newSpan, arrStyles, sClassName);
			else copyAttribute(newSpan, f);
			if (f.getAttribute("startcont") == "this") startCont = newSpan;
			if (f.getAttribute("endcont") == "this") endCont = newSpan;
			f.parentNode.replaceChild(newSpan, f)
		}
	}
	range = oEditor.document.createRange();
	range.setStart(startCont.childNodes[0], 0);
	var lastNode = endCont.childNodes[endCont.childNodes.length - 1];
	var endOffsetPos = 0;
	if (lastNode.nodeType == Node.TEXT_NODE) {
		endOffsetPos = lastNode.nodeValue.length
	} else {
		endOffsetPos = lastNode.childNodes.length
	}
	range.setEnd(lastNode, endOffsetPos);
	oSel = oEditor.getSelection();
	oSel.removeAllRanges();
	oSel.addRange(range)
};
function editorDoc_onkeyup(oEdt) {
	if (oEdt.tmKeyup) {
		clearTimeout(oEdt.tmKeyup);
		oEdt.tmKeyup = null
	}
	if (!oEdt.tmKeyup) oEdt.tmKeyup = setTimeout(function () {
		realTime(oEdt)
	},
	1000)
};
function editorDoc_onmouseup(e, oName) {
	var edtObj = eval(oName);
	var edtFrm = document.getElementById("idContent" + edtObj.oName);
	oUtil.activeElement = null;
	oUtil.oName = oName;
	oUtil.oEditor = edtFrm.contentWindow;
	oUtil.obj = edtObj;
	edtObj.hide();
	realTime(edtObj)
};
function setActiveEditor(edtObj) {
	oUtil.oName = edtObj.oName;
	oUtil.oEditor = document.getElementById("idContent" + edtObj.oName).contentWindow;
	oUtil.obj = edtObj
};
var arrTmp = [];
function GetElement(oElement, sMatchTag) {
	while (oElement != null && oElement.tagName != sMatchTag) {
		if (oElement.tagName == "BODY") return null;
		oElement = oElement.parentNode
	}
	return oElement
};
var arrTmp2 = [];
function realTime(edtObj) {
	try {
		var oName = edtObj.oName;
		var oEditor = document.getElementById("idContent" + oName).contentWindow;
		var oSel = oEditor.getSelection();
		var element = getSelectedElement(oSel);
		var obj = edtObj;
		var tbar = obj.tbar;
		var btn = null;
		if (obj.btnTable) {
			var btn = tbar.btns["btnTableEdit" + oName];
			var ddTbl = isDDs[btn.ddId];
			ddTbl.enableItem("mnuTableSize" + oName, true);
			ddTbl.enableItem("mnuTableEdit" + oName, true);
			ddTbl.enableItem("mnuCellEdit" + oName, true);
			var oTable = GetElement(element, "TABLE");
			if (oTable) {
				ddTbl.enableItem("mnuCellEdit" + oName, false);
				btn.setState(1)
			} else btn.setState(5);
			var oTD = GetElement(element, "TD");
			if (oTD) {
				ddTbl.enableItem("mnuCellEdit" + oName, true)
			}
		}
		var doc = oEditor.document;
		if (obj.btnParagraph) {
			btn = tbar.btns["btnParagraph" + oName];
			btn.setState(doc.queryCommandEnabled("FormatBlock") ? 1 : 5)
		}
		if (obj.btnFontName) {
			btn = tbar.btns["btnFontName" + oName];
			btn.setState(doc.queryCommandEnabled("FontName") ? 1 : 5)
		}
		if (obj.btnFontSize) {
			btn = tbar.btns["btnFontSize" + oName];
			btn.setState(doc.queryCommandEnabled("FontSize") ? 1 : 5)
		}
		if (obj.btnPaste) {
			btn = tbar.btns["btnPaste" + oName];
			btn.setState(doc.queryCommandEnabled("Paste") ? 1 : 5)
		}
		if (obj.btnUndo) {
			btn = tbar.btns["btnUndo" + oName];
			btn.setState(!obj.arrUndoList[0] ? 5 : 1)
		}
		if (obj.btnRedo) {
			btn = tbar.btns["btnRedo" + oName];
			btn.setState(!obj.arrRedoList[0] ? 5 : 1)
		}
		if (obj.btnBold) {
			btn = tbar.btns["btnBold" + oName];
			btn.setState(doc.queryCommandEnabled("Bold") ? (doc.queryCommandState("Bold") ? 4 : 1) : 5)
		}
		if (obj.btnItalic) {
			btn = tbar.btns["btnItalic" + oName];
			btn.setState(doc.queryCommandEnabled("Italic") ? (doc.queryCommandState("Italic") ? 4 : 1) : 5)
		}
		if (obj.btnUnderline) {
			btn = tbar.btns["btnUnderline" + oName];
			btn.setState(doc.queryCommandEnabled("Underline") ? (doc.queryCommandState("Underline") ? 4 : 1) : 5)
		}
		if (obj.btnStrikethrough) {
			btn = tbar.btns["btnStrikethrough" + oName];
			btn.setState(doc.queryCommandEnabled("Strikethrough") ? (doc.queryCommandState("Strikethrough") ? 4 : 1) : 5)
		}
		if (obj.btnSuperscript) {
			btn = tbar.btns["btnSuperscript" + oName];
			btn.setState(doc.queryCommandEnabled("Superscript") ? (doc.queryCommandState("Superscript") ? 4 : 1) : 5)
		}
		if (obj.btnSubscript) {
			btn = tbar.btns["btnSubscript" + oName];
			btn.setState(doc.queryCommandEnabled("Subscript") ? (doc.queryCommandState("Subscript") ? 4 : 1) : 5)
		}
		if (obj.btnNumbering) {
			btn = tbar.btns["btnNumbering" + oName];
			btn.setState(doc.queryCommandEnabled("InsertOrderedList") ? (doc.queryCommandState("InsertOrderedList") ? 4 : 1) : 5)
		}
		if (obj.btnBullets) {
			btn = tbar.btns["btnBullets" + oName];
			btn.setState(doc.queryCommandEnabled("InsertUnorderedList") ? (doc.queryCommandState("InsertUnorderedList") ? 4 : 1) : 5)
		}
		if (obj.btnJustifyLeft) {
			btn = tbar.btns["btnJustifyLeft" + oName];
			btn.setState(doc.queryCommandEnabled("JustifyLeft") ? (doc.queryCommandState("JustifyLeft") ? 4 : 1) : 5)
		}
		if (obj.btnJustifyCenter) {
			btn = tbar.btns["btnJustifyCenter" + oName];
			btn.setState(doc.queryCommandEnabled("JustifyCenter") ? (doc.queryCommandState("JustifyCenter") ? 4 : 1) : 5)
		}
		if (obj.btnJustifyRight) {
			btn = tbar.btns["btnJustifyRight" + oName];
			btn.setState(doc.queryCommandEnabled("JustifyRight") ? (doc.queryCommandState("JustifyRight") ? 4 : 1) : 5)
		}
		if (obj.btnJustifyFull) {
			btn = tbar.btns["btnJustifyFull" + oName];
			btn.setState(doc.queryCommandEnabled("JustifyFull") ? (doc.queryCommandState("JustifyFull") ? 4 : 1) : 5)
		}
		if (obj.btnIndent) {
			btn = tbar.btns["btnIndent" + oName];
			btn.setState(doc.queryCommandEnabled("Indent") ? 1 : 5)
		}
		if (obj.btnOutdent) {
			btn = tbar.btns["btnOutdent" + oName];
			btn.setState(doc.queryCommandEnabled("Outdent") ? 1 : 5)
		}
		if (obj.btnLTR) {
			btn = tbar.btns["btnLTR" + oName];
			btn.setState(element.dir ? (element.dir.toLowerCase() == "ltr" ? 4 : 1) : 1)
		}
		if (obj.btnRTL) {
			btn = tbar.btns["btnRTL" + oName];
			btn.setState(element.dir ? (element.dir.toLowerCase() == "rtl" ? 4 : 1) : 1)
		}
		var v = (element ? 1 : 5);
		if (obj.btnForeColor) tbar.btns["btnForeColor" + oName].setState(v);
		if (obj.btnBackColor) tbar.btns["btnBackColor" + oName].setState(v);
		if (obj.btnLine) tbar.btns["btnLine" + oName].setState(v);
		try {
			oUtil.onSelectionChanged()
		} catch(e) {}
		try {
			obj.onSelectionChanged()
		} catch(e) {}
		var idStyles = document.getElementById("idStyles" + oName);
		if (idStyles.innerHTML != "") {
			var oElement;
			if (oUtil.activeElement) oElement = oUtil.activeElement;
			else oElement = getSelectedElement(oSel);
			var sCurrClass = oElement.className;
			var oRows = document.getElementById("tblStyles" + oName).rows;
			for (var i = 0; i < oRows.length - 1; i++) {
				sClass = oRows[i].childNodes[0].childNodes[0].innerHTML;
				if (sClass.split(".").length > 1 && sClass != "") sClass = sClass.split(".")[1];
				if (sCurrClass == sClass) {
					oRows[i].style.marginRight = "1px";
					oRows[i].style.backgroundColor = obj.styleSelectionHoverBg;
					oRows[i].style.color = obj.styleSelectionHoverFg
				} else {
					oRows[i].style.marginRight = "";
					oRows[i].style.backgroundColor = "";
					oRows[i].style.color = ""
				}
			}
		}
		if (obj.useTagSelector) {
			oElement = element;
			var sHTML = "";
			var i = 0;
			arrTmp2 = [];
			while (oElement != null && oElement.tagName != "BODY" && oElement.nodeType == 1) {
				arrTmp2[i] = oElement;
				sHTML = "&nbsp; &lt;<span id=tag" + oName + i + " unselectable=on style='text-decoration:underline;cursor:pointer' onclick=\"" + oName + ".selectElement(" + i + ")\">" + oElement.tagName + "</span>&gt;" + sHTML;
				oElement = oElement.parentNode;
				i++
			}
			sHTML = "&nbsp;&lt;BODY&gt;" + sHTML;
			document.getElementById("idElNavigate" + oName).innerHTML = sHTML;
			document.getElementById("idElCommand" + oName).style.display = "none";
			for (i = 0; i < arrTmp2.length; i++) {
				document.getElementById("tag" + oName + i).addEventListener("click", new Function(oName + ".selectElement(" + i + ")"), true)
			}
		}
	} catch(e) {}
};
function realtimeFontSelect(oName) {
	var oEditor = document.getElementById("idContent" + oName).contentWindow;
	var sFontName = oEditor.document.queryCommandValue("FontName");
	var edt = eval(oName);
	var found = false;
	for (var i = 0; i < edt.arrFontName.length; i++) {
		if (sFontName == edt.arrFontName[i]) {
			found = true;
			break
		}
	}
	if (found) {
		isDDs["ddFontName" + oName].selectItem("btnFontName_" + i + oName, true)
	} else {
		isDDs["ddFontName" + oName].clearSelection()
	}
};
function realtimeSizeSelect(oName) {
	var oEditor = document.getElementById("idContent" + oName).contentWindow;
	var sFontSize = oEditor.document.queryCommandValue("FontSize");
	var edt = eval(oName);
	var found = false;
	for (var i = 0; i < edt.arrFontSize.length; i++) {
		if (sFontSize == edt.arrFontSize[i][1]) {
			found = true;
			break
		}
	}
	if (found) {
		isDDs["ddFontSize" + oName].selectItem("btnFontSize_" + i + oName, true)
	} else {
		isDDs["ddFontSize" + oName].clearSelection()
	}
};
function moveTagSelector() {
	var edtArea = document.getElementById("idArea" + this.oName);
	var nWidth = edtArea.offsetWidth - 90;
	var icPath = this.scriptPath.substring(0, this.scriptPath.indexOf("moz/")) + this.iconPath;
	var sTagSelTop = "<table unselectable=on ondblclick='" + this.oName + ".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border:#cfcfcf 1px solid;border-bottom:none'><tr style='background-color:#f4f4f4;font-family:arial;font-size:10px;color:black;'>" + "<td id=idElNavigate" + this.oName + " style='padding:1px;width:" + nWidth + "px' valign=top>&nbsp;</td>" + "<td align=right valign='center' nowrap>" + "<span id=idElCommand" + this.oName + " unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='" + this.oName + ".removeTag()'>" + getTxt("Remove Tag") + "</span>" + "</td></tr></table>";
	var sTagSelBottom = "<table unselectable=on ondblclick='" + this.oName + ".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border-left:#cfcfcf 1px solid;border-right:#cfcfcf 1px solid;'><tr style='background-color:#f4f4f4;font-family:arial;font-size:10px;color:black;'>" + "<td id=idElNavigate" + this.oName + " style='padding:1px;width:" + nWidth + "px' valign=top>&nbsp;</td>" + "<td align=right valign='center' nowrap>" + "<span id=idElCommand" + this.oName + " unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='" + this.oName + ".removeTag()'>" + getTxt("Remove Tag") + "</span>" + "</td></tr></table>";
	var selTop = document.getElementById("idTagSelTop" + this.oName);
	var selTopRow = document.getElementById("idTagSelTopRow" + this.oName);
	var selBottom = document.getElementById("idTagSelBottom" + this.oName);
	var selBottomRow = document.getElementById("idTagSelBottomRow" + this.oName);
	if (this.TagSelectorPosition == "top") {
		selTop.innerHTML = "";
		selBottom.innerHTML = sTagSelBottom;
		selTopRow.style.display = "none";
		selBottomRow.style.display = "";
		this.TagSelectorPosition = "bottom"
	} else {
		selTop.innerHTML = sTagSelTop;
		selBottom.innerHTML = "";
		selTopRow.style.display = "";
		selBottomRow.style.display = "none";
		this.TagSelectorPosition = "top"
	}
};
function selectElement(i) {
	if (!this.useTagSelector) return;
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var range = oEditor.document.createRange();
	range.selectNode(arrTmp2[i]);
	var oSel = oEditor.getSelection();
	oSel.removeAllRanges();
	oSel.addRange(range);
	oActiveElement = arrTmp2[i];
	if (oActiveElement.tagName != "TD" && oActiveElement.tagName != "TR" && oActiveElement.tagName != "TBODY" && oActiveElement.tagName != "LI") document.getElementById("idElCommand" + this.oName).style.display = "";
	for (var j = 0; j < arrTmp2.length; j++) document.getElementById("tag" + this.oName + j).style.background = "";
	document.getElementById("tag" + this.oName + i).style.background = "DarkGray";
	if (oActiveElement) oUtil.activeElement = oActiveElement;
	this.focus()
};
function removeTag() {
	this.saveForUndo();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var element = getSelectedElement(oSel);
	var nearElement = element.nextSibling == null ? (element.previousSibling == null ? element.parentNode: element.previousSibling) : element.nextSibling;
	switch (element.nodeName) {
	case "TABLE":
		;
	case "IMG":
		;
	case "INPUT":
		;
	case "FORM":
		;
	case "SELECT":
		element.parentNode.removeChild(element);
		break;
	default:
		oSel = oEditor.getSelection();
		var range = oSel.getRangeAt(0);
		var docFrag = range.createContextualFragment(element.innerHTML);
		range.deleteContents();
		range.insertNode(docFrag);
		try {
			oEditor.document.designMode = "on"
		} catch(e) {}
		break
	}
	oSel = oEditor.getSelection();
	oSel.removeAllRanges();
	var range = oEditor.document.createRange();
	range.setStart(nearElement, 0);
	range.setEnd(nearElement, 0);
	oSel.addRange(range);
	this.focus();
	realTime(this)
};
function doCmd(sCmd, sOption) {
	if (sCmd == "Bold" || sCmd == "Italic" || sCmd == "Underline" || sCmd == "Strikethrough" || sCmd == "Superscript" || sCmd == "Subscript" || sCmd == "Indent" || sCmd == "Outdent" || sCmd == "InsertHorizontalRule") this.saveForUndo();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	oEditor.document.execCommand(sCmd, false, sOption);
	realTime(this)
};
function applyColor(sType, sColor) {
	this.hide();
	this.focus();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	this.saveForUndo();
	if (sColor != null && sColor != "") {
		oEditor.document.execCommand(sType, false, sColor);
		var sel = oEditor.getSelection();
		var range = sel.getRangeAt(0);
		if (range.startContainer.nodeType == Node.TEXT_NODE) {
			var el = range.startContainer.nextSibling;
			if (el) {
				range = oEditor.document.createRange();
				range.selectNode(el);
				sel = oEditor.getSelection();
				sel.removeAllRanges();
				sel.addRange(range)
			}
		}
	} else {
		var el = getSelectedElement(oEditor.getSelection());
		if (sType == "ForeColor") {
			el.style.color = ""
		} else if (sType == "HiliteColor") {
			el.style.backgroundColor = ""
		}
	}
	realTime(this);
	if (sColor == "") return
};
function applyParagraph(val) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	this.hide();
	this.saveForUndo();
	this.doCmd("FormatBlock", val)
};
function applyFontName(val) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	this.hide();
	this.saveForUndo();
	this.doCmd("fontname", val)
};
function applyFontSize(val) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	this.hide();
	this.saveForUndo();
	this.doCmd("fontsize", val);
	replaceWithSpan(oEditor);
	realTime(this)
};
function applyBullets() {
	this.saveForUndo();
	this.doCmd("InsertUnOrderedList");
	this.tbar.btns["btnNumbering" + this.oName].setState(1);
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oElement = getSelectedElement(oSel);
	while (oElement != null && oElement.tagName != "OL" && oElement.tagName != "UL") {
		if (oElement.tagName == "BODY") return;
		oElement = oElement.parentNode
	}
	oElement.removeAttribute("type", 0);
	oElement.style.listStyleImage = ""
};
function applyNumbering() {
	this.saveForUndo();
	this.doCmd("InsertOrderedList");
	this.tbar.btns["btnBullets" + this.oName].setState(1);
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oElement = getSelectedElement(oSel);
	while (oElement != null && oElement.tagName != "OL" && oElement.tagName != "UL") {
		if (oElement.tagName == "BODY") return;
		oElement = oElement.parentNode
	}
	oElement.removeAttribute("type", 0);
	oElement.style.listStyleImage = ""
};
function applyJustifyLeft() {
	this.saveForUndo();
	this.doCmd("JustifyLeft")
};
function applyJustifyCenter() {
	this.saveForUndo();
	this.doCmd("JustifyCenter")
};
function applyJustifyRight() {
	this.saveForUndo();
	this.doCmd("JustifyRight")
};
function applyJustifyFull() {
	this.saveForUndo();
	this.doCmd("JustifyFull")
};
function applyBlockDirLTR() {
	this.saveForUndo();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oEl = getSelectedElement(oSel);
	if (oEl.dir) oEl.removeAttribute("dir");
	else oEl.dir = "ltr";
	this.focus()
};
function applyBlockDirRTL() {
	this.saveForUndo();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oEl = getSelectedElement(oSel);
	if (oEl.dir) oEl.removeAttribute("dir");
	else oEl.dir = "rtl";
	this.focus()
};
function insertCustomTag(index) {
	this.insertHTML(this.arrCustomTag[index][1]);
	this.hide();
	this.focus()
};
function expandSelection() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	if (range.startContainer.nodeType == Node.TEXT_NODE) {
		if (range.toString() == "") {
			var sPos = range.startOffset;
			var ePos = range.endOffset;
			var startCont = range.startContainer;
			var str = startCont.nodeValue;
			sPos = str.substring(0, range.startOffset).search(/(\W+\w*)$/i);
			sPos = sPos == -1 ? 0 : sPos;
			var tPos = str.substring(sPos, range.startOffset).search(/\w+/i);
			sPos += (tPos == -1 ? str.substring(sPos, range.startOffset).length: tPos);
			ePos = str.substr(range.endOffset).search(/\W+/i);
			ePos = ePos == -1 ? str.length: ePos + range.endOffset;
			range = oEditor.document.createRange();
			range.setStart(startCont, sPos);
			range.setEnd(startCont, ePos);
			oSel = oEditor.getSelection();
			oSel.removeAllRanges();
			oSel.addRange(range)
		}
	}
	return
};
function selectParagraph() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var selParent = getSelectedElement(oSel);
	if (selParent) {
		if (oSel.getRangeAt(0).toString() == "") {
			var oElement = selParent;
			while (oElement != null && oElement.tagName != "H1" && oElement.tagName != "H2" && oElement.tagName != "H3" && oElement.tagName != "H4" && oElement.tagName != "H5" && oElement.tagName != "H6" && oElement.tagName != "PRE" && oElement.tagName != "P" && oElement.tagName != "DIV") {
				if (oElement.tagName == "BODY") return;
				oElement = oElement.parentNode
			}
			var range = oEditor.document.createRange();
			range.selectNode(oElement);
			oSel = oEditor.getSelection();
			oSel.removeAllRanges();
			oSel.addRange(range)
		}
	}
};
function insertHTML(sHTML) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	this.saveForUndo();
	var docFrag = range.createContextualFragment(sHTML);
	range.collapse(false);
	var lastNode = docFrag.childNodes[docFrag.childNodes.length - 1];
	range.insertNode(docFrag);
	try {
		oEditor.document.designMode = "on"
	} catch(e) {}
	if (lastNode.nodeType == Node.TEXT_NODE) {
		range = oEditor.document.createRange();
		range.setStart(lastNode, lastNode.nodeValue.length);
		range.setEnd(lastNode, lastNode.nodeValue.length);
		oSel = oEditor.getSelection();
		oSel.removeAllRanges();
		oSel.addRange(range);
		var comCon = range.commonAncestorContainer;
		if (comCon && comCon.parentNode) {
			try {
				comCon.parentNode.normalize()
			} catch(e) {}
		}
	}
};
function insertLink(url, title, target, rel) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	this.saveForUndo();
	var emptySel = false;
	if (range.toString() == "") {
		if (range.startContainer.nodeType == Node.ELEMENT_NODE) {
			if (range.startContainer.childNodes[range.startOffset].nodeType != Node.TEXT_NODE) {
				if (range.startContainer.childNodes[range.startOffset].nodeName == "BR") emptySel = true;
				else emptySel = false
			} else {
				emptySel = true
			}
		} else {
			emptySel = true
		}
		if (emptySel) {
			var cap = (title != "" && title != null ? title: url);
			var node = oEditor.document.createTextNode(cap);
			range.insertNode(node);
			try {
				oEditor.document.designMode = "on"
			} catch(e) {}
			range = oEditor.document.createRange();
			range.setStart(node, 0);
			range.setEnd(node, cap.length);
			oSel = oEditor.getSelection();
			oSel.removeAllRanges();
			oSel.addRange(range)
		}
	}
	var isSelInMidText = (range.startContainer.nodeType == Node.TEXT_NODE) && (range.startOffset > 0);
	oEditor.document.execCommand("CreateLink", false, url);
	oSel = oEditor.getSelection();
	range = oSel.getRangeAt(0);
	if (range.startContainer.nodeType == Node.TEXT_NODE) {
		var node = (emptySel || !isSelInMidText ? range.startContainer.parentNode: range.startContainer.nextSibling);
		range = oEditor.document.createRange();
		range.selectNode(node);
		oSel = oEditor.getSelection();
		oSel.removeAllRanges();
		oSel.addRange(range)
	}
	var oEl = range.startContainer.childNodes[range.startOffset];
	if (oEl) {
		if (target != "" && target != undefined) oEl.target = target;
		if (rel != "" && rel != undefined) oEl.setAttribute("rel", rel)
	}
};
function clearAll() {
	if (confirm(getTxt("Are you sure you wish to delete all contents?")) == true) {
		this.saveForUndo();
		var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
		oEditor.document.body.innerHTML = "<BR>";
		oEditor.focus()
	}
};
function applySpan(blockTag) {
	var useBlock = "SPAN";
	if (blockTag != null && blockTag != "") useBlock = blockTag;
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var range;
	var oElement;
	var sHTML;
	if (!isTextSelected(oSel)) {
		range = oSel.getRangeAt(0);
		oElement = getSelectedElement(oSel);
		if (oElement.nodeName == useBlock) return oElement;
		return
	}
	range = oSel.getRangeAt(0);
	sHTML = range.toString();
	var docFrag = range.extractContents();
	var idSpan = oEditor.document.createElement(useBlock);
	idSpan.appendChild(docFrag);
	range.insertNode(idSpan);
	try {
		oEditor.document.designMode = "on"
	} catch(e) {}
	range = oEditor.document.createRange();
	range.selectNode(idSpan);
	oSel = oEditor.getSelection();
	oSel.removeAllRanges();
	oSel.addRange(range);
	return idSpan
};
function makeAbsolute() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oEl = getSelectedElement(oSel);
	this.saveForUndo();
	if (oEl != null && oEl.nodeName != "BODY") {
		if (oEl.style.position == "absolute") oEl.style.position = "";
		else oEl.style.position = "absolute"
	}
};
function doOver_TabCreate(el) {
	var oTD = el;
	var oTable = oTD.parentNode.parentNode.parentNode;
	var nRow = oTD.parentNode.rowIndex;
	var nCol = oTD.cellIndex;
	var rows = oTable.rows;
	var custCell = rows[rows.length - 1].childNodes[0];
	custCell.innerHTML = "<div align=right>" + (nRow * 1 + 1) + " x " + (nCol * 1 + 1) + " " + getTxt("Table Dimension Text") + " ...  &nbsp;&nbsp;&nbsp;<span style='text-decoration:underline'>" + getTxt("Table Advance Link") + "</span>&nbsp;</div>";
	custCell.style.backgroundColor = "";
	custCell.style.color = "#000000";
	custCell.style.border = "0px";
	for (var i = 0; i < rows.length - 1; i++) {
		var oRow = rows[i];
		for (var j = 0; j < oRow.childNodes.length; j++) {
			var oCol = oRow.childNodes[j];
			if (i <= nRow && j <= nCol) oCol.style.backgroundColor = "#316ac5";
			else oCol.style.backgroundColor = "#ffffff"
		}
	}
};
function doOut_TabCreate(el) {
	var oTable = el;
	if (oTable.nodeName != "TABLE") return;
	var rows = oTable.rows;
	rows[rows.length - 1].childNodes[0].innerHTML = getTxt("Advanced Table Insert");
	for (var i = 0; i < rows.length - 1; i++) {
		var oRow = rows[i];
		for (var j = 0; j < oRow.childNodes.length; j++) {
			var oCol = oRow.childNodes[j];
			oCol.style.backgroundColor = "#ffffff"
		}
	}
};
function doRefresh_TabCreate() {
	var oTable = document.getElementById("dropTableCreate" + this.oName);
	var rows = oTable.rows;
	rows[rows.length - 1].childNodes[0].innerHTML = getTxt("Advanced Table Insert");
	for (var i = 0; i < rows.length - 1; i++) {
		var oRow = rows[i];
		for (var j = 0; j < oRow.childNodes.length; j++) {
			var oCol = oRow.childNodes[j];
			oCol.style.backgroundColor = "#ffffff"
		}
	}
};
function doClick_TabCreate(el) {
	this.hide();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oTD = el;
	var nRow = oTD.parentNode.rowIndex + 1;
	var nCol = oTD.cellIndex + 1;
	this.saveForUndo();
	var sHTML = "<table style='border-collapse:collapse;width:100%;' selThis='selThis'>";
	for (var i = 1; i <= nRow; i++) {
		sHTML += "<tr>";
		for (var j = 1; j <= nCol; j++) {
			sHTML += "<td><br/></td>"
		}
		sHTML += "</tr>"
	}
	sHTML += "</table>";
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	range.collapse(true);
	var docFrag = range.createContextualFragment(sHTML);
	range.insertNode(docFrag);
	try {
		oEditor.document.designMode = "on"
	} catch(e) {}
	var allTabs = oEditor.document.getElementsByTagName("TABLE");
	for (var i = 0; i < allTabs.length; i++) {
		if (allTabs[i].getAttribute("selThis") == "selThis") {
			range = oEditor.document.createRange();
			range.selectNode(allTabs[i]);
			oSel = oEditor.getSelection();
			oSel.removeAllRanges();
			oSel.addRange(range);
			allTabs[i].removeAttribute("selThis");
			break
		}
	}
	realTime(this)
};
function doKeyPress(evt, obj) {
	if (!obj.arrUndoList[0]) {
		obj.saveForUndo()
	}
	if (evt.ctrlKey) {
		switch (evt.keyCode) {
		case 86:
			if (obj.pasteTextOnCtrlV) {
				evt.preventDefault();
				modelessDialogShow(obj.scriptPath + "paste_text.htm", 400, 280)
			} else {
				var pasteFrame = document.getElementById("idContentWord" + obj.oName);
				var oDoc = pasteFrame.contentWindow.document;
				var oHTML = oDoc.open("text/html", "replace");
				oHTML.close();
				oDoc.designMode = "on";
				pasteFrame.contentWindow.focus();
				window.setTimeout(function () {
					obj.fixWord()
				},
				1)
			}
			break;
		case 66:
			obj.doCmd("Bold");
			evt.preventDefault();
			break;
		case 73:
			obj.doCmd("Italic");
			evt.preventDefault();
			break;
		case 85:
			obj.doCmd("Underline");
			evt.preventDefault();
			break
		}
	}
	if (evt.keyCode == 37 || evt.keyCode == 38 || evt.keyCode == 39 || evt.keyCode == 40) {
		obj.saveForUndo()
	}
	if (evt.keyCode == 13) {
		obj.saveForUndo()
	}
	obj.onKeyPress()
};
function doFullScreen() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var edtArea = document.getElementById("idArea" + this.oName);
	this.hide();
	if (this.stateFullScreen) {
		this.onNormalScreen();
		this.stateFullScreen = false;
		document.body.style.overflow = "";
		document.getElementById("id_refresh_z_index").style.margin = "0px";
		edtArea.style.position = "";
		edtArea.style.top = "0px";
		edtArea.style.left = "0px";
		if (this.width.toString().indexOf("%") != -1) edtArea.style.width = this.width;
		else edtArea.style.width = parseInt(this.width) + "px";
		if (this.height.toString().indexOf("%") != -1) edtArea.style.height = this.height;
		else edtArea.style.height = parseInt(this.height) + "px";
		for (var i = 0; i < oUtil.arrEditor.length; i++) {
			if (oUtil.arrEditor[i] != this.oName) {
				document.getElementById("idArea" + oUtil.arrEditor[i]).style.display = "";
				try {
					document.getElementById("idContent" + oUtil.arrEditor[i]).contentWindow.document.designMode = "on"
				} catch(e) {}
			}
		}
	} else {
		this.onFullScreen();
		this.stateFullScreen = true;
		window.scroll(0, 0);
		document.body.style.overflow = "hidden";
		document.getElementById("id_refresh_z_index").style.margin = "70px";
		edtArea.style.position = "absolute";
		edtArea.style.top = "0px";
		edtArea.style.left = "0px";
		edtArea.style.width = window.innerWidth + "px";
		edtArea.style.height = window.innerHeight + "px";
		edtArea.style.zIndex = 2000;
		for (var i = 0; i < oUtil.arrEditor.length; i++) {
			if (oUtil.arrEditor[i] != this.oName) document.getElementById("idArea" + oUtil.arrEditor[i]).style.display = "none"
		}
		oEditor.focus()
	}
	try {
		oEditor.document.designMode = "on"
	} catch(e) {}
	var idStyles = document.getElementById("idStyles" + this.oName);
	idStyles.innerHTML = "";
	document.documentElement.focus();
	oEditor.focus();
	var range = oEditor.document.createRange();
	if (oEditor.document.body.childNodes.length > 0) {
		var last = oEditor.document.body.childNodes[oEditor.document.body.childNodes.length - 1];
		if (last.nodeType == 1 && last.tagName == "BR") {
			range.selectNode(last);
			range.collapse(true)
		} else {
			range.selectNode(last);
			range.collapse(false)
		}
	} else {
		range.selectNodeContents(oEditor.document.body);
		range.collapse(false)
	}
	var sel = oEditor.getSelection();
	sel.removeAllRanges();
	sel.addRange(range)
};
function modelessDialogShow(url, width, height, p, opt) {
	windowOpen(url, width, height, false, p, opt)
};
function modalDialogShow(url, width, height, p, opt) {
	windowOpen(url, width, height, true, p, opt)
};
function windowOpen(url, wd, hg, ov, p, opt) {
	var id = "ID" + (new Date()).getTime();
	var f = new ISWindow(id);
	f.iconPath = oUtil.scriptPath.substring(0, oUtil.scriptPath.indexOf("moz/")) + "icons/";
	f.show({
		width: wd + "px",
		height: hg + "px",
		overlay: ov,
		center: true,
		url: url,
		openerWin: p,
		options: opt
	})
};
function hide() {
	hideAllDD();
	this.oColor1.hide();
	this.oColor2.hide();
	if (this.btnTable) this.doRefresh_TabCreate()
};
function lineBreak1(tag) {
	arrReturn = ["\n", "", ""];
	if (tag == "A" || tag == "B" || tag == "CITE" || tag == "CODE" || tag == "EM" || tag == "FONT" || tag == "I" || tag == "SMALL" || tag == "STRIKE" || tag == "BIG" || tag == "STRONG" || tag == "SUB" || tag == "SUP" || tag == "U" || tag == "SAMP" || tag == "S" || tag == "VAR" || tag == "BASEFONT" || tag == "KBD" || tag == "TT" || tag == "SPAN" || tag == "IMG") arrReturn = ["", "", ""];
	if (tag == "TEXTAREA" || tag == "TABLE" || tag == "THEAD" || tag == "TBODY" || tag == "TR" || tag == "OL" || tag == "UL" || tag == "DIR" || tag == "MENU" || tag == "FORM" || tag == "SELECT" || tag == "MAP" || tag == "DL" || tag == "HEAD" || tag == "BODY" || tag == "HTML") arrReturn = ["\n", "", "\n"];
	if (tag == "STYLE" || tag == "SCRIPT") arrReturn = ["\n", "", ""];
	if (tag == "BR" || tag == "HR") arrReturn = ["", "\n", ""];
	return arrReturn
};
function fixAttr(s) {
	s = String(s).replace(/&/g, "&amp;");
	s = String(s).replace(/</g, "&lt;");
	s = String(s).replace(/"/g, "&quot;");
	return s
};
function fixVal(s) {
	s = String(s).replace(/&/g, "&amp;");
	s = String(s).replace(/</g, "&lt;");
	var x = escape(s);
	x = unescape(x.replace(/\ /gi, "-*REPL*-"));
	s = x.replace(/-\*REPL\*-/gi, "&nbsp;");
	return s
};
function recur(oEl, sTab) {
	var sHTML = "";
	for (var i = 0; i < oEl.childNodes.length; i++) {
		var oNode = oEl.childNodes[i];
		if (oNode.nodeType == 1) {
			var sTagName = oNode.nodeName;
			var bDoNotProcess = false;
			if (sTagName.substring(0, 1) == "/") {
				bDoNotProcess = true
			} else {
				var sT = sTab;
				sHTML += lineBreak1(sTagName)[0];
				if (lineBreak1(sTagName)[0] != "") sHTML += sT
			}
			if (bDoNotProcess) {} else if (sTagName == "OBJECT" || sTagName == "EMBED") {
				s = getOuterHTML(oNode);
				s = s.replace(/\"[^\"]*\"/ig, function (x) {
					x = x.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/'/g, "&apos;").replace(/\s+/ig, "#_#").replace(/&amp;amp;/gi, "&amp;");
					return x
				});
				s = s.replace(/<([^ >]*)/ig, function (x) {
					return x.toLowerCase()
				});
				s = s.replace(/ ([^=]+)=([^"' >]+)/ig, " $1=\"$2\"");
				s = s.replace(/ ([^=]+)=/ig, function (x) {
					return x.toLowerCase()
				});
				s = s.replace(/#_#/ig, " ");
				s = s.replace(/<param([^>]*)>/ig, "\n<param$1 />").replace(/\/ \/>$/ig, " \/>");
				if (sTagName == "EMBED") if (oNode.innerHTML == "") s = s.replace(/>$/ig, " \/>").replace(/\/ \/>$/ig, "\/>");
				s = s.replace(/<param name=\"Play\" value=\"0\" \/>/, "<param name=\"Play\" value=\"-1\" \/>");
				sHTML += s
			} else if (sTagName == "TITLE") {
				sHTML += "<title>" + oNode.innerHTML + "</title>"
			} else {
				if (sTagName == "AREA") {
					var sCoords = oNode.coords;
					var sShape = oNode.shape
				}
				var oNode2 = oNode.cloneNode(false);
				s = getOuterHTML(oNode2).replace(/<\/[^>]*>/, "");
				if (sTagName == "STYLE") {
					var arrTmp = s.match(/<[^>]*>/ig);
					s = arrTmp[0]
				}
				s = s.replace(/\"[^\"]*\"/ig, function (x) {
					x = x.replace(/&/g, "&amp;").replace(/&amp;amp;/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\s+/ig, "#_#");
					return x
				});
				s = s.replace(/<([^ >]*)/ig, function (x) {
					return x.toLowerCase()
				});
				s = s.replace(/ ([^=]+)=([^" >]+)/ig, " $1=\"$2\"");
				s = s.replace(/ ([^=]+)=/ig, function (x) {
					return x.toLowerCase()
				});
				s = s.replace(/#_#/ig, " ");
				s = s.replace(/(<hr[^>]*)(noshade="")/ig, "$1noshade=\"noshade\"");
				s = s.replace(/(<input[^>]*)(checked="")/ig, "$1checked=\"checked\"");
				s = s.replace(/(<select[^>]*)(multiple="")/ig, "$1multiple=\"multiple\"");
				s = s.replace(/(<option[^>]*)(selected="")/ig, "$1selected=\"true\"");
				s = s.replace(/(<input[^>]*)(readonly="")/ig, "$1readonly=\"readonly\"");
				s = s.replace(/(<input[^>]*)(disabled="")/ig, "$1disabled=\"disabled\"");
				s = s.replace(/(<td[^>]*)(nowrap="" )/ig, "$1nowrap=\"nowrap\" ");
				s = s.replace(/(<td[^>]*)(nowrap=""\>)/ig, "$1nowrap=\"nowrap\"\>");
				s = s.replace(/ contenteditable=\"true\"/ig, "");
				if (sTagName == "AREA") {
					s = s.replace(/ coords=\"0,0,0,0\"/ig, " coords=\"" + sCoords + "\"");
					s = s.replace(/ shape=\"RECT\"/ig, " shape=\"" + sShape + "\"")
				}
				var bClosingTag = true;
				if (sTagName == "IMG" || sTagName == "BR" || sTagName == "AREA" || sTagName == "HR" || sTagName == "INPUT" || sTagName == "BASE" || sTagName == "LINK") {
					s = s.replace(/>$/ig, " \/>").replace(/\/ \/>$/ig, "\/>");
					bClosingTag = false
				}
				sHTML += s;
				if (sTagName != "TEXTAREA") sHTML += lineBreak1(sTagName)[1];
				if (sTagName != "TEXTAREA") if (lineBreak1(sTagName)[1] != "") sHTML += sT;
				if (bClosingTag) {
					s = getOuterHTML(oNode);
					if (sTagName == "SCRIPT") {
						s = s.replace(/<script([^>]*)>[\n+\s+\t+]*/ig, "<script$1>");
						s = s.replace(/[\n+\s+\t+]*<\/script>/ig, "<\/script>");
						s = s.replace(/<script([^>]*)>\/\/<!\[CDATA\[/ig, "");
						s = s.replace(/\/\/\]\]><\/script>/ig, "");
						s = s.replace(/<script([^>]*)>/ig, "");
						s = s.replace(/<\/script>/ig, "");
						s = s.replace(/^\s+/, '').replace(/\s+$/, '');
						sHTML += "\n" + sT + s + "\n" + sT
					}
					if (sTagName == "STYLE") {
						s = s.replace(/<style([^>]*)>[\n+\s+\t+]*/ig, "<style$1>");
						s = s.replace(/[\n+\s+\t+]*<\/style>/ig, "<\/style>");
						s = s.replace(/<style([^>]*)><!--/ig, "");
						s = s.replace(/--><\/style>/ig, "");
						s = s.replace(/<style([^>]*)>/ig, "");
						s = s.replace(/<\/style>/ig, "");
						s = s.replace(/^\s+/, "").replace(/\s+$/, "");
						sHTML += "\n" + sT + "<!--\n" + sT + s + "\n" + sT + "-->\n" + sT
					}
					if (sTagName == "DIV" || sTagName == "P") {
						if (oNode.innerHTML == "" || oNode.innerHTML == "&nbsp;") {
							sHTML += "&nbsp;"
						} else sHTML += recur(oNode, sT + "\t")
					} else if (sTagName == "STYLE" || sTagName == "SCRIPT") {} else {
						sHTML += recur(oNode, sT + "\t")
					}
					if (sTagName != "TEXTAREA") sHTML += lineBreak1(sTagName)[2];
					if (sTagName != "TEXTAREA") if (lineBreak1(sTagName)[2] != "") sHTML += sT;
					sHTML += "</" + sTagName.toLowerCase() + ">"
				}
			}
		} else if (oNode.nodeType == 3) {
			sHTML += fixVal(oNode.nodeValue).replace(/^[\t\r\n\v\f]*/, "").replace(/[\t\r\n\v\f]*$/, "")
		} else if (oNode.nodeType == 8) {
			if (getOuterHTML(oNode).substring(0, 2) == "<" + "%") {
				sTmp = (getOuterHTML(oNode).substring(2));
				sTmp = sTmp.substring(0, sTmp.length - 2);
				sTmp = sTmp.replace(/^\s+/, "").replace(/\s+$/, "");
				var sT = sTab;
				sHTML += "\n" + sT + "<%\n" + sT + sTmp + "\n" + sT + "%>\n" + sT
			} else {
				var sT = sTab;
				sTmp = oNode.nodeValue;
				sTmp = sTmp.replace(/^\s+/, "").replace(/\s+$/, "");
				sHTML += "\n" + sT + "<!--\n" + sT + sTmp + "\n" + sT + "-->\n" + sT
			}
		} else {}
	}
	return sHTML
};
function getSelectedElement(sel) {
	var range = sel.getRangeAt(0);
	var node = range.startContainer;
	if (node.nodeType == Node.ELEMENT_NODE) {
		if (range.startOffset >= node.childNodes.length) return node;
		node = node.childNodes[range.startOffset]
	}
	if (node.nodeType == Node.TEXT_NODE) {
		if (node.nodeValue.length == range.startOffset) {
			var el = node.nextSibling;
			if (el && el.nodeType == Node.ELEMENT_NODE) {
				if (range.endContainer.nodeType == Node.TEXT_NODE && range.endContainer.nodeValue.length == range.endOffset) {
					if (el == range.endContainer.parentNode) {
						return el
					}
				}
			}
		}
		while (node != null && node.nodeType != Node.ELEMENT_NODE) {
			node = node.parentNode
		}
	}
	return node
};
function isTextSelected(sel) {
	var range = sel.getRangeAt(0);
	if (range != null && range.startContainer != null) {
		return (range.startContainer.nodeType == Node.TEXT_NODE)
	}
	return false
};
function getOuterHTML(node) {
	var sHTML = "";
	switch (node.nodeType) {
	case Node.ELEMENT_NODE:
		sHTML = "<" + node.nodeName;
		var tagVal = "";
		for (var atr = 0; atr < node.attributes.length; atr++) {
			if (node.attributes[atr].nodeName.substr(0, 4) == "_moz") continue;
			if (node.attributes[atr].nodeValue.substr(0, 4) == "_moz") continue;
			if (node.nodeName == 'TEXTAREA' && node.attributes[atr].nodeName.toLowerCase() == 'value') {
				tagVal = node.attributes[atr].nodeValue
			} else {
				sHTML += ' ' + node.attributes[atr].nodeName + '="' + node.attributes[atr].nodeValue.replace(/"/gi, "'") + '"'
			}
		}
		sHTML += '>';
		sHTML += (node.nodeName != 'TEXTAREA' ? node.innerHTML: tagVal);
		sHTML += "</" + node.nodeName + ">";
		break;
	case Node.COMMENT_NODE:
		sHTML = "<!" + "--" + node.nodeValue + "--" + ">";
		break;
	case Node.TEXT_NODE:
		sHTML = node.nodeValue;
		break
	}
	return sHTML
};
function tbAction(tb, id, edt, sfx) {
	var e = edt,
	oN = sfx,
	btn = id.substring(0, id.lastIndexOf(oN));
	switch (btn) {
	case "btnSave":
		e.onSave();
		break;
	case "btnFullScreen":
		e.fullScreen();
		break;
	case "btnPrint":
		e.focus();
		document.getElementById("idContent" + edt.oName).contentWindow.print();
		break;
	case "btnSearch":
		e.hide();
		modelessDialogShow(e.scriptPath + "search.htm", 375, 163);
		break;
	case "btnSpellCheck":
		e.hide();
		if (e.spellCheckMode == "ieSpell");
		else if (e.spellCheckMode == "NetSpell") checkSpellingById("idContent" + edt.oName);
		break;
	case "btnCut":
		e.doCmd("Cut");
		break;
	case "btnCopy":
		e.doCmd("Copy");
		break;
	case "btnUndo":
		e.doUndo();
		break;
	case "btnRedo":
		e.doRedo();
		break;
	case "btnBold":
		e.doCmd("Bold");
		break;
	case "btnItalic":
		e.doCmd("Italic");
		break;
	case "btnUnderline":
		e.doCmd("Underline");
		break;
	case "btnStrikethrough":
		e.doCmd("Strikethrough");
		break;
	case "btnSuperscript":
		e.doCmd("Superscript");
		break;
	case "btnSubscript":
		e.doCmd("Subscript");
		break;
	case "btnJustifyLeft":
		e.applyJustifyLeft();
		break;
	case "btnJustifyCenter":
		e.applyJustifyCenter();
		break;
	case "btnJustifyRight":
		e.applyJustifyRight();
		break;
	case "btnJustifyFull":
		e.applyJustifyFull();
		break;
	case "btnNumbering":
		e.applyNumbering();
		break;
	case "btnBullets":
		e.applyBullets();
		break;
	case "btnIndent":
		e.doCmd("Indent");
		break;
	case "btnOutdent":
		e.doCmd("Outdent");
		break;
	case "btnLTR":
		e.applyBlockDirLTR();
		break;
	case "btnRTL":
		e.applyBlockDirRTL();
		break;
	case "btnForeColor":
		e.oColor1.show(document.getElementById(id));
		break;
	case "btnBackColor":
		e.oColor2.show(document.getElementById(id));
		break;
	case "btnBookmark":
		e.hide();
		modelessDialogShow(e.scriptPath + "bookmark.htm", 245, 216);
		break;
	case "btnHyperlink":
		e.hide();
		modelessDialogShow(e.scriptPath + "hyperlink.htm", 380, 220);
		break;
	case "btnImage":
		e.hide();
		modelessDialogShow(e.scriptPath + "image.htm", 440, 351);
		break;
	case "btnFlash":
		e.hide();
		modelessDialogShow(e.scriptPath + "flash.htm", 340, 275);
		break;
	case "btnYoutubeVideo":
		e.hide();
		modelessDialogShow(e.scriptPath + "youtube_video.htm", 340, 125);
		break;
	case "btnMedia":
		e.hide();
		modelessDialogShow(e.scriptPath + "media.htm", 340, 272);
		break;
	case "btnContentBlock":
		e.hide();
		eval(e.cmdContentBlock);
		break;
	case "btnInternalLink":
		e.hide();
		eval(e.cmdInternalLink);
		break;
	case "btnInternalImage":
		e.hide();
		eval(e.cmdInternalImage);
		break;
	case "btnCustomObject":
		e.hide();
		eval(e.cmdCustomObject);
		break;
	case "btnGuidelines":
		e.runtimeBorder(true);
		break;
	case "btnAutoTable":
		e.hide();
		modelessDialogShow(e.scriptPath + "table_format.htm", 320, 225);
		break;
	case "btnAbsolute":
		e.makeAbsolute();
		break;
	case "btnCharacters":
		e.hide();
		modelessDialogShow(e.scriptPath + "characters.htm", 495, 160);
		break;
	case "btnLine":
		e.doCmd("InsertHorizontalRule");
		break;
	case "btnRemoveFormat":
		e.doClean();
		break;
	case "btnHTMLFullSource":
		setActiveEditor(edt);
		e.hide();
		modalDialogShow(e.scriptPath + "source_html_full.htm", 600, 450);
		break;
	case "btnHTMLSource":
		setActiveEditor(edt);
		e.hide();
		modalDialogShow(e.scriptPath + "source_html.htm", 600, 450);
		break;
	case "btnXHTMLFullSource":
		setActiveEditor(edt);
		e.hide();
		modalDialogShow(e.scriptPath + "source_xhtml_full.htm", 600, 450);
		break;
	case "btnXHTMLSource":
		setActiveEditor(edt);
		e.hide();
		modalDialogShow(e.scriptPath + "source_xhtml.htm", 600, 450);
		break;
	case "btnClearAll":
		e.clearAll();
		break;
	case "btnStyles":
		e.hide();
		e.openStyleSelect();
		break;
	case "btnParagraph":
		e.hide();
		e.selectParagraph();
		break;
	case "btnFontName":
		e.hide();
		e.expandSelection();
		realtimeFontSelect(e.oName);
		break;
	case "btnFontSize":
		e.hide();
		e.expandSelection();
		realtimeSizeSelect(e.oName);
		break;
	case "btnCustomTag":
		e.hide();
		break;
	default:
		for (var i = 0; i < e.arrCustomButtons.length; i++) {
			if (e.arrCustomButtons[i][0] == btn) {
				eval(e.arrCustomButtons[i][1]);
				break
			}
		}
	}
};
function ddAction(tb, id, edt, sfx) {
	var oN = sfx;
	var e = edt;
	var btn = id.substring(0, id.lastIndexOf(oN));
	switch (btn) {
	case "btnPreview1":
		setActiveEditor(edt);
		modalDialogShow(e.scriptPath + "preview.htm", 640, 480);
		break;
	case "btnPreview2":
		setActiveEditor(edt);
		modalDialogShow(e.scriptPath + "preview.htm", 800, 600);
		break;
	case "btnPreview3":
		setActiveEditor(edt);
		modalDialogShow(e.scriptPath + "preview.htm", 1024, 768);
		break;
	case "btnTextFormatting":
		modelessDialogShow(e.scriptPath + "text1.htm", 511, 480);
		break;
	case "btnParagraphFormatting":
		modelessDialogShow(e.scriptPath + "paragraph.htm", 460, 284);
		break;
	case "btnListFormatting":
		modelessDialogShow(e.scriptPath + "list.htm", 303, 335);
		break;
	case "btnBoxFormatting":
		modelessDialogShow(e.scriptPath + "box.htm", 498, 395);
		break;
	case "btnCssText":
		modelessDialogShow(e.scriptPath + "styles_cssText.htm", 360, 352);
		break;
	case "btnCssBuilder":
		modelessDialogShow(e.scriptPath + "styles_cssText2.htm", 430, 445);
		break;
	case "btnForm0":
		modelessDialogShow(e.scriptPath + "form_form.htm", 280, 177);
		break;
	case "btnForm1":
		modelessDialogShow(e.scriptPath + "form_text.htm", 285, 289);
		break;
	case "btnForm2":
		modelessDialogShow(e.scriptPath + "form_list.htm", 295, 332);
		break;
	case "btnForm3":
		modelessDialogShow(e.scriptPath + "form_check.htm", 235, 174);
		break;
	case "btnForm4":
		modelessDialogShow(e.scriptPath + "form_radio.htm", 235, 177);
		break;
	case "btnForm5":
		modelessDialogShow(e.scriptPath + "form_hidden.htm", 235, 152);
		break;
	case "btnForm6":
		modelessDialogShow(e.scriptPath + "form_file.htm", 235, 132);
		break;
	case "btnForm7":
		modelessDialogShow(e.scriptPath + "form_button.htm", 235, 174);
		break;
	case "mnuTableSize":
		modelessDialogShow(e.scriptPath + "table_size.htm", 240, 282);
		break;
	case "mnuTableEdit":
		modelessDialogShow(e.scriptPath + "table_edit.htm", 400, 400);
		break;
	case "mnuCellEdit":
		modelessDialogShow(e.scriptPath + "table_editCell.htm", 427, 440);
		break;
	case "btnPasteWord":
		modelessDialogShow(e.scriptPath + "paste_word.htm", 400, 280);
		break;
	case "btnPasteText":
		modelessDialogShow(e.scriptPath + "paste_text.htm", 400, 280);
		break
	}
	var idx = 0;
	if (btn.indexOf("btnParagraphFormatting") != -1) {} else if (btn.indexOf("btnParagraph") != -1) {
		idx = btn.substr(btn.indexOf("_") + 1);
		e.applyParagraph(e.arrParagraph[parseInt(idx)][1])
	} else if (btn.indexOf("btnFontName") != -1) {
		idx = btn.substr(btn.indexOf("_") + 1);
		e.applyFontName(e.arrFontName[parseInt(idx)])
	} else if (btn.indexOf("btnFontSize") != -1) {
		idx = btn.substr(btn.indexOf("_") + 1);
		e.applyFontSize(e.arrFontSize[parseInt(idx)][1])
	} else if (btn.indexOf("btnCustomTag") != -1) {
		idx = btn.substr(btn.indexOf("_") + 1);
		e.insertCustomTag(parseInt(idx))
	}
};
function changeHeight(v) {
	var cH = String(this.height);
	var edtObj = document.getElementById("idArea" + this.oName);
	if (cH.indexOf("%") > -1) {
		cH = edtObj.childNodes[0].offsetHeight
	}
	if (!this.minHeight) this.minHeight = parseInt(cH, 10);
	var newHeight = parseInt(cH, 10) + v;
	if (v < 0) {
		var tbar = this.tbar;
		this.height = newHeight + "px";
		edtObj.style.height = this.height
	} else if (v > 0) {
		var tbar = this.tbar;
		this.height = newHeight + "px";
		edtObj.style.height = this.height
	}
};
function fixWord() {
	var pasteFrame = document.getElementById("idContentWord" + this.oName);
	var idSource = pasteFrame.contentWindow;
	for (var i = 0; i < idSource.document.body.getElementsByTagName("*").length; i++) {
		idSource.document.body.getElementsByTagName("*")[i].removeAttribute("class");
		idSource.document.body.getElementsByTagName("*")[i].removeAttribute("style")
	}
	var str = idSource.document.body.innerHTML;
	str = str.replace(/<!(?:--[\s\S]*?--\s*)?>\s*/gi, "");
	str = String(str).replace(/<\\?\?xml[^>]*>/g, "");
	str = String(str).replace(/<\/?o:p[^>]*>/g, "");
	str = String(str).replace(/<\/?u1:p[^>]*>/gi, "");
	str = String(str).replace(/<\/?v:[^>]*>/g, "");
	str = String(str).replace(/<\/?o:[^>]*>/g, "");
	str = String(str).replace(/<\/?st1:[^>]*>/g, "");
	str = String(str).replace(/<\/?w:wrap[^>]*>/gi, "");
	str = String(str).replace(/<\/?w:anchorlock[^>]*>/gi, "");
	str = String(str).replace(/&nbsp;/g, "");
	str = String(str).replace(/<\/?SPAN[^>]*>/g, "");
	str = String(str).replace(/<\/?FONT[^>]*>/g, "");
	str = String(str).replace(/<\/?STRONG[^>]*>/g, "");
	str = String(str).replace(/<\/?H1[^>]*>/g, "");
	str = String(str).replace(/<\/?H2[^>]*>/g, "");
	str = String(str).replace(/<\/?H3[^>]*>/g, "");
	str = String(str).replace(/<\/?H4[^>]*>/g, "");
	str = String(str).replace(/<\/?H5[^>]*>/g, "");
	str = String(str).replace(/<\/?H6[^>]*>/g, "");
	str = String(str).replace(/<\/?P[^>]*><\/P>/g, "");
	str = String(str).replace(/<!--\[if[^>]*>/gi, "");
	str = String(str).replace(/<!--\[endif\]-->/gi, "");
	str = String(str).replace(/<!\[endif\]-->/gi, "");
	str = String(str).replace(/<\/?meta[^>]*>/g, "");
	str = String(str).replace(/<\/?link[^>]*>/g, "");
	str = String(str).replace(/<\/?style[^>]*>/g, "");
	this.insertHTML(str)
}