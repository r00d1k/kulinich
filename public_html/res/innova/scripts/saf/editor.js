/***********************************************************
InnovaStudio WYSIWYG Editor 5.3
ï¿½ 2011, InnovaStudio (www.innovastudio.com). All rights reserved.
************************************************************/
//eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('a 50=1k ge();a 14=1k cz();u cz(){9.8d="en-cA";2K{if(cB)9.8d=cB}2L(e){}a 3F=c.2n("3G");R(a i=0;i<3F.G;i++){a 5S=3F[i].4u.2s();if(5S.1H("3r/50.js")!=-1){9.X=3F[i].4u.C(/50.js/,"")}H if(5S.1H("gf/5T.js")!=-1){if(!9.X)9.X=3F[i].4u.C(/5T.js/,"")+"3r/"}}9.cC=9.X.C(/\\/3r/,"")+"gg/"+9.8d+"/";if(9.8d=="en-cA")c.6V("<cD"+"cE 4u=\'"+9.cC+"gh.js\'></cD"+"cE>");9.b;9.k;9.11;9.J;9.6W;9.51=51;9.gj=E;9.2W=[];9.8e=u(){O E};9.41;9.gk;9.at=at;9.au=L;9.8f=[[gl,"&gm;"],[cF,"&gn;"],[6X,"&av;"],[go,"&gp;"],[gq,"&gr;"],[gs,"&gu;"],[gv,"\\""]];9.6Y=[];R(a i=0;i<9.8f.G;i++){9.6Y[i]=[1k cG(1p.gw(9.8f[i][0]),"g"),9.8f[i][1]]}9.6Z=u(l){R(a i=0;i<9.6Y.G;i++){l=l.C(9.6Y[i][0],9.6Y[i][1])}l=l.C(/52="cI-d-2e"/gi,"");O l};9.gx=u(4v,3c){a 53=[],2M,8g;if(gy(4v)=="gz"&&4v.1c&&4v.1c=="42"){53[0]=4v}H if(4v.3d(0,1)=="#"){2M=c.M(4v.3d(1));if(!2M)O;53[0]=2M}H{a 70=c.2n("42");R(a i=0;i<70.G;i++){if(70[i].3e==4v){53[53.G]=70[i]}}}R(a i=0;i<53.G;i++){2M=53[i];if(2M.id||2M.id=="")2M.id="gA"+i;8g=c.43("44");8g.id="5T"+i;2M.1y.gB(8g,2M);2f["2g"+i]=1k cJ("2g"+i);a 5U;if(2f.cK){5U=2f.cK(2M,1h)}H if(2M.cL){5U=2M.cL}H{5U={1m:2f["2g"+i].1m,1i:2f["2g"+i].1i}}2f["2g"+i].1m=5U.1m;2f["2g"+i].1i=5U.1i;if(3c){R(a it in 3c){2f["2g"+i][it]=3c[it]}}2f["2g"+i].8h(2M.id,"5T"+i)}}};u 51(N){3f(N!=1h){if(N.4w&&N.4w=="1n")O E;N=N.1y}O L};u aw(){a k=c.M("Z"+9.b).12;a J=k.1d();a 8i=1Q(J);if(8i!=1h){if(!51(8i))O L}H{if(!51(8i))O L}O E};u cM(3H){a k=c.M("Z"+9.b);if(k){k=k.12;k.28()}if(3H&&k){a gC;a D=k.c.2D();if(k.c.1f.1o.G>0){a 54=1h;if(3H=="gD"){54=k.c.1f.1o[0];D.2E(54);D.3I(E)}H{54=k.c.1f.1o[k.c.1f.1o.G-1];D.2E(54);if(54.1T==1&&54.1c=="71"){D.3I(E)}H{D.3I(L)}}}H{D.ax(k.c.1f);D.3I(L)}a 2h=k.1d();2h.2t();2h.2u(D);a 3g=c.gE(\'gF\');3g.gG(\'gH\',E,E,2f,\' \');k.c.gI(3g);D=2h.2a(0);D.72(D.2v,D.3h-1);D.8j();2h.2t();2h.2u(D)}};u ay(3H){9.28(3H)};u at(b){if((b!=1h)&&(b!="")){2K{a 4x=c.M("Z"+b);4x.gJ.1f.3J=E;4x.28()}2L(e){}}H{R(a i=0;i<9.2W.G;i++){2K{a 4x=c.M("Z"+9.2W[i]).12;4x.c.1f.3J=E;a r=4x.1d().2a(0);r.2E(4x.c.2n("gK")[0]);r.3I(E);4x.28()}2L(e){}}}};a 5V;u cJ(b){9.b=b;9.cN=cO;9.73=73;9.8k=8k;9.74=74;9.5W=5W;9.5X=5X;9.5Y=5Y;9.5Z=5Z;9.az=az;9.aA=aA;9.45="";9.cP=u(){O E};9.aB="#gL";9.aC="3K";9.8l=8l;9.8m=8m;9.4y=4y;9.4z=4z;9.46=46;9.8n=8n;9.8o=8o;9.51=51;9.aw=aw;9.28=cM;9.ay=ay;9.1R=1R;9.8p=8p;9.8q=8q;9.8r=8r;9.8s=8s;9.8t=8t;9.8u=8u;9.8v=8v;9.8w=8w;9.8x=8x;9.8y=8y;9.8z=8z;9.aD=aD;9.8A=8A;9.75=75;9.8B=8B;9.8C=8C;9.8D=8D;9.47=47;9.1j=1j;9.1m="gM";9.1i="gN";9.76="";a 3F=c.2n("3G");R(a i=0;i<3F.G;i++){a 5S=3F[i].4u.2s();if(5S.1H("3r/50.js")!=-1){9.X=3F[i].4u.C(/50.js/,"");q}H if(5S.1H("5T.js")!=-1){9.X=3F[i].4u.C(/5T.js/,"3r/");q}}9.2w="cQ/";9.aE=29;9.5V=25;9.gO=0;9.gP=0;9.55=55;9.4A=[];9.2X=1k aF("2X",9.b);9.2Y=1k aF("2Y",9.b);9.77=77;9.gQ=L;9.gR=L;9.gS="";9.gT="";9.8E=8E;9.8F=L;9.gU=cR;9.56=[];9.48=["aG","aH","aI","aJ","8G","cS","aK","aL","60","cT","cU","8H","8I","61","aM","8J","8K","78","8L","8M","8N","cV","cW","cX","cY","2Z","aN","cZ","aO","8O","8P","8Q","79","d0","d1","d2","aP","d3","4B","aQ","8R","d4","7a","7b","7c","3s","3t","3u","3v","3w","3L","62","63","64","65","8S","8T","57","58","d5","d6"];9.59=L;9.8U=E;9.7d=E;9.7e=L;9.7f=E;9.7g=L;9.5a=E;9.5b=E;9.5c=E;9.4C=E;9.66=E;9.67=L;9.8V=L;9.4D=E;9.4E=E;9.4F=E;9.d7=E;9.d8=E;9.aR=E;9.68=L;9.49=E;9.4a=E;9.5d=E;9.5e=E;9.5f=E;9.5g=L;9.5h=L;9.5i=L;9.69=E;9.6a=E;9.6b=E;9.6c=E;9.5j=E;9.5k=E;9.5l=E;9.5m=E;9.5n=L;9.5o=L;9.6d=E;9.6e=E;9.7h=E;9.7i=E;9.8W=E;9.5p=L;9.7j=E;9.7k=L;9.7l=L;9.6f=E;9.d9=E;9.7m=E;9.6g=E;9.5q=E;9.7n=E;9.7o=E;9.8X=L;9.8Y=L;9.4G=L;9.4H=E;9.8Z=L;9.7p=E;9.7q=L;9.aS=[["gV","gW",["da","db","dc"]],["gX","6h",["dd","de","df"]]];9.6i=[["da","",["aP","aH","8G","79","4B","8H","8I","aK","aL","60","cT","cU"]],["db","",["7b","7c","3v","3w","4B","3s","3t","3u","61","aM"]],["dc","",["7a","57","58","8R","aQ","4B","62","63","64","65","8S","8T"]],["dd","",["8K","8J","4B","78"]],["de","",["2Z","4B","cZ"]],["df","",["8M","8L","8N","4B","8O","8P"]]];9.aT=1;9.dg=E;9.dh=L;9.gY="";9.gZ="";9.h0="";9.h1="";9.h2="";9.6j=L;9.aU=";";9.6k=L;9.aV=";";9.aW=aW;9.6l=L;9.aX=";";9.6m=L;9.aY=";";9.1D=[];9.aZ=L;9.7r=7r;9.6n=[[K("6o 1"),"91"],[K("6o 2"),"92"],[K("6o 3"),"93"],[K("6o 4"),"94"],[K("6o 5"),"95"],[K("6o 6"),"96"],[K("h3"),"97"],[K("di (P)"),"P"],[K("di (44)"),"44"]];9.4I=["b0","b0 h4","b0 h5","h6 h7","h8 h9 dj","ha dk","hb dl dm","hc dn","hd dk he","hf","hh","hi","b1 hj","b1 dl","b1 hk","hl","hm hn","ho hp","do","hq","hs ht","hu","hv","hw dn do","hx dm","hy","hz","hA","dp","hB-dp","hC","hD","hE"];9.5r=[[K("4b 1"),"1"],[K("4b 2"),"2"],[K("4b 3"),"3"],[K("4b 4"),"4"],[K("4b 5"),"5"],[K("4b 6"),"6"],[K("4b 7"),"7"]];9.7s=[];9.5s="";9.3M="<3M>";9.b2="";9.6p="";9.6q="";9.b3=b3;9.dq=u(){c.M("b4"+9.b).dr()};9.ds=u(){O E};9.dt=u(){O E};9.hF=L;9.98=98;9.99=99;9.1F=1F;9.7t=7t;9.3N=[];9.7u=[];9.7v=E;9.5t="4c";9.6r=6r;9.7w=7w;9.7x=7x;9.9a=9a;9.9b=9b;9.3x=[["hG","du(0)","dv dw","59.T"],["hH","du(0)","dv dw","59.T"]];9.8e=u(){O E};9.9c="b5";9.7y=L;9.7z=7z;9.9d=9d;9.8h=8h;9.2N="7A";9.5u;a me=9;9.1l=1k hI(9.b);9.1l.2w=9.X.1N(0,9.X.1H("3r/"))+9.2w;50[50.G]=9;O 9};u 1F(){a k=c.M("Z"+9.b).12;a 11=9;if(11.3N[0])if(k.c.1f.1e==11.3N[0][0])O;R(a i=20;i>1;i--)11.3N[i-1]=11.3N[i-2];11.28();11.3N[0]=[k.c.1f.1e,1h];9.7u=[];if(9.49)9.1l.1E["49"+9.b].1B(1);if(9.4a)9.1l.1E["4a"+9.b].1B(5)};u 98(){9.7t(9.3N,9.7u)};u 99(){9.7t(9.7u,9.3N)};u 7t(5v,9e){a k=c.M("Z"+9.b).12;a 11=9;if(!5v[0])O;R(a i=20;i>1;i--)9e[i-1]=9e[i-2];a J=k.1d();a D=J.2a(0);9e[0]=[k.c.1f.1e,D.hJ()];l=5v[0][0];k.c.1f.1e=l;J=k.1d();J.2t();J.2u(5v[0][1]);R(a i=0;i<19;i++)5v[i]=5v[i+1];5v[19]=1h;2O(9)};a b6=L;u 8h(5u,7B){9.5u=5u;a b7=c.M(5u);b7.d.2i="30";a 7C=b7.hK;if(7C){if(!b6){if(7C.b8)9f=7C.b8;b6=E}7C.b8=1k 2F("O dz()")}a 1V=c.M(5u).6s+" ";1V=1V.C(/&/g,"&2P;");1V=1V.C(/</g,"&lt;");1V=1V.C(/>/g,"&gt;");9.73(1V,7B)};u b3(){a 1V="";if(9.2N=="9g"){1V=9.5W()}H if(9.2N=="3y"){1V=9.5X()}H if(9.2N=="7A"){1V=9.5Y()}H if(9.2N=="9h"){1V=9.5Z()}if(1V!=9.6q){O E}O L};u dz(){a 1V;R(a i=0;i<14.2W.G;i++){a 2g=1K(14.2W[i]);if(2g.2N=="9g")1V=2g.5W();if(2g.2N=="3y")1V=2g.5X();if(2g.2N=="7A")1V=2g.5Y();if(2g.2N=="9h")1V=2g.5Z();c.M(2g.5u).6s=1V}if(9f)O 9f()};u 9f(){};u 73(1W,7B){5V=9.5V;if(1W.1N(0,4)=="<!--"&&1W.1N(1W.G-3)=="-->")1W=1W.1N(4,1W.G-3);if(1W.1N(0,4)=="<!--"&&1W.1N(1W.G-6)=="--&gt;")1W=1W.1N(4,1W.G-6);1W=1W.C(/&lt;/g,"<");1W=1W.C(/&gt;/g,">");1W=1W.C(/&2P;/g,"&");if(9.aU!=";")9.6j=E;if(9.aV!=";")9.6k=E;if(9.aY!=";")9.6m=E;if(9.aX!=";")9.6l=E;if(9.7s.G>0)9.5p=E;if(9.2N=="9g"){9.4H=E;9.4G=L}if(9.2N=="3y"){9.4G=E;9.4H=L}if(9.2N=="7A"){9.4H=E;9.4G=L}if(9.2N=="9h"){9.4G=E;9.4H=L}a dA=L;if(9.56.G>0){dA=E;R(a i=0;i<9.48.G;i++)1K(9.b+".V"+9.48[i]+"=E");9.5a=L;9.5b=L;9.5c=L;9.4C=L;9.66=L;9.67=L;R(a j=0;j<9.56.G;j++)1K(9.b+".V"+9.56[j]+"=E");R(a i=0;i<9.48.G;i++){6t=9.48[i];b9=L;R(a j=0;j<9.56.G;j++)if(6t==9.56[j])b9=E;if(!b9)1K(9.b+".V"+6t+"=L")}9.48=9.56}9.6p=1W;a dB="";a hL="";a 1X="";9.2X.2G=9.X+"hM.18";9.2X.ba=1k 2F(9.b+".1j()");9.2X.9i=1k 2F(9.b+".1j()");9.2X.7D=1k 2F(9.b+".55(\'61\', "+9.b+".2X.1z)");9.2X.9j=1k 2F(9.b+".55(\'61\',\'\')");9.2X.9k=K("9l 6u");9.2X.9m=K("bb 6u...");9.2Y.2G=9.X+"hN.18";9.2Y.ba=1k 2F(9.b+".1j()");9.2Y.9i=1k 2F(9.b+".1j()");9.2Y.7D=1k 2F(9.b+".55(\'hO\', "+9.b+".2Y.1z)");9.2Y.9j=1k 2F(9.b+".55(\'dC\',\'\')");9.2Y.9k=K("9l 6u");9.2Y.9m=K("bb 6u...");a me=9;if(9.aT!=0){a 1I=1h,4d,9n=1k dD();R(a i=0;i<9.48.G;i++){1K(9.b+".V"+9.48[i]+"=L")}R(a i=0;i<9.6i.G;i++){1I=9.6i[i];4d=9.1l.dE(9.b+"1l"+1I[0]);4d.3z=u(id){bc(4d,id,me,me.b)};4d.d.hP="hQ";4d.2w=9.X.1N(0,9.X.1H("3r/"))+9.2w;4d.dF=9.aE;4d.dG=9.5V;R(a j=0;j<1I[2].G;j++){1K(9.b+".V"+1I[2][j]+"=E")}bd(4d,9,1I[2]);9n[1I[0]]=1I[1]}if(9.aT==1){a dH=9.1l.hR("hS"+9.b),5w;R(a i=0;i<9.aS.G;i++){1I=9.aS[i];5w=9.1l.dI(9.b+"dJ"+1I[0]);R(a j=0;j<1I[2].G;j++){5w.dK(9.b+1I[2][j],9n[1I[2][j]],9.b+"1l"+1I[2][j])}dH.hT(9.b+1I[0],1I[1],5w)}}H if(9.6i.G>0){a 5w;5w=9.1l.dI(9.b+"dJ");R(a i=0;i<9.6i.G;i++){1I=9.6i[i];5w.dK(9.b+1I[0],9n[1I[0]],9.b+"1l"+1I[0])}}}H{a 5x=9.1l.dE(9.b);5x.3z=u(id){bc(5x,id,me,me.b)};5x.2w=9.X.1N(0,9.X.1H("3r/"))+9.2w;5x.dF=9.aE;5x.dG=9.5V;bd(5x,9,9.48)}a l="";a be=9.X.1N(0,9.X.1H("3r/"))+9.2w;if(!c.M("9o"))l+="<3A id=9o d=\'2j:1A\'></3A>";l+="<1q id=5y"+9.b+" 5z=5y"+9.b+" 1t=\'1A\' "+"2o=0 2p=0 1m=\'"+9.1m+"\' 1i=\'"+9.1i+"\' d=\'1t-4c:1J 1a #6v\'>"+"<17><Y 4e=2 d=\\"1C:1A;1t:#6v 1A 1J;1Y:2G(\'"+be+"bg.T\')\\">"+"<1q 2o=0 2p=0 1t=0 1m=1Z%><17><Y 31=bf d=\'1C:1A;\'>"+9.1l.hU()+"</Y></17></1q>"+"</Y></17>"+"<17 id=dL"+9.b+"><Y 4e=2 id=dM"+9.b+" 1i=1A d=\'1C:1A;\'></Y></17>";l+="<17 d=\'1m:1Z%;1i:1Z%\'><Y 4e=2 4J=2Q 1i=1Z% d=\'1C:1A;1Y:3K;1C-4K:1A;\'>";l+="<1q id=\'hV"+9.b+"\' 2o=0 2p=0 1m=\'1Z%\' 1i=\'1Z%\' d=\'2j-2Q:1A;\'><17 d=\'1m:1Z%;1i:1Z%\'><Y 1m=\'1Z%\' 1i=\'1Z%\' d=\'1C:1A;1t:1J 1a #6v;1t-4c:30\'>";l+="<9p hW=\'hX\' d=\'1m:1Z%;1i:1Z%;\' "+" 5z=Z"+9.b+" id=Z"+9.b+"></9p>";l+="<9p d=\'1m:1a;1i:1a;9q:dN;1t:1A\' id=\\"3B"+9.b+"\\" 5z=\\"3B"+9.b+"\\" 4u=\'"+9.X+"hY.T\'></9p>";l+="</Y><Y id=2H"+9.b+" d=\'1C:1A;1Y:#33\'></Y></17></1q>";l+="</Y></17>";l+="<17 id=dO"+9.b+"><Y 4e=2 id=dP"+9.b+" d=\'1C:1A;\'></Y></17>";if(9.dg){l+="<17 id=hZ"+9.b+"><Y 4e=2 d=\'1C:1A;\'><3A  d=\'2R:n-dQ;\' 52=\'i0\' i1=\\"dR(3O, 9, \'"+9.b+"\')\\" ></3A></Y></17>"}l+="</1q>";l+=dB;l+="<9r 3H=i2 5z=b4"+9.b+" id=b4"+9.b+" 6s=i3 d=\'2i:30\' >";if(7B){a bh=[];bh[0]=l;c.M(7B).1e=bh.dS("")}H{c.6V(l)}9.cN()};u dR(ev,bi,b){c.dT=dU;c.dV=dW;c.i4=u(){O L};c.i5=u(){O L};c.1f.d.2R="n-dQ";14.bj=1K(b);14.6w={x:ev.9s,y:ev.9t};if(!14.9u)14.9u=1k dX(b);14.9u.i6()};u dW(3O){14.9v={dx:3O.9s-14.6w.x,dy:3O.9t-14.6w.y};14.bj.7z(14.9v.dy);14.9u.i7();c.dT=1h;c.dV=1h;c.1f.d.2R="3i"};u dU(3O){14.9v={dx:3O.9s-14.6w.x,dy:3O.9t-14.6w.y};14.bj.7z(14.9v.dy);14.6w={x:3O.9s,y:3O.9t}};u cO(){if(9.7v){if(9.5t=="4c")9.5t="2Q";H 9.5t="4c";9.6r()}a k=c.M("Z"+9.b).12;14.b=9.b;14.k=k;14.11=9;14.2W.dY(9.b);a 3P=1p(9.6p).2S(/<3y[^>]*>/ig);if(3P){9.74(9.6p)}H{9.8k(9.6p)}if(!14.au){if(2f.bk)bl=2f.bk;2f.bk=1k 2F("dZ()");14.au=E}2K{k.c.1f.3J=E}2L(e){}9.28();2K{a 6x=k.c.1f.1e;6x=6x.C(/\\s+/gi,"");if(6x==""){k.c.1f.1e="<br 52=\\"bm\\" />"}a D=k.c.2D();D.2E(k.c.1f.1o[0]);D.3I(E);a 2h=k.1d();2h.2t();2h.2u(D)}2L(e){}4L(9.2N){z"9g":9.6q=9.5W();q;z"3y":9.6q=9.5X();q;z"7A":9.6q=9.5Y();q;z"9h":9.6q=9.5Z();q};9.28()};u bd(Q,F,bn){a b=F.b;R(a i=0;i<bn.G;i++){6t=bn[i];4L(6t){z"|":Q.i8();q;z"4B":Q.i9();q;z"aG":if(F.59)Q.1w("59"+b,"59.T",K("aG"));q;z"aI":if(F.8U){Q.3j("8U"+b,"e0"+b,"8U.T",K("aI"));a 3Q=1k 3k("e0"+b);3Q.2b("e1"+b,"ia");3Q.2b("e2"+b,"ib");3Q.2b("e3"+b,"ic");3Q.3z=u(id){3R(Q,id,F,F.b)}}q;z"aH":if(F.7d)Q.1w("7d"+b,"7d.T",K("e4 ie"));q;z"aJ":if(F.7e)Q.1w("7e"+b,"7e.T",K("aJ"));q;z"8G":if(F.7f)Q.1w("7f"+b,"7f.T",K("8G"));q;z"cS":if(F.7g){if(F.9c!="b5")Q.1w("7g"+b,"7g.T",K("ih ii"))}q;z"aQ":if(F.5a||F.4C||F.5b||F.5c||F.66||F.67){Q.3j("ij"+b,"e5"+b,"ik.T",K("8R & 6y"));a 4f=1k 3k("e5"+b);4f.2w=Q.2w;4f.3z=u(id){3R(Q,id,F,F.b)};if(F.5a)4f.2b("5a"+b,K("9w 6y"),"5a.T");if(F.4C)4f.2b("4C"+b,K("7a 6y"),"4C.T");if(F.5b)4f.2b("5b"+b,K("e6 6y"),"5b.T");if(F.5c)4f.2b("5c"+b,K("il 6y"),"5c.T");if(F.66)4f.2b("66"+b,K("9l e7"),"im.T");if(F.67)4f.2b("67"+b,K("e7 io"))}q;z"8R":if(F.8V)Q.1w("8V"+b,"ip.T",K("dj iq"));q;z"7a":if(F.4D){Q.3j("4D"+b,"e8"+b,"4D.T",K("7a"),37);a bo=1k 3k("e8"+b);bo.3z=u(id){3R(Q,id,F,F.b)};R(a j=0;j<F.6n.G;j++){bo.2b("ir"+j+b,"<"+F.6n[j][1]+" d=\\"\\2j-4c:is\\"  1u=1n> "+F.6n[j][0]+"</"+F.6n[j][1]+">")}}q;z"7b":if(F.4E){Q.3j("4E"+b,"9x"+b,"4E.T",K("e9 iu"),37);a bp=1k 3k("9x"+b);bp.3z=u(id){3R(Q,id,F,F.b)};R(a j=0;j<F.4I.G;j++){bp.2b("ea"+j+b,"<2e d=\'2c-4g:"+F.4I[j]+"\' 1u=1n>"+F.4I[j]+"</2e><2e 1u=1n d=\'2c-4g:iv\'>("+F.4I[j]+")</2e>")}}q;z"7c":if(F.4F){Q.3j("4F"+b,"9y"+b,"4F.T",K("e9 4b"),37);a bq=1k 3k("9y"+b);bq.3z=u(id){3R(Q,id,F,F.b)};R(a j=0;j<F.5r.G;j++){bq.2b("eb"+j+b,"<2c 1u=1n 1G=\\""+F.5r[j][1]+"\\">"+F.5r[j][0]+"</2c>")}}q;z"8H":if(F.49)Q.1w("49"+b,"49.T",K("8H"));q;z"8I":if(F.4a)Q.1w("4a"+b,"4a.T",K("8I"));q;z"60":if(F.6g||F.68){Q.3j("aR"+b,"ec"+b,"aR.T",K("60"));a 3Q=1k 3k("ec"+b);3Q.2w=Q.2w;if(F.6g)3Q.2b("6g"+b,K("60 iw ix"),"6g.T");if(F.68)3Q.2b("68"+b,K("60 9w"),"68.T");3Q.3z=u(id){3R(Q,id,F,F.b)}}q;z"3s":if(F.5d)Q.2T("5d"+b,"",L,"5d.T",K("3s"));q;z"3t":if(F.5e)Q.2T("5e"+b,"",L,"5e.T",K("3t"));q;z"3u":if(F.5f)Q.2T("5f"+b,"",L,"5f.T",K("3u"));q;z"3v":if(F.5g)Q.2T("5g"+b,"",L,"5g.T",K("3v"));q;z"3w":if(F.5h)Q.2T("5h"+b,"",L,"5h.T",K("3w"));q;z"3L":if(F.5i)Q.2T("5i"+b,"",L,"5i.T",K("3L"));q;z"62":if(F.69)Q.2T("69"+b,"2x",L,"iy.T",K("9z bs"));q;z"63":if(F.6a)Q.2T("6a"+b,"2x",L,"iz.T",K("9z iA"));q;z"64":if(F.6b)Q.2T("6b"+b,"2x",L,"iB.T",K("9z bt"));q;z"65":if(F.6c)Q.2T("6c"+b,"2x",L,"iC.T",K("9z e4"));q;z"8S":if(F.5j)Q.2T("5j"+b,"ed",L,"iD.T",K("8S"));q;z"8T":if(F.5k)Q.2T("5k"+b,"ed",L,"iE.T",K("8T"));q;z"57":if(F.5l)Q.1w("5l"+b,"5l.T",K("57"));q;z"58":if(F.5m)Q.1w("5m"+b,"5m.T",K("58"));q;z"d5":if(F.5n)Q.2T("5n"+b,"31",L,"5n.T",K("bs ee bt"));q;z"d6":if(F.5o)Q.2T("5o"+b,"31",L,"5o.T",K("bt ee bs"));q;z"61":Q.3j("6d"+b,"ef"+b,"6d.T",K("iF eg"));a 4M=1k 3k("ef"+b);4M.bu(1k bv("iG",F.2X.6z()));q;z"aM":Q.3j("6e"+b,"eh"+b,"6e.T",K("iH eg"));a 4M=1k 3k("eh"+b);4M.bu(1k bv("iI",F.2Y.6z()));q;z"8J":if(F.7i)Q.1w("7i"+b,"7i.T",K("8J"));q;z"8K":if(F.7h)Q.1w("7h"+b,"7h.T",K("8K"));q;z"d4":if(F.5p){Q.3j("5p"+b,"7E"+b,"5p.T",K("iJ"),37);a 7E=1k 3k("7E"+b);7E.3z=u(id){3R(Q,id,F,F.b)};R(a j=0;j<F.7s.G;j++){7E.2b("iK"+j+b,F.7s[j][0])}}q;z"78":if(F.7j)Q.1w("7j"+b,"7j.T",K("78"));q;z"8L":if(F.7k)Q.1w("7k"+b,"7k.T",K("8L"));q;z"8M":if(F.7l)Q.1w("7l"+b,"7l.T",K("8M"));q;z"8N":if(F.7p)Q.1w("7p"+b,"7p.T",K("8N"));q;z"cV":if(F.6j)Q.1w("6j"+b,"6j.T",K("iL iM"));q;z"cW":if(F.6k)Q.1w("6k"+b,"6k.T",K("ei ej"));q;z"cX":if(F.6m)Q.1w("6m"+b,"6m.T",K("ei 78"));q;z"cY":if(F.6l)Q.1w("6l"+b,"6l.T",K("dD"));q;z"2Z":if(F.6f){a 4N=[],5A=0;4N[5A++]="<1q 1m=\'iN\' id=\'bw"+b+"\' d=\'2R:3i;1Y:#9A;\' 2o=0 2p=1 1u=1n>";R(a m=0;m<8;m++){4N[5A++]="<17>";R(a n=0;n<8;n++){4N[5A++]="<Y 3C=\'"+b+".9a(9)\' 4O=\'ek(9);3O.iO=E;\' d=\'1Y:#4P;2c-1G:1a;1t:#iP 1a 1J;1m:em;1i:em;\' 1u=1n>&2U;</Y>"}4N[5A++]="</17>"}4N[5A++]="<17><Y 4e=8 3C=\\""+b+".1j();1x(\'"+F.X+"iQ.18\',bx,bx);\\" 4O=\\"eo(c.M(\'bw"+b+"\'));9.1e=\'"+K("9B 2Z 6h")+"\';9.d.1t=\'#7F 1a 1J\';9.d.2y=\'#ep\';9.d.1z=\'#4P\'\\" 5B=\\"9.d.1t=\'#9A 1a 1J\';9.d.2y=\'#9A\';9.d.1z=\'#4h\'\\" 2x=4Q d=\'2c-4g:6A;2c-1G:7G;1z:#4h;1t:#9A 1a 1J;1C:1a 1a 1a 1a\' 1u=1n>"+K("9B 2Z 6h")+"</Y></17>";4N[5A++]="</1q>";Q.3j("6f"+b,"4M"+b,"6f.T",K("6h 2Z"));a 4M=1k 3k("4M"+b);4M.bu(1k bv("iR",4N.dS("")));Q.3j("by"+b,"eq"+b,"by.T",K("5C 2Z/er"));a 6B=1k 3k("eq"+b);6B.3z=u(id){3R(Q,id,F,F.b)};6B.2w=Q.2w;6B.2b("bz"+b,K("2Z 4b"),"iS.T");6B.2b("bA"+b,K("5C 2Z"),"iT.T");6B.2b("7H"+b,K("5C er"),"iU.T")}q;z"aN":if(F.7q)Q.1w("7q"+b,"7q.T",K("aN"));q;z"aO":if(F.7m)Q.1w("7m"+b,"7m.T",K("aO"));q;z"8O":if(F.8W)Q.1w("8W"+b,"iV.T",K("iW 8O"));q;z"8P":if(F.5q)Q.1w("5q"+b,"5q.T",K("8P"));q;z"8Q":if(F.7n){a bB=[[K("8Q"),"es.18","7I","9C"],[K("9w bC"),"et.18","eu","ew"],[K("e6"),"ex.18","ey","bD"],[K("iX"),"ez.18","3S","6X"],[K("iY eA"),"eB.18","3S","9C"],[K("iZ bC"),"eC.18","3S","eD"],[K("j0 bC"),"eE.18","3S","eF"],[K("eA"),"eG.18","3S","6X"]];Q.3j("7n"+b,"7J"+b,"7n.T",K("8Q j1"));a 7J=1k 3k("7J"+b);7J.3z=u(id){3R(Q,id,F,F.b)};R(a j=0;j<bB.G;j++){7J.2b("7n"+j+b,bB[j][0])}}q;z"79":if(F.7o)Q.1w("7o"+b,"7o.T",K("bE 6y"));q;z"d0":if(F.8X)Q.1w("8X"+b,"9D.T",K("9E/5C 9F"));q;z"d1":if(F.8Y)Q.1w("8Y"+b,"9D.T",K("9E/5C 9F"));q;z"d2":if(F.4G)Q.1w("4G"+b,"9D.T",K("9E/5C 9F"));q;z"aP":if(F.4H)Q.1w("4H"+b,"9D.T",K("9E/5C 9F"));q;z"d3":if(F.8Z)Q.1w("8Z"+b,"j2.T",K("j3 j4"));q;3i:R(j=0;j<F.3x.G;j++){if(6t==F.3x[j][0]){bF=F.3x[j][0];bG=F.3x[j][2];bH=F.3x[j][3];if(F.3x[j][4])Q.1w(bF+b,bH,bG,F.3x[j][4]);H Q.1w(bF+b,bH,bG)}}q}}};u cR(s){O c.M(s+9.b)};u dZ(){bl()};u bl(){};a 7K=[];u aF(7L,7M){9.eH=7M;if(7M){9.b=7M+"."+7L;9.4R=7L+7M}H{9.b=7L;9.4R=7L}7K.dY(9.b);9.2G="j5.18";9.ba=u(){O E};9.eI=u(){O E};9.7D=u(){O E};9.9j=u(){O E};9.9i=u(){O E};9.9G=eJ;9.1j=eK;9.9H=eL;9.1z;9.4A=[];9.9I=9I;9.bI=L;9.9k="9l 6u";9.9m="bb 6u...";9.2x="5D";9.bJ="#4P";9.6z=6z;9.73=eM};u 6z(){a 6C=[["#j6","#j7","#j8","#j9","#ja","#jb","#jc","#4h"],["#jd","#je","#jf","#eN","#jg","#jh","#ji","#jj"],["#jk","#jl","#jm","#jn","#jo","#jp","#jq","#jr"],["#jt","#ju","#jv","#jw","#jx","#jy","#jz","#jA"],["#jB","#jC","#jD","#jE","#jF","#jG","#jH","#4P"]];a 34="<1q id=bK"+9.4R+" d=\\"2R:3i;1Y-1z:#33;1C:bL\\" 1u=1n 2o=0 2p=0 1m=jI><17><Y 1u=1n d=\'1C:1A;\'>";34+="<1q 2x=4Q 2o=0 2p=0 1t=0 1u=1n>";R(a i=0;i<6C.G;i++){34+="<17>";R(a j=0;j<6C[i].G;j++)34+="<Y 3C=\\""+9.b+".1z=\'"+6C[i][j]+"\';"+9.b+".7D();"+9.b+".bJ=\'"+6C[i][j]+"\';"+9.b+".9H()\\" 4O=\\"9.d.1t=\'#7F 1a 1J\'\\" 5B=\\"9.d.1t=\'#33 1a 1J\'\\" d=\\"1C:1A;2R:3i;1C:1a;1t:#33 1a 1J;\\" 1u=1n>"+"<1q d=\'2j:1A;1m:9J;1i:9J;1Y:"+6C[i][j]+";1t:3K 1a 1J\' 2o=0 2p=0 1u=1n>"+"<17><Y 1u=1n d=\'1C:1A;\'></Y></17>"+"</1q></Y>";34+="</17>"}34+="<17><Y 4e=8 id=bM"+9.4R+" d=\'1C:1A;\'></Y></17>";34+="<17>";34+="<Y 1u=1n d=\'1C:1A;\'>"+"<1q d=\'1C:1A;2j-5D:1a;1m:9K;1i:9K;1Y:#33;\' 2o=0 2p=0 1u=1n>"+"<17><Y 3C=\\""+9.b+".9j();"+9.b+".bJ=\'\';"+9.b+".9H()\\" 4O=\\"9.d.1t=\'#7F 1a 1J\'\\" 5B=\\"9.d.1t=\'3K 1a 1J\'\\" d=\\"2R:3i;1C:1a;1t:3K 1a 1J;2c-4g:6A;2c-1G:7G;1z:#4h;35-1i:6D;\\" 2x=4Q 4J=2Q 1u=1n>x</Y></17>"+"</1q></Y>";34+="<Y 4e=7 1u=1n d=\'1C:1A;\'>"+"<1q d=\'1C:1A;2j:1a;1m:jJ;1i:jK;1Y:#33;1t:3K 1a 1J\' 2o=0 2p=0 1u=1n>"+"<17><Y id=\\""+9.b+"jL\\" 3C=\\""+9.b+".9i();"+9.b+".9H();1x(\'"+9.2G+"?"+9.b+"\', eO, eO, 2f,{\'b\':\'"+9.b+"\'})\\" 4O=\\"9.d.1t=\'#7F 1a 1J\';9.d.1Y=\'#ep\';9.d.1z=\'#4P\'\\" 5B=\\"9.d.1t=\'#33 1a 1J\';9.d.1Y=\'#33\';9.d.1z=\'#4h\'\\" d=\\"2R:3i;2c-4g:6A;2c-1G:6D;1z:#4h;35-1i:6D;1C:1a\\" 2x=4Q 4J=2Q 5E 1u=1n>"+9.9m+"</Y></17>"+"</1q></Y>";34+="</17>";34+="</1q>";34+="</Y></17></1q>";O 34};u eM(){c.6V(9.6z())};u 9I(){9.4A=1K(9.eH).4A;if(9.4A.G==0){c.M("bM"+9.4R).1e="";O}l="<1q 2o=0 2p=0 1m=1Z%><17><Y 4e=8 d=\\"2c-4g:6A;2c-1G:6D;1z:#4h;35-1i:6D;1C:1a\\">"+9.9k+":</Y></17></1q>";l+="<1q 2o=0 2p=0><17>";R(a i=0;i<9.4A.G;i++){if(i<22){if(i==8||i==16||i==24||i==32)l+="</17></1q><1q 2o=0 2p=0><17>";l+="<Y 3C=\\""+9.b+".1z=\'"+9.4A[i]+"\';"+9.b+".7D()\\" 4O=\\"9.d.1t=\'#7F 1a 1J\'\\" 5B=\\"9.d.1t=\'#33 1a 1J\'\\" d=\\"2R:3i;1C:1a;1t:#33 1a 1J;\\" 1u=1n>"+"   <1q  d=\'2j:1A;1m:9J;1i:9J;1Y:"+9.4A[i]+";1t:3K 1a 1J\' 2o=0 2p=0 1u=1n>"+"   <17><Y 1u=1n></Y></17>"+"   </1q>"+"</Y>"}}l+="</17></1q>";c.M("bM"+9.4R).1e=l};u eJ(1S){9.9I()};u eK(){9.eI();O;a 7N=c.M("bK"+9.4R);7N.d.2i="30";9.bI=L};u eL(){O;R(a i=0;i<7K.G;i++){a 7N=c.M("bK"+1K(7K[i]).4R);7N.d.2i="30";1K(7K[i]).bI=L}};u 8k(l){a k=c.M("Z"+9.b).12;k.c.eP("4S/3M","C");a 6E="<9L id=\'bN\' 9M=\'"+9.X+"eQ.45\' 3H=\'4S/45\' 4T=\'eR\' />";a 9N="";if(9.76!=""){a 3P=1p(9.6p).2S(/<eS[^>]*>/ig);if(!3P){9N=9.5s+"<3y><7O><5F eT=\\""+9.76+"\\"/>"+6E+9.b2+"</7O><2z>"+"</2z></3y>"}}H{9N=9.5s+"<3y><7O>"+6E+9.b2+"</7O><2z>"+"</2z></3y>"}k.c.6V(9N);k.c.eU();k.c.1f.1e=l;k.c.1f.3J=E;a me=9;k.c.5G("eV",1k 2F("bO("+9.b+")"),E);k.c.5G("eW",u(e){bP(e,me.b)},E);k.c.5G("eX",1k 2F("a e=eY[0];bQ(1K(e), "+9.b+")"),L);if(9.1D.G>0){a N=k.c.43("6F");k.c.5H.1o[0].5I(N);a 2I="";R(a i=0;i<9.1D.G;i++){9O=9.1D[i][0];d=9.1D[i][3];2I+=9O+" { "+d+" } "}N.5I(k.c.bR(2I))}if(9.45!=""){a 9P=k.c.43("eZ");9P.9M=9.45;9P.4T="jM";k.c.5H.1o[0].5I(9P)}9.46()};u 74(l,jN){a k=c.M("Z"+9.b).12;a 3P=1p(l).2S(/<!jO[^>]*>/ig);if(3P)R(a i=0;i<3P.G;i++){9.5s=3P[i]}H 9.5s="";a 9Q=1p(l).2S(/<3y[^>]*>/ig);if(9Q)R(a i=0;i<9Q.G;i++){s=9Q[i];s=s.C(/\\"[^\\"]*\\"/ig,u(x){x=x.C(/&/g,"&2P;").C(/</g,"&lt;").C(/>/g,"&gt;").C(/\'/g,"&f0;").C(/\\s+/ig,"#36#");O x});s=s.C(/<([^ >]*)/ig,u(x){O x.2s()});s=s.C(/ ([^=]+)=([^" >]+)/ig," $1=\\"$2\\"");s=s.C(/ ([^=]+)=/ig,u(x){O x.2s()});s=s.C(/#36#/ig," ");9.3M=s}H 9.3M="<3M>";if(9.76!=""){a 3P=l.2S(/<eS[^>]*>/ig);if(!3P){l="<5F eT=\\""+9.76+"\\"/>"+l}}9.45="";a 9R=1p(l).2S(/<9L[^>]*>/ig);if(9R)R(a i=0;i<9R.G;i++){a s=9R[i];a 2J=s.3D("9M=\\"");if(2J.G>1){s=2J[1];2J=s.3D("\\"");if(2J.G>1)9.45=2J[0]}}a 9S=0,9T=l.G;a 1I=l.2S(/<1f[^>]*>/i);if(1I){9S=l.1H(1I[0])+1I[0].G}1I=l.2S(/<\\/1f>/i);if(1I){9T=l.1H(1I[0])}a 2V=l.1N(0,9S)+"</3M>";a 6x=l.1N(9S,9T);a f1=l.3d(9T);a 6E="<9L id=\'bN\' 9M=\'"+9.X+"eQ.45\' 3H=\'4S/45\' 4T=\'eR\' />";if(2V.2S(/<2V>/gi)){2V=2V.C(/<2V>/gi,"<2V>"+6E)}H{2V=2V.C(/<1f/gi,"<2V>"+6E+"</2V><1f")}k.c.eP("4S/3M","C");k.c.6V(2V+f1);k.c.eU();k.c.1f.1e=6x;k.c.1f.3J=E;a me=9;k.c.5G("eV",1k 2F("bO("+me.b+")"),E);k.c.5G("eW",u(e){bP(e,me.b)},E);k.c.5G("eX",1k 2F("a e=eY[0];bQ(1K(e), "+9.b+")"),L);9.46()};u aA(l){9.74(l,E)};u 7P(l){O l.C(/&/g,"&2P;").C(/</g,"&lt;").C(/>/g,"&gt;")};u 7Q(l){a h=l.C(/<br 52="bm" \\/>/gi,"").C(/<br 52="bm">/gi,"");a 7R=h.2S(/<9L[^>]*>/ig);if(7R){R(a i=0;i<7R.G;i++){if(7R[i].1H("bN")!=-1){h=h.C(1k cG(7R[i],"gi"),"")}}}O h};u az(){a k=c.M("Z"+9.b).12;O k.c.1f.jP};u 5X(){a k=c.M("Z"+9.b).12;9.46();l=3T(k.c.5H);l=1p(l).C(/ 3J=\\"E\\"/gi,"");l=1p(l).C(/\\<9U 9V=\\"6G\\" 9W=\\"0\\">/ig,"<9U 9V=\\"6G\\" 9W=\\"-1\\">");l=9.5s+l;l=14.6Z(l);if(9.7y)l=7P(l);l=l.C(/\\9X+/gi," ");l=7Q(l);O l};u 5W(){a k=c.M("Z"+9.b).12;9.46();l=k.c.1f.1e;l=1p(l).C(/ 3J=\\"E\\"/gi,"");l=1p(l).C(/\\<9U 9V=\\"6G\\" 9W=\\"0\\">/ig,"<9U 9V=\\"6G\\" 9W=\\"-1\\">");l=14.6Z(l);if(9.7y)l=7P(l);l=l.C(/\\9X+/gi," ");l=7Q(l);O l};a 2A="";u 5Z(){a k=c.M("Z"+9.b).12;9.46();l=3T(k.c.5H);a 2J=l.2S(/<5F([^>]*)>/ig);if(2J!=1h)2A=2J[0];a 3U=k.c.2n("5F");if(3U.G!=1h){R(a i=0;i<3U.G;i++){3U[i].1y.6H(3U[i])}}2A=2A.C(/<([^ >]*)/ig,u(x){O x.2s()});2A=2A.C(/ [^=]+="[^"]+"/ig,u(x){x=x.C(/\\s+/ig,"#36#");x=x.C(/^#36#/," ");O x});2A=2A.C(/ ([^=]+)=([^" >]+)/ig," $1=\\"$2\\"");2A=2A.C(/ ([^=]+)=/ig,u(x){O x.2s()});2A=2A.C(/#36#/ig," ");2A=2A.C(/>$/ig," \\/>").C(/\\/ \\/>$/ig,"\\/>");l=7S(k.c.5H,"");l=9.5s+9.3M+l+"\\n</3M>";l=l.C(/<2V>/i,"<2V>"+2A);l=l.C(/\\9X+/gi," ");l=14.6Z(l);if(9.7y)l=7P(l);l=7Q(l);O l};u 5Y(){a k=c.M("Z"+9.b).12;9.46();l=3T(k.c.5H);a 2J=l.2S(/<5F([^>]*)>/ig);if(2J!=1h)2A=2J[0];a 3U=k.c.2n("5F");if(3U.G!=1h){R(a i=0;i<3U.G;i++){3U[i].1y.6H(3U[i])}}l=7S(k.c.1f,"");l=14.6Z(l);if(9.7y)l=7P(l);l=l.C(/\\9X+/gi," ");l=7Q(l);O l};u jQ(b){a 1X="";a 3B=c.M("3B"+b).12;R(a i=0;i<3B.c.7T[0].6I.G;i++){a 1P=3B.c.7T[0].6I[i].f2;if(1P!=9Y){2I=3B.c.7T[0].6I[i].d.9Z.C(/"/g,"&a0;");a a1=1P.3D(".").G;if(a1>1){6J=1P.3D(".")[1];1X+=",[\\""+1P+"\\",E,\\""+6J+"\\",\\""+2I+"\\"]"}H 1X+=",[\\""+1P+"\\",L,\\"\\",\\""+2I+"\\"]"}}a 1D=1K("["+1X.3d(1)+"]");if(1D.G>0){a k=c.M("Z"+b).12;a N=k.c.43("6F");k.c.5H.1o[0].5I(N);a 2I="";R(a i=0;i<1D.G;i++){9O=1D[i][0];d=1D[i][3].C(/&a0;/g,"\\"");2I+=9O+" { "+d+" } "}N.5I(k.c.bR(2I))}};u f3(b){a k=c.M("Z"+b).12;a 1X="";R(a j=0;j<k.c.7T.G;j++){a 3B=k.c.7T[j];R(a i=0;i<3B.6I.G;i++){1P=3B.6I[i].f2;if(1P!=9Y){if(1P.2S(/1q\\./gi)){a2}2I=3B.6I[i].d.9Z.C(/"/g,"&a0;");a a1=1P.3D(".").G;if(a1>1){6J=1P.3D(".")[1];1X+=",[\\""+1P+"\\",E,\\""+6J+"\\",\\""+2I+"\\"]"}H 1X+=",[\\""+1P+"\\",L,\\"\\",\\""+2I+"\\"]"}}}a 1D=1K("["+1X.3d(1)+"]");a 21=1K(b);R(a i=0;i<1D.G;i++){R(a j=0;j<21.1D.G;j++){if(1D[i][0].2s()==21.1D[j][0].2s()){1D[i][1]=21.1D[j][1]}}}21.1D=1D};u f4(b,3a){a k=c.M("Z"+b).12;a J=k.1d();1K(b).1F();a 1g;if(14.41){1g=14.41;1g.3e=3a}H{1g=1Q(J);if(7U(J)){if(J!=""){1K(b).8o([],3a)}H{if(1g.1c=="2z")O;1g.3e=3a}}H{if(1g.1c=="2z")O;1g.3e=3a}}2O(1K(b))};u 7r(){if(!9.aZ)f3(9.b);9.aZ=E;a 2H=c.M("2H"+9.b);if(2H.1e!=""){if(2H.d.2i=="")2H.d.2i="30";H 2H.d.2i="";O}2H.d.2i="";a h=c.M("Z"+9.b).bS-27;a 1D=9.1D;a l="";l+="<3A 1u=1n d=\'2j:bT;2j-2Q:0;2j-4K:0\' 2x=\'5D\'>";l+="<1q d=\'2j:1a;2j-2Q:bL;2j-4c:jR;1m:9K;1i:9K;1Y:#33;\' 2o=0 2p=0 1u=1n>"+"<17><Y 3C=\\""+9.b+".7r();\\" 4O=\\"9.d.1t=\'#eN 1a 1J\';9.d.1z=\'3K\';9.d.2y=\'jS\'\\" 5B=\\"9.d.1t=\'3K 1a 1J\';9.d.1z=\'bU\';9.d.2y=\'\'\\" d=\\"2R:3i;1C:1a;1t:3K 1a 1J;2c-4g:6A;2c-1G:7G;1z:#4h;35-1i:6D;\\" 2x=4Q 4J=2Q 1u=1n>x</Y></17>"+"</1q>";a bV="";R(a i=0;i<1D.G;i++){1P=1D[i][0];if(1P=="1f")bV=1D[i][3]}l+="<3A 1u=1n d=\'9q:dN;1m:jT;1i:"+h+"3V;\'>";l+="<1q 5z=\'bW"+9.b+"\' id=\'bW"+9.b+"\' 2o=0 2p=0 d=\'1Y:#jU;"+bV+";1i:1Z%;1m:1Z%;2j:0;\'>";R(a i=0;i<1D.G;i++){1P=1D[i][0];f5=1D[i][1];2I=1D[i][3];6J=1D[i][2];if(f5){if(1P.3D(".").G>1){a bX=1P;if(1P.1H(":")>0)bX=1P.1N(0,1P.1H(":"));l+="<17 d=\\"2R:3i\\" 4O=\\"if(9.d.a3!=\'1a\'){9.d.1Y=\'"+9.aB+"\';9.d.1z=\'"+9.aC+"\'}\\" 5B=\\"if(9.d.a3!=\'1a\'){9.d.1Y=\'\';9.d.1z=\'\'}\\">";l+="<Y 1u=1n 3C=\\"f4(\'"+9.b+"\',\'"+bX.3D(".")[1]+"\')\\" d=\'1C:bL\'>";if(1P.3D(".")[0]=="")l+="<2e 1u=1n d=\\""+2I+";2j:0;\\">"+6J+"</2e>";H l+="<2e 1u=1n d=\\""+2I+";2j:0;\\">"+1P+"</2e>";l+="</Y></17>"}}}l+="<17><Y 1i=1Z%>&2U;</Y></17></1q></3A>";l+="</3A>";c.M("2H"+9.b).1e=l};u 8m(){a k=c.M("Z"+9.b).12;a a4=k.c.1f.2n("bY");if(a4.G==0)O L;a f;a D;3f(a4.G>0){f=a4[0];if(f.bZ&&f.1o.G==1&&f.1o[0].1T==1&&f.1o[0].2k=="2q"){a 1L=f.1o[0];a5(1L,f);D=k.c.2D();D.2E(f);D.5J(1L);D.2E(f);D.8j()}H if(f.1y.2k=="2q"&&f.1y.1o.G==1){a 1L=f.1y;a5(1L,f);1L.1e=f.1e}H{a 1M=k.c.43("2q");a5(1M,f);1M.1e=f.1e;f.1y.a6(1M,f)}}O E};u 4y(1U,3b){a k=c.M("Z"+9.b).12;if(1U.G==0)O L;a f;a D;3f(1U.G>0){f=1U[0];if(f.bZ&&f.1o.G==1&&f.1o[0].1T==1&&f.1o[0].2k=="2q"){a 1L=f.1o[0];if(3b=="4U")1L.d.a7="4U";if(3b=="4V")1L.d.a8="4V";if(3b=="35-4i")1L.d.4W="35-4i";if(3b=="3l")1L.d.4W="3l";D=k.c.2D();D.2E(f);D.5J(1L);D.2E(f);D.8j()}H if(f.1y.2k=="2q"&&f.1y.1o.G==1){a 1L=f.1y;if(3b=="4U")1L.d.a7="4U";if(3b=="4V")1L.d.a8="4V";if(3b=="35-4i")1L.d.4W="35-4i";if(3b=="3l")1L.d.4W="3l";1L.1e=f.1e}H{a 1M=k.c.43("2q");if(3b=="4U")1M.d.a7="4U";if(3b=="4V")1M.d.a8="4V";if(3b=="35-4i")1M.d.4W="35-4i";if(3b=="3l")1M.d.4W="3l";1M.1e=f.1e;f.1y.a6(1M,f)}}O E};u 4z(f6,f7){a k=c.M("Z"+9.b).12;a 1U=k.c.1f.2n(f6);3f(1U.G>0){f=1U[0];a 1M=k.c.43(f7);1M.1e=f.1e;f.1y.a6(1M,f)}};u 46(){a k=c.M("Z"+9.b).12;a 1U;1U=k.c.1f.2n("B");9.4y(1U,"4U");1U=k.c.1f.2n("I");9.4y(1U,"4V");1U=k.c.1f.2n("f8");9.4y(1U,"35-4i");1U=k.c.1f.2n("S");9.4y(1U,"35-4i");1U=k.c.1f.2n("U");9.4y(1U,"3l");9.4z("f9","44");9.4z("fa","44");9.4z("jV","44");9.4z("jW","97");9.4z("fb","2q");1U=k.c.1f.2n("jX");3f(1U.G>0){a f=1U[0];5K=f.1y;5K.6H(f)}9.8m();9.8l();O E};u 8o(3W,3a,3m){a 3X="2q";if(3m!=1h&&3m!="")3X=3m;a k=c.M("Z"+9.b).12;a J=k.1d();a D;a N;if(!7U(J)){D=J.2a(0);N=1Q(J);if(N.2k==3X)O N;O}9.1j();9.1R("fc","6A");N=1Q(J);N.d.c0="";fd(k,3W,3a,3X);2O(9)};u 8n(){9.1F();if(14.41)a 1g=14.41;H{a k=c.M("Z"+9.b).12;a J=k.1d();1g=1Q(J);if(7U(J)){if(J!=""){a D=J.2a(0);if(1g.1e!=D.5L()){9.1R(\'79\');2O(9);O}}H{if(1g.1c=="2z")O}}H{if(1g.1c=="2z")O}}1g.3n("3e");1g.3n("d");if(1g.1c=="91"||1g.1c=="92"||1g.1c=="93"||1g.1c=="94"||1g.1c=="95"||1g.1c=="96"||1g.1c=="97"||1g.1c=="P"||1g.1c=="44"){9.1R(\'c1\',\'<P>\')}9.1R(\'79\');2O(9)};u 8l(){a c2=L;a k=c.M("Z"+9.b).12;a av=/<\\s*2q\\s*>/gi;3f(E){a 4j=k.c.2n("2q");if(4j.G==0)q;a 6K=[];R(a i=0;i<4j.G;i++){if(4j[i].3e=="cI-d-2e")4j[i].3n("52",0);if(4j[i].d.9Z=="")4j[i].3n("d",0);if(3T(4j[i]).7V(av)==0)6K[6K.G]=4j[i]}if(6K.G==0)q;a 1L,5K;R(a i=0;i<6K.G;i++){1L=6K[i];5K=1L.1y;if(!5K)a2;if(1L.bZ()){a D=k.c.2D();D.ax(1L);a 3o=D.fe();5K.a6(3o,1L)}H{5K.6H(1L)}c2=E}}O c2};u ff(1M,3W,3a){if(3W){R(a i=0;i<3W.G;i++){1M.d[3W[i][0]]=3W[i][1]}if(1M.d.9Z=="")1M.3n("d",0)}if(3a)1M.3e=3a};u a5(1M,f){if((f.c3!=1h)&&(f.c3!=""))1M.d.c0=f.c3;if((f.1G!=1h)&&(f.1G!="")){a 2l="";if(f.1G==1)2l="7W";H if(f.1G==2)2l="a9";H if(f.1G==3)2l="aa";H if(f.1G==4)2l="ab";H if(f.1G==5)2l="ac";H if(f.1G==6)2l="ad";H if(f.1G>=7)2l="ae";H if(f.1G<=-2||f.1G=="0")2l="7W";H if(f.1G=="-1")2l="a9";H if(f.1G==0)2l="aa";H if(f.1G=="+1")2l="ab";H if(f.1G=="+2")2l="ac";H if(f.1G=="+3")2l="ad";H if(f.1G=="+4"||f.1G=="+5"||f.1G=="+6")2l="ae";H 2l="";if(2l!="")1M.d.c4=2l}if((f.d.2y!=1h)&&(f.d.2y!=""))1M.d.2y=f.d.2y;if((f.1z!=1h)&&(f.1z!=""))1M.d.1z=f.1z;if((f.3e!=1h)&&(f.3e!=""))1M.3e=f.3e};u fd(k,3W,3a,3m){a 3X="2q";if(3m!=1h&&3m!="")3X=3m;a J=k.1d();a bi=1Q(J);if(3W||3a)ff(bi,3W,3a)};u bO(F){if(F.7X){jY(F.7X);F.7X=1h}if(!F.7X)F.7X=fg(u(){2O(F)},jZ)};u bP(e,b){a 21=1K(b);a c5=c.M("Z"+b);14.41=1h;14.b=b;14.k=c5.12;14.11=21;21.1j();if(e.3Y&&e.3Y.1c&&e.3Y.1c==\'af\'){a J=c5.12.1d();a D=J.2a(0);J.2t();D.ax(e.3Y);D.k0(e.3Y);J.2u(D)}2O(21)};u 4X(21){14.b=21.b;14.k=c.M("Z"+21.b).12;14.11=21};a 2J=[];u c6(N,fh){3f(N!=1h&&N.1c!=fh){if(N.1c=="2z")O 1h;N=N.1y}O N};a 5M=[];u 2O(21){2K{a b=21.b;a k=c.M("Z"+b).12;a J=k.1d();a 1g=1Q(J);a 11=21;a 1l=11.1l;a V=1h;if(11.6f){a V=1l.1E["by"+b];a 6L=7Y[V.k1];6L.7Z("bz"+b,E);6L.7Z("bA"+b,E);6L.7Z("7H"+b,E);a 4k=c6(1g,"80");if(4k){6L.7Z("7H"+b,L);V.1B(1)}H V.1B(5);a 4l=c6(1g,"fi");if(4l){6L.7Z("7H"+b,E)}}a 1r=k.c;if(11.4D){V=1l.1E["4D"+b];V.1B(1r.2r("c1")?1:5)}if(11.4E){V=1l.1E["4E"+b];V.1B(1r.2r("7b")?1:5)}if(11.4F){V=1l.1E["4F"+b];V.1B(1r.2r("7c")?1:5)}if(11.49){V=1l.1E["49"+b];V.1B(!11.3N[0]?5:1)}if(11.4a){V=1l.1E["4a"+b];V.1B(!11.7u[0]?5:1)}if(11.5d){V=1l.1E["5d"+b];V.1B(1r.2r("3s")?(1r.2m("3s")?4:1):5)}if(11.5e){V=1l.1E["5e"+b];V.1B(1r.2r("3t")?(1r.2m("3t")?4:1):5)}if(11.5f){V=1l.1E["5f"+b];V.1B(1r.2r("3u")?(1r.2m("3u")?4:1):5)}if(11.5g){V=1l.1E["5g"+b];V.1B(1r.2r("3v")?(1r.2m("3v")?4:1):5)}if(11.5h){V=1l.1E["5h"+b];V.1B(1r.2r("3w")?(1r.2m("3w")?4:1):5)}if(11.5i){V=1l.1E["5i"+b];V.1B(1r.2r("3L")?(1r.2m("3L")?4:1):5)}if(11.5j){V=1l.1E["5j"+b];V.1B(1r.2r("c7")?(1r.2m("c7")?4:1):5)}if(11.5k){V=1l.1E["5k"+b];V.1B(1r.2r("fj")?(1r.2m("fj")?4:1):5)}if(11.69){V=1l.1E["69"+b];V.1B(1r.2r("62")?(1r.2m("62")?4:1):5)}if(11.6a){V=1l.1E["6a"+b];V.1B(1r.2r("63")?(1r.2m("63")?4:1):5)}if(11.6b){V=1l.1E["6b"+b];V.1B(1r.2r("64")?(1r.2m("64")?4:1):5)}if(11.6c){V=1l.1E["6c"+b];V.1B(1r.2r("65")?(1r.2m("65")?4:1):5)}if(11.5l){V=1l.1E["5l"+b];V.1B(1r.2r("57")?1:5)}if(11.5m){V=1l.1E["5m"+b];V.1B(1r.2r("58")?1:5)}if(11.5n){V=1l.1E["5n"+b];V.1B(1g.31?(1g.31.2s()=="bf"?4:1):1)}if(11.5o){V=1l.1E["5o"+b];V.1B(1g.31?(1g.31.2s()=="fk"?4:1):1)}a v=(1g?1:5);if(11.6d)1l.1E["6d"+b].1B(v);if(11.6e)1l.1E["6e"+b].1B(v);if(11.5q)1l.1E["5q"+b].1B(v);2K{14.8e()}2L(e){}2K{11.8e()}2L(e){}a 2H=c.M("2H"+b);if(2H.1e!=""){a N;if(14.41)N=14.41;H N=1Q(J);a fl=N.3e;a 4m=c.M("bW"+b).23;R(a i=0;i<4m.G-1;i++){6M=4m[i].1o[0].1o[0].1e;if(6M.3D(".").G>1&&6M!="")6M=6M.3D(".")[1];if(fl==6M){4m[i].d.a3="1a";4m[i].d.2y=11.aB;4m[i].d.1z=11.aC}H{4m[i].d.a3="";4m[i].d.2y="";4m[i].d.1z=""}}}if(11.7v){N=1g;a l="";a i=0;5M=[];3f(N!=1h&&N.1c!="2z"&&N.1T==1){5M[i]=N;l="&2U; &lt;<2e id=1b"+b+i+" 1u=1n d=\'4S-ag:3l;2R:c8\' 3C=\\""+b+".7w("+i+")\\">"+N.1c+"</2e>&gt;"+l;N=N.1y;i++}l="&2U;&lt;2z&gt;"+l;c.M("c9"+b).1e=l;c.M("ah"+b).d.2i="30";R(i=0;i<5M.G;i++){c.M("1b"+b+i).5G("dr",1k 2F(b+".7w("+i+")"),E)}}}2L(e){}};u fm(b){a k=c.M("Z"+b).12;a fn=k.c.fo("7b");a 2d=1K(b);a 6N=L;R(a i=0;i<2d.4I.G;i++){if(fn==2d.4I[i]){6N=E;q}}if(6N){7Y["9x"+b].fp("ea"+i+b,E)}H{7Y["9x"+b].fq()}};u fr(b){a k=c.M("Z"+b).12;a fs=k.c.fo("7c");a 2d=1K(b);a 6N=L;R(a i=0;i<2d.5r.G;i++){if(fs==2d.5r[i][1]){6N=E;q}}if(6N){7Y["9y"+b].fp("eb"+i+b,E)}H{7Y["9y"+b].fq()}};u 6r(){a 2B=c.M("5y"+9.b);a ca=2B.k2-90;a be=9.X.1N(0,9.X.1H("3r/"))+9.2w;a ft="<1q 1u=1n fu=\'"+9.b+".6r()\' 1m=\'1Z%\' 2o=0 2p=0 d=\'1t:#6v 1a 1J;1t-4c:30\'><17 d=\'1Y-1z:#33;2c-4g:fv;2c-1G:7G;1z:bU;\'>"+"<Y id=c9"+9.b+" d=\'1C:1a;1m:"+ca+"3V\' 4J=2Q>&2U;</Y>"+"<Y 2x=4K 4J=\'4Q\' 5E>"+"<2e id=ah"+9.b+" 1u=1n d=\'fw-2x:fx;2i:30;4S-ag:3l;2R:c8;1C-4K:bT;\' 3C=\'"+9.b+".7x()\'>"+K("bE fy")+"</2e>"+"</Y></17></1q>";a fz="<1q 1u=1n fu=\'"+9.b+".6r()\' 1m=\'1Z%\' 2o=0 2p=0 d=\'1t-5D:#6v 1a 1J;1t-4K:#6v 1a 1J;\'><17 d=\'1Y-1z:#33;2c-4g:fv;2c-1G:7G;1z:bU;\'>"+"<Y id=c9"+9.b+" d=\'1C:1a;1m:"+ca+"3V\' 4J=2Q>&2U;</Y>"+"<Y 2x=4K 4J=\'4Q\' 5E>"+"<2e id=ah"+9.b+" 1u=1n d=\'fw-2x:fx;2i:30;4S-ag:3l;2R:c8;1C-4K:bT;\' 3C=\'"+9.b+".7x()\'>"+K("bE fy")+"</2e>"+"</Y></17></1q>";a cb=c.M("dM"+9.b);a cc=c.M("dL"+9.b);a cd=c.M("dP"+9.b);a ce=c.M("dO"+9.b);if(9.5t=="2Q"){cb.1e="";cd.1e=fz;cc.d.2i="30";ce.d.2i="";9.5t="4c"}H{cb.1e=ft;cd.1e="";cc.d.2i="";ce.d.2i="30";9.5t="2Q"}};u 7w(i){if(!9.7v)O;a k=c.M("Z"+9.b).12;a D=k.c.2D();D.2E(5M[i]);a J=k.1d();J.2t();J.2u(D);5N=5M[i];if(5N.1c!="fi"&&5N.1c!="fA"&&5N.1c!="fB"&&5N.1c!="k3")c.M("ah"+9.b).d.2i="";R(a j=0;j<5M.G;j++)c.M("1b"+9.b+j).d.1Y="";c.M("1b"+9.b+i).d.1Y="k4";if(5N)14.41=5N;9.28()};u 7x(){9.1F();a k=c.M("Z"+9.b).12;a J=k.1d();a 1g=1Q(J);a cf=1g.81==1h?(1g.fC==1h?1g.1y:1g.fC):1g.81;4L(1g.2k){z"80":;z"af":;z"fD":;z"fE":;z"fF":1g.1y.6H(1g);q;3i:J=k.1d();a D=J.2a(0);a 3o=D.cg(1g.1e);D.2E(1g);D.8j();D.5J(3o);2K{k.c.4w="1n"}2L(e){}q}J=k.1d();J.2t();a D=k.c.2D();D.72(cf,0);D.ai(cf,0);J.2u(D);9.28();2O(9)};u 1R(3E,fG){if(3E=="3s"||3E=="3t"||3E=="3u"||3E=="3v"||3E=="3w"||3E=="3L"||3E=="57"||3E=="58"||3E=="fH")9.1F();a k=c.M("Z"+9.b).12;k.c.6O("ch",L,E);k.c.6O(3E,L,fG);2O(9)};u 55(6W,82){9.1j();9.28();a k=c.M("Z"+9.b).12;9.1F();if(82!=1h&&82!=""){k.c.6O("ch",L,E);k.c.6O(6W,L,82);a 2h=k.1d();a D=2h.2a(0);if(D.2v.1T==2C.3Z){a el=D.2v.81;if(el){D=k.c.2D();D.2E(el);2h=k.1d();2h.2t();2h.2u(D)}}}H{a el=1Q(k.1d());if(6W=="61"){el.d.1z=""}H if(6W=="dC"){el.d.2y=""}}2O(9);if(82=="")O};u 8p(4n){a k=c.M("Z"+9.b).12;a J=k.1d();9.1j();9.1F();9.1R("c1",4n)};u 8q(4n){9.1j();9.1F();a k=c.M("Z"+9.b).12;a J=k.1d();a N=1Q(J);if(N!=1h&&N.1c=="2q"){N.d.c0=4n}H{9.1R("fc",4n)}};u 8r(4n){9.1j();9.1F();a k=c.M("Z"+9.b).12;a J=k.1d();a N=1Q(J);if(N!=1h&&N.1c=="2q"){N.d.c4=ci(4n)}H{9.1R("k5",4n);J=k.1d();N=1Q(J);if(N!=1h)N.d.c4=ci(4n)}2O(9)};u ci(v){a s="7W";if(v==1)s="7W";H if(v==2)s="a9";H if(v==3)s="aa";H if(v==4)s="ab";H if(v==5)s="ac";H if(v==6)s="ad";H if(v>=7)s="ae";H if(v<=-2||v=="0")s="7W";H if(v=="-1")s="a9";H if(v==0)s="aa";H if(v=="+1")s="ab";H if(v=="+2")s="ac";H if(v=="+3")s="ad";H if(v=="+4"||v=="+5"||v=="+6")s="ae";O s};u 47(4o,3c){a k=c.M("Z"+9.b).12;a J=k.1d();a N=1Q(J);a 1r=k.c;if(N!=1h&&N.1c=="2q"){if(4o=="3s"||4o=="3t"||4o=="3u"||4o=="3v"||4o=="3w"||4o=="3L"){9.1F();4L(4o){z"3s":N.d.a7=(!1r.2m("3s")?"4U":"");q;z"3t":N.d.a8=(!1r.2m("3t")?"4V":"");q;z"3u":N.d.4W=(!1r.2m("3u")?"3l":"");q;z"3v":N.d.4W=(!1r.2m("3v")?"35-4i":"");q;z"3w":N.d.fI=(!1r.2m("3w")?"k6":"");q;z"3L":N.d.fI=(!1r.2m("3L")?"k7":"");q}2O(9)}}H{9.1R(4o,3c)}};u 8s(){9.1F();9.1R("k8");9.1l.1E["5j"+9.b].1B(1);a k=c.M("Z"+9.b).12;a J=k.1d();a N=1Q(J);3f(N!=1h&&N.1c!="cj"&&N.1c!="ck"){if(N.1c=="2z")O;N=N.1y}N.3n("3H",0);N.d.fJ=""};u 8t(){9.1F();9.1R("c7");9.1l.1E["5k"+9.b].1B(1);a k=c.M("Z"+9.b).12;a J=k.1d();a N=1Q(J);3f(N!=1h&&N.1c!="cj"&&N.1c!="ck"){if(N.1c=="2z")O;N=N.1y}N.3n("3H",0);N.d.fJ=""};u 8u(){9.1F();9.1R("62")};u 8v(){9.1F();9.1R("63")};u 8w(){9.1F();9.1R("64")};u 8x(){9.1F();9.1R("65")};u 8y(){9.1F();a k=c.M("Z"+9.b).12;a J=k.1d();a 1S=1Q(J);if(1S.31)1S.3n("31");H 1S.31="bf";9.28()};u 8z(){9.1F();a k=c.M("Z"+9.b).12;a J=k.1d();a 1S=1Q(J);if(1S.31)1S.3n("31");H 1S.31="fk";9.28()};u 8C(fK){9.75(9.7s[fK][1]);9.1j();9.28()};u 77(){a k=c.M("Z"+9.b).12;a J=k.1d();a D=J.2a(0);if(D.2v.1T==2C.3Z){if(D.5L()==""){a 4p=D.3h;a 6P=D.aj;a ak=D.2v;a 15=ak.3p;4p=15.1N(0,D.3h).7V(/(\\W+\\w*)$/i);4p=4p==-1?0:4p;a cl=15.1N(4p,D.3h).7V(/\\w+/i);4p+=(cl==-1?15.1N(4p,D.3h).G:cl);6P=15.3d(D.aj).7V(/\\W+/i);6P=6P==-1?15.G:6P+D.aj;D=k.c.2D();D.72(ak,4p);D.ai(ak,6P);J=k.1d();J.2t();J.2u(D)}}O};u 8D(){a k=c.M("Z"+9.b).12;a J=k.1d();a cm=1Q(J);if(cm){if(J.2a(0).5L()==""){a N=cm;3f(N!=1h&&N.1c!="91"&&N.1c!="92"&&N.1c!="93"&&N.1c!="94"&&N.1c!="95"&&N.1c!="96"&&N.1c!="97"&&N.1c!="P"&&N.1c!="44"){if(N.1c=="2z")O;N=N.1y}a D=k.c.2D();D.2E(N);J=k.1d();J.2t();J.2u(D)}}};u 75(l){a k=c.M("Z"+9.b).12;a J=k.1d();a D=J.2a(0);9.1F();a 3o=D.cg(l);D.3I(L);a 6Q=3o.1o[3o.1o.G-1];D.5J(3o);if(6Q.1T==2C.3Z){D=k.c.2D();D.72(6Q,6Q.3p.G);D.ai(6Q,6Q.3p.G);J=k.1d();J.2t();J.2u(D)}};u aW(2G,6R,3Y,4T){a k=c.M("Z"+9.b).12;a J=k.1d();a D=J.2a(0);9.1F();a 5O=L;if(D.5L()==""){if(D.2v.1T==2C.83){if(D.2v.1o[D.3h].1T!=2C.3Z){if(D.2v.1o[D.3h].2k=="71")5O=E;H 5O=L}H{5O=E}}H{5O=E}if(5O){a cn=(6R!=""&&6R!=1h?6R:2G);a 1s=k.c.bR(cn);D.5J(1s);2K{k.c.4w="1n"}2L(e){}D=k.c.2D();D.72(1s,0);D.ai(1s,cn.G);J=k.1d();J.2t();J.2u(D)}}a fL=(D.2v.1T==2C.3Z)&&(D.3h>0);k.c.6O("ch",L,E);k.c.6O("k9",L,2G);J=k.1d();D=J.2a(0);if(D.2v.1T==2C.3Z){a 1s=(5O||!fL?D.2v.1y:D.2v.81);D=k.c.2D();D.2E(1s);J=k.1d();J.2t();J.2u(D)}a 1S=D.2v.1o[D.3h];if(1S){if(3Y!=""&&3Y!=9Y)1S.3Y=3Y;if(4T!=""&&4T!=9Y)1S.ka("4T",4T)}};u 8B(){if(kb(K("kc fM kd fM ke kf kg 70 kh?"))==E){9.1F();a k=c.M("Z"+9.b).12;k.c.1f.1e="<71>";k.28()}};u aD(3m){a 3X="2q";if(3m!=1h&&3m!="")3X=3m;a k=c.M("Z"+9.b).12;a J=k.1d();a D;a N;a l;if(!7U(J)){D=J.2a(0);N=1Q(J);if(N.2k==3X)O N;O}D=J.2a(0);l=D.5L();a 3o=D.fe();a 84=k.c.43(3X);84.5I(3o);D.5J(84);2K{k.c.4w="1n"}2L(e){}D=k.c.2D();D.2E(84);J=k.1d();J.2t();J.2u(D);O 84};u 8A(){a k=c.M("Z"+9.b).12;a J=k.1d();a 1S=1Q(J);9.1F();if(1S!=1h&&1S.2k!="2z"){if(1S.d.6S=="al")1S.d.6S="";H 1S.d.6S="al"}};u ek(el){a 4l=el;a 4k=4l.1y.1y.1y;a 85=4l.1y.fN;a 87=4l.fO;a 23=4k.23;a 88=23[23.G-1].1o[0];88.1e="<3A 2x=4K>"+(85*1+1)+" x "+(87*1+1)+" "+K("2Z ki 9w")+" ...  &2U;&2U;&2U;<2e d=\'4S-ag:3l\'>"+K("2Z kj ej")+"</2e>&2U;</3A>";88.d.2y="";88.d.1z="#4h";88.d.1t="1A";R(a i=0;i<23.G-1;i++){a 4q=23[i];R(a j=0;j<4q.1o.G;j++){a 5P=4q.1o[j];if(i<=85&&j<=87)5P.d.2y="#kk";H 5P.d.2y="#4P"}}};u eo(el){a 4k=el;if(4k.2k!="80")O;a 23=4k.23;23[23.G-1].1o[0].1e=K("9B 2Z 6h");R(a i=0;i<23.G-1;i++){a 4q=23[i];R(a j=0;j<4q.1o.G;j++){a 5P=4q.1o[j];5P.d.2y="#4P"}}};u 9b(){a 4k=c.M("bw"+9.b);a 23=4k.23;23[23.G-1].1o[0].1e=K("9B 2Z 6h");R(a i=0;i<23.G-1;i++){a 4q=23[i];R(a j=0;j<4q.1o.G;j++){a 5P=4q.1o[j];5P.d.2y="#4P"}}};u 9a(el){9.1j();a k=c.M("Z"+9.b).12;a 4l=el;a 85=4l.1y.fN+1;a 87=4l.fO+1;9.1F();a l="<1q d=\'1t-3I:3I;1m:1Z%;\' 89=\'89\'>";R(a i=1;i<=85;i++){l+="<17>";R(a j=1;j<=87;j++){l+="<Y><br/></Y>"}l+="</17>"}l+="</1q>";a J=k.1d();a D=J.2a(0);D.3I(E);a 3o=D.cg(l);D.5J(3o);2K{k.c.4w="1n"}2L(e){}a 8a=k.c.2n("80");R(a i=0;i<8a.G;i++){if(8a[i].kl("89")=="89"){D=k.c.2D();D.2E(8a[i]);J=k.1d();J.2t();J.2u(D);8a[i].3n("89");q}}2O(9)};u bQ(3g,11){if(!11.3N[0]){11.1F()}if(3g.km){4L(3g.6T){z 86:if(11.dh){3g.kn();1x(11.X+"fP.18",am,7I)}H{a 4r=c.M("Z"+11.b).12;a J=4r.1d();a D=J.2a(0);4r.c.1f.3J=L;a 3q=4r.c.M("3q");if(!3q){3q=c.43("3A");3q.id="3q";3q.d.6S="al";3q.d.5D="-ko";3q.3J=E;4r.c.1f.5I(3q)}3q.28();2f.fg(u(){a 15=11.9d();a 4r=c.M("Z"+11.b).12;4r.c.1f.3J=E;4r.c.1f.28();a J=4r.1d();J.2t();J.2u(D);11.75(15)},1Z)}q}}if(3g.6T==37||3g.6T==38||3g.6T==39||3g.6T==40){11.1F()}if(3g.6T==13){11.1F()}11.cP()};u 8E(){a k=c.M("Z"+9.b).12;a 2B=c.M("5y"+9.b);9.1j();if(9.8F){9.dt();9.8F=L;c.1f.d.9q="";c.M("9o").d.2j="1A";2B.d.6S="";2B.d.2Q="1A";2B.d.5D="1A";if(9.1m.5L().1H("%")!=-1)2B.d.1m=9.1m;H 2B.d.1m=4Y(9.1m)+"3V";if(9.1i.5L().1H("%")!=-1)2B.d.1i=9.1i;H 2B.d.1i=4Y(9.1i)+"3V";R(a i=0;i<14.2W.G;i++){if(14.2W[i]!=9.b){c.M("5y"+14.2W[i]).d.2i="";2K{c.M("Z"+14.2W[i]).12.c.4w="1n"}2L(e){}}}}H{9.ds();9.8F=E;2f.kp(0,0);c.1f.d.9q="kq";c.M("9o").d.2j="kr";2B.d.6S="al";2B.d.2Q="1A";2B.d.5D="1A";2B.d.1m=2f.ks+"3V";2B.d.1i=2f.kt+"3V";2B.d.ku=kv;R(a i=0;i<14.2W.G;i++){if(14.2W[i]!=9.b)c.M("5y"+14.2W[i]).d.2i="30"}k.28()}2K{k.c.4w="1n"}2L(e){}a 2H=c.M("2H"+9.b);2H.1e=""};u 1x(2G,1m,1i,p,3c){co(2G,1m,1i,L,p,3c)};u 4Z(2G,1m,1i,p,3c){co(2G,1m,1i,E,p,3c)};u co(2G,fQ,hg,fR,p,3c){a id="kw"+(1k kx()).ky();a f=1k dX(id);f.2w=14.X.1N(0,14.X.1H("3r/"))+"cQ/";f.9G({1m:fQ+"3V",1i:hg+"3V",kz:fR,4Q:E,2G:2G,kA:p,kB:3c})};u 1j(){kC();9.2X.1j();9.2Y.1j();if(9.6f)9.9b()};u 5Q(1b){6U=["\\n","",""];if(1b=="A"||1b=="B"||1b=="kD"||1b=="kE"||1b=="kF"||1b=="bY"||1b=="I"||1b=="kG"||1b=="f8"||1b=="kH"||1b=="fS"||1b=="kI"||1b=="kJ"||1b=="U"||1b=="kK"||1b=="S"||1b=="kL"||1b=="fb"||1b=="kM"||1b=="kN"||1b=="2q"||1b=="af")6U=["","",""];if(1b=="42"||1b=="80"||1b=="kO"||1b=="fB"||1b=="fA"||1b=="cj"||1b=="ck"||1b=="f9"||1b=="fa"||1b=="fE"||1b=="fF"||1b=="kP"||1b=="kQ"||1b=="7O"||1b=="2z"||1b=="3y")6U=["\\n","","\\n"];if(1b=="6F"||1b=="cp")6U=["\\n","",""];if(1b=="71"||1b=="fT")6U=["","\\n",""];O 6U};u kR(s){s=1p(s).C(/&/g,"&2P;");s=1p(s).C(/</g,"&lt;");s=1p(s).C(/"/g,"&a0;");O s};u fU(s){s=1p(s).C(/&/g,"&2P;");s=1p(s).C(/</g,"&lt;");a x=kS(s);x=kT(x.C(/\\%kU/gi,"-*fV*-"));s=x.C(/-\\*fV\\*-/gi,"&2U;");O s};u 7S(1S,an){a l="";R(a i=0;i<1S.1o.G;i++){a 26=1S.1o[i];if(26.1T==1){a 1v=26.2k;a cq=L;if(1v.1N(0,1)=="/"){cq=E}H{a 1O=an;l+=5Q(1v)[0];if(5Q(1v)[0]!="")l+=1O}if(cq){}H if(1v=="kV"||1v=="fW"){s=3T(26);s=s.C(/\\"[^\\"]*\\"/ig,u(x){x=x.C(/&/g,"&2P;").C(/</g,"&lt;").C(/>/g,"&gt;").C(/\'/g,"&f0;").C(/\\s+/ig,"#36#").C(/&2P;2P;/gi,"&2P;");O x});s=s.C(/<([^ >]*)/ig,u(x){O x.2s()});s=s.C(/ ([^=]+)=([^"\' >]+)/ig," $1=\\"$2\\"");s=s.C(/ ([^=]+)=/ig,u(x){O x.2s()});s=s.C(/#36#/ig," ");s=s.C(/<ao([^>]*)>/ig,"\\n<ao$1 />").C(/\\/ \\/>$/ig," \\/>");if(1v=="fW")if(26.1e=="")s=s.C(/>$/ig," \\/>").C(/\\/ \\/>$/ig,"\\/>");s=s.C(/<ao 5z=\\"6G\\" 6s=\\"0\\" \\/>/,"<ao 5z=\\"6G\\" 6s=\\"-1\\" \\/>");l+=s}H if(1v=="kW"){l+="<6R>"+26.1e+"</6R>"}H{if(1v=="cr"){a fX=26.cs;a fY=26.ct}a fZ=26.kX(L);s=3T(fZ).C(/<\\/[^>]*>/,"");if(1v=="6F"){a 2J=s.2S(/<[^>]*>/ig);s=2J[0]}s=s.C(/\\"[^\\"]*\\"/ig,u(x){x=x.C(/&/g,"&2P;").C(/&2P;2P;/g,"&2P;").C(/</g,"&lt;").C(/>/g,"&gt;").C(/\\s+/ig,"#36#");O x});s=s.C(/<([^ >]*)/ig,u(x){O x.2s()});s=s.C(/ ([^=]+)=([^" >]+)/ig," $1=\\"$2\\"");s=s.C(/ ([^=]+)=/ig,u(x){O x.2s()});s=s.C(/#36#/ig," ");s=s.C(/(<hr[^>]*)(g0="")/ig,"$kY=\\"g0\\"");s=s.C(/(<9r[^>]*)(g1="")/ig,"$kZ=\\"g1\\"");s=s.C(/(<l0[^>]*)(g2="")/ig,"$l1=\\"g2\\"");s=s.C(/(<l2[^>]*)(l3="")/ig,"$l4=\\"E\\"");s=s.C(/(<9r[^>]*)(g3="")/ig,"$l5=\\"g3\\"");s=s.C(/(<9r[^>]*)(g4="")/ig,"$l6=\\"g4\\"");s=s.C(/(<Y[^>]*)(5E="" )/ig,"$g5=\\"5E\\" ");s=s.C(/(<Y[^>]*)(5E=""\\>)/ig,"$g5=\\"5E\\"\\>");s=s.C(/ l7=\\"E\\"/ig,"");if(1v=="cr"){s=s.C(/ cs=\\"0,0,0,0\\"/ig," cs=\\""+fX+"\\"");s=s.C(/ ct=\\"l8\\"/ig," ct=\\""+fY+"\\"")}a cu=E;if(1v=="af"||1v=="71"||1v=="cr"||1v=="fT"||1v=="fD"||1v=="5F"||1v=="eZ"){s=s.C(/>$/ig," \\/>").C(/\\/ \\/>$/ig,"\\/>");cu=L}l+=s;if(1v!="42")l+=5Q(1v)[1];if(1v!="42")if(5Q(1v)[1]!="")l+=1O;if(cu){s=3T(26);if(1v=="cp"){s=s.C(/<3G([^>]*)>[\\n+\\s+\\t+]*/ig,"<3G$1>");s=s.C(/[\\n+\\s+\\t+]*<\\/3G>/ig,"<\\/3G>");s=s.C(/<3G([^>]*)>\\/\\/<!\\[g6\\[/ig,"");s=s.C(/\\/\\/\\]\\]><\\/3G>/ig,"");s=s.C(/<3G([^>]*)>/ig,"");s=s.C(/<\\/3G>/ig,"");s=s.C(/^\\s+/,\'\').C(/\\s+$/,\'\');l+="\\n"+1O+"//<![g6[\\n"+1O+s+"\\n"+1O+"//]]>\\n"+1O}if(1v=="6F"){s=s.C(/<d([^>]*)>[\\n+\\s+\\t+]*/ig,"<d$1>");s=s.C(/[\\n+\\s+\\t+]*<\\/d>/ig,"<\\/d>");s=s.C(/<d([^>]*)><!--/ig,"");s=s.C(/--><\\/d>/ig,"");s=s.C(/<d([^>]*)>/ig,"");s=s.C(/<\\/d>/ig,"");s=s.C(/^\\s+/,"").C(/\\s+$/,"");l+="\\n"+1O+"<!--\\n"+1O+s+"\\n"+1O+"-->\\n"+1O}if(1v=="44"||1v=="P"){if(26.1e==""||26.1e=="&2U;"){l+="&2U;"}H l+=7S(26,1O+"\\t")}H if(1v=="6F"||1v=="cp"){}H{l+=7S(26,1O+"\\t")}if(1v!="42")l+=5Q(1v)[2];if(1v!="42")if(5Q(1v)[2]!="")l+=1O;l+="</"+1v.2s()+">"}}}H if(26.1T==3){l+=fU(26.3p).C(/^[\\t\\r\\n\\v\\f]*/,"").C(/[\\t\\r\\n\\v\\f]*$/,"")}H if(26.1T==8){if(3T(26).1N(0,2)=="<"+"%"){1X=(3T(26).1N(2));1X=1X.1N(0,1X.G-2);1X=1X.C(/^\\s+/,"").C(/\\s+$/,"");a 1O=an;l+="\\n"+1O+"<%\\n"+1O+1X+"\\n"+1O+"%>\\n"+1O}H{a 1O=an;1X=26.3p;1X=1X.C(/^\\s+/,"").C(/\\s+$/,"");l+="\\n"+1O+"<!--\\n"+1O+1X+"\\n"+1O+"-->\\n"+1O}}H{}}O l};u 1Q(2h){a D=2h.2a(0);a 1s=D.2v;if(1s.1T==2C.83){if(D.3h>=1s.1o.G)O 1s;1s=1s.1o[D.3h]}if(1s.1T==2C.3Z){if(1s.3p.G==D.3h){a el=1s.81;if(el&&el.1T==2C.83){if(D.cv.1T==2C.3Z&&D.cv.3p.G==D.aj){if(el==D.cv.1y){O el}}}}3f(1s!=1h&&1s.1T!=2C.83){1s=1s.1y}}O 1s};u 7U(2h){a D=2h.2a(0);if(D!=1h&&D.2v!=1h){O(D.2v.1T==2C.3Z)}O L};u 3T(1s){a l="";4L(1s.1T){z 2C.83:l="<"+1s.2k;a cw="";R(a 4s=0;4s<1s.5R.G;4s++){if(1s.5R[4s].2k.3d(0,4)=="g7")a2;if(1s.5R[4s].3p.3d(0,4)=="g7")a2;if(1s.2k==\'42\'&&1s.5R[4s].2k.2s()==\'6s\'){cw=1s.5R[4s].3p}H{l+=\' \'+1s.5R[4s].2k+\'="\'+1s.5R[4s].3p+\'"\'}}l+=\'>\';l+=(1s.2k!=\'42\'?1s.1e:cw);l+="</"+1s.2k+">";q;z 2C.l9:l="<!"+"--"+1s.3p+"--"+">";q;z 2C.3Z:l=1s.3p;q}O l};u bc(Q,id,2d,ap){a e=2d,aq=ap,V=id.1N(0,id.g8(aq));4L(V){z"59":e.dq();q;z"7d":e.8E();q;z"7e":e.28();c.M("Z"+2d.b).12.la();q;z"7f":e.1j();1x(e.X+"7V.18",lb,cF);q;z"7g":e.1j();if(e.9c=="b5");H if(e.9c=="lc")ld("Z"+2d.b);q;z"d7":e.1R("aK");q;z"d8":e.1R("aL");q;z"49":e.98();q;z"4a":e.99();q;z"5d":e.47("3s");q;z"5e":e.47("3t");q;z"5f":e.47("3u");q;z"5g":e.47("3v");q;z"5h":e.47("3w");q;z"5i":e.47("3L");q;z"69":e.8u();q;z"6a":e.8v();q;z"6b":e.8w();q;z"6c":e.8x();q;z"5j":e.8t();q;z"5k":e.8s();q;z"5l":e.1R("57");q;z"5m":e.1R("58");q;z"5n":e.8y();q;z"5o":e.8z();q;z"6d":e.2X.9G(c.M(id));q;z"6e":e.2Y.9G(c.M(id));q;z"7i":e.1j();1x(e.X+"le.18",lf,lg);q;z"7h":e.1j();1x(e.X+"lh.18",bx,li);q;z"7j":e.1j();1x(e.X+"lj.18",lk,ll);q;z"7k":e.1j();1x(e.X+"lm.18",cx,ln);q;z"7p":e.1j();1x(e.X+"lo.18",cx,lp);q;z"7l":e.1j();1x(e.X+"lq.18",cx,lr);q;z"6j":e.1j();1K(e.aU);q;z"6k":e.1j();1K(e.aV);q;z"6m":e.1j();1K(e.aY);q;z"6l":e.1j();1K(e.aX);q;z"d9":e.ls(E);q;z"7q":e.1j();1x(e.X+"lu.18",lv,lw);q;z"7m":e.8A();q;z"8W":e.1j();1x(e.X+"lx.18",ly,lz);q;z"5q":e.1R("fH");q;z"7o":e.8n();q;z"8X":4X(2d);e.1j();4Z(e.X+"lA.18",8b,ar);q;z"8Y":4X(2d);e.1j();4Z(e.X+"lB.18",8b,ar);q;z"4G":4X(2d);e.1j();4Z(e.X+"lC.18",8b,ar);q;z"4H":4X(2d);e.1j();4Z(e.X+"lD.18",8b,ar);q;z"8Z":e.8B();q;z"8V":e.1j();e.7r();q;z"4D":e.1j();e.8D();q;z"4E":e.1j();e.77();fm(e.b);q;z"4F":e.1j();e.77();fr(e.b);q;z"5p":e.1j();q;3i:R(a i=0;i<e.3x.G;i++){if(e.3x[i][0]==V){1K(e.3x[i][1]);q}}}};u 3R(Q,id,2d,ap){a aq=ap;a e=2d;a V=id.1N(0,id.g8(aq));4L(V){z"e1":4X(2d);4Z(e.X+"cy.18",lE,lF);q;z"e2":4X(2d);4Z(e.X+"cy.18",lG,8b);q;z"e3":4X(2d);4Z(e.X+"cy.18",lH,lI);q;z"5a":1x(e.X+"lJ.18",lK,lL);q;z"4C":1x(e.X+"lM.18",lN,lO);q;z"5b":1x(e.X+"lP.18",lQ,lR);q;z"5c":1x(e.X+"7N.18",lS,lT);q;z"66":1x(e.X+"lU.18",lV,bD);q;z"67":1x(e.X+"lW.18",g9,ga);q;z"lX":1x(e.X+"es.18",7I,9C);q;z"lY":1x(e.X+"et.18",eu,ew);q;z"lZ":1x(e.X+"ex.18",ey,bD);q;z"m0":1x(e.X+"ez.18",3S,6X);q;z"m1":1x(e.X+"eB.18",3S,9C);q;z"m2":1x(e.X+"eC.18",3S,eD);q;z"m3":1x(e.X+"eE.18",3S,eF);q;z"m4":1x(e.X+"eG.18",3S,6X);q;z"bz":1x(e.X+"m5.18",m6,m7);q;z"bA":1x(e.X+"m8.18",am,g9);q;z"7H":1x(e.X+"m9.18",ma,ga);q;z"6g":1x(e.X+"mb.18",am,7I);q;z"68":1x(e.X+"fP.18",am,7I);q}a 4t=0;if(V.1H("4C")!=-1){}H if(V.1H("4D")!=-1){4t=V.3d(V.1H("36")+1);e.8p("<"+e.6n[4Y(4t)][1]+">")}H if(V.1H("4E")!=-1){4t=V.3d(V.1H("36")+1);e.8q(e.4I[4Y(4t)])}H if(V.1H("4F")!=-1){4t=V.3d(V.1H("36")+1);e.8r(e.5r[4Y(4t)][1])}H if(V.1H("5p")!=-1){4t=V.3d(V.1H("36")+1);e.8C(4Y(4t))}};u 7z(v){a cH=1p(9.1i);a 21=c.M("5y"+9.b);if(cH.1H("%")>-1){cH=21.1o[0].bS-21.23[0].mc[0].1o[0].bS-(9.7v?20:0)}if(!9.gb)9.gb=4Y(cH,10);a gc=4Y(cH,10)+v;9.1i=gc+"3V";21.d.1i=9.1i};u 9d(){a k=c.M("Z"+9.b).12;a 8c=k.c.M("3q");a as=8c.2n("*");R(a i=0;i<as.G;i++){as[i].3n("52");as[i].3n("d")}a 15=8c.1e;8c.1y.6H(8c);15=1p(15).C(/<\\\\?\\?md[^>]*>/g,"");15=1p(15).C(/<\\/?o:p[^>]*>/g,"");15=1p(15).C(/<\\/?mf:p[^>]*>/gi,"");15=1p(15).C(/<\\/?v:[^>]*>/g,"");15=1p(15).C(/<\\/?o:[^>]*>/g,"");15=1p(15).C(/<\\/?mg:[^>]*>/g,"");15=1p(15).C(/<\\/?w:mh[^>]*>/gi,"");15=1p(15).C(/<\\/?w:mi[^>]*>/gi,"");15=1p(15).C(/&2U;/g,"");15=1p(15).C(/<\\/?2q[^>]*>/g,"");15=1p(15).C(/<\\/?bY[^>]*>/g,"");15=1p(15).C(/<\\/?fS[^>]*>/g,"");15=1p(15).C(/<\\/?91[^>]*>/g,"");15=1p(15).C(/<\\/?92[^>]*>/g,"");15=1p(15).C(/<\\/?93[^>]*>/g,"");15=1p(15).C(/<\\/?94[^>]*>/g,"");15=1p(15).C(/<\\/?95[^>]*>/g,"");15=1p(15).C(/<\\/?96[^>]*>/g,"");15=1p(15).C(/<\\/?P[^>]*><\\/P>/g,"");15=1p(15).C(/<!--\\[if[^>]*>/gi,"");15=1p(15).C(/<!--\\[gd\\]-->/gi,"");15=1p(15).C(/<!\\[gd\\]-->/gi,"");O 15}',62,1383,'|||||||||this|var|oName|document|style|||||||oEditor|sHTML|||||break||||function|||||case|||replace|range|true|oEdt|length|else||oSel|getTxt|false|getElementById|oElement|return||tb|for||gif||btn||scriptPath|td|idContent||obj|contentWindow||oUtil|str||tr|htm||1px|tag|tagName|getSelection|innerHTML|body|element|null|height|hide|new|tbar|width|on|childNodes|String|table|doc|node|border|unselectable|sTagName|addButton|modelessDialogShow|parentNode|color|0px|setState|padding|arrStyle|btns|saveForUndo|size|indexOf|tmp|solid|eval|theSpan|newSpan|substring|sT|sSelector|getSelectedElement|doCmd|oEl|nodeType|elements|sContent|sPreloadHTML|sTmp|background|100||edtObj||rows|||oNode||focus||getRangeAt|addItem|font|edt|span|window|oEdit|sel|display|margin|nodeName|nSize|queryCommandState|getElementsByTagName|cellpadding|cellspacing|SPAN|queryCommandEnabled|toLowerCase|removeAllRanges|addRange|startContainer|iconPath|align|backgroundColor|BODY|sBaseHREF|edtArea|Node|createRange|selectNode|Function|url|idStyles|sCssText|arrTmp|try|catch|txt|mode|realTime|amp|top|cursor|match|addToggleButton|nbsp|head|arrEditor|oColor1|oColor2|Table|none|dir||f4f4f4|sHTMLColor|line|_||||sClassName|sVal|opt|substr|className|while|evt|startOffset|default|addDropdownButton|ISDropdown|underline|blockTag|removeAttribute|docFrag|nodeValue|pasteArea|saf|Bold|Italic|Underline|Strikethrough|Superscript|arrCustomButtons|HTML|onClick|div|myStyle|onclick|split|sCmd|oScripts|script|type|collapse|contentEditable|white|Subscript|html|arrUndoList|event|arrA|pvDD|ddAction|235|getOuterHTML|arrBase|px|arrStyles|useBlock|target|TEXT_NODE||activeElement|TEXTAREA|createElement|DIV|css|cleanDeprecated|applyFormattingStyle|buttonMap|btnUndo|btnRedo|Size|bottom|tmpTb|colspan|ddFmt|family|000000|through|allSpans|oTable|oTD|oRows|val|cmd|sPos|oRow|mainEditor|atr|idx|src|tselector|designMode|wnd|cleanTags|replaceTags|customColors|BRK|btnParagraphFormatting|btnParagraph|btnFontName|btnFontSize|btnXHTMLFullSource|btnXHTMLSource|arrFontName|valign|right|switch|ddTable|sdd|onmouseover|ffffff|center|oRenderName|text|rel|bold|italic|textDecoration|setActiveEditor|parseInt|modalDialogShow|editor|bInside|class|allText|nd|applyColor|features|Indent|Outdent|btnSave|btnTextFormatting|btnListFormatting|btnBoxFormatting|btnBold|btnItalic|btnUnderline|btnStrikethrough|btnSuperscript|btnSubscript|btnNumbering|btnBullets|btnIndent|btnOutdent|btnLTR|btnRTL|btnCustomTag|btnLine|arrFontSize|docType|TagSelectorPosition|idTextArea|listA|tmpGrp|orTb|idArea|name|sZ|onmouseout|Edit|left|nowrap|BASE|addEventListener|documentElement|appendChild|insertNode|theParent|toString|arrTmp2|oActiveElement|emptySel|oCol|lineBreak1|attributes|sSrc|innovaeditor|objStyle|iconHeight|getHTMLBody|getHTML|getXHTMLBody|getXHTML|Paste|ForeColor|JustifyLeft|JustifyCenter|JustifyRight|JustifyFull|btnCssText|btnCssBuilder|btnPasteText|btnJustifyLeft|btnJustifyCenter|btnJustifyRight|btnJustifyFull|btnForeColor|btnBackColor|btnTable|btnPasteWord|Insert|groups|btnContentBlock|btnInternalLink|btnCustomObject|btnInternalImage|arrParagraph|Heading|preloadHTML|originalContent|moveTagSelector|value|sButtonName|Colors|cfcfcf|resizeInit|cnt|Formatting|generateHTML|verdana|ddTblEdit|arrColors|9px|defaultEditCss|STYLE|Play|removeChild|cssRules|sCaption|emptySpans|ddTbl|sClass|found|execCommand|ePos|lastNode|title|position|keyCode|arrReturn|write|sType|174|spcChar|replaceSpecialChar|all|BR|setStart|RENDER|loadHTMLFull|insertHTML|publishingPath|expandSelection|Image|RemoveFormat|Paragraph|FontName|FontSize|btnFullScreen|btnPrint|btnSearch|btnSpellCheck|btnHyperlink|btnBookmark|btnImage|btnFlash|btnMedia|btnAbsolute|btnForm|btnRemoveFormat|btnYoutubeVideo|btnAutoTable|openStyleSelect|arrCustomTag|doUndoRedo|arrRedoList|useTagSelector|selectElement|removeTag|encodeIO|changeHeight|XHTMLBody|dvId|oForm|onPickColor|ddCustomTag|777777|10px|mnuCellEdit|280|ddForm|arrColorPickerObjects|sName|sParent|box|HEAD|encodeHTMLCode|cleanHTML|sMatch|recur|styleSheets|isTextSelected|search|8pt|tmKeyup|isDDs|enableItem|TABLE|nextSibling|sColor|ELEMENT_NODE|idSpan|nRow||nCol|custCell|selThis|allTabs|600|idSource|langDir|onSelectionChanged|spcCharCode|edtCnt|REPLACE|parent|deleteContents|loadHTML|cleanEmptySpan|cleanFonts|doClean|applySpanStyle|applyParagraph|applyFontName|applyFontSize|applyBullets|applyNumbering|applyJustifyLeft|applyJustifyCenter|applyJustifyRight|applyJustifyFull|applyBlockDirLTR|applyBlockDirRTL|makeAbsolute|clearAll|insertCustomTag|selectParagraph|fullScreen|stateFullScreen|Search|Undo|Redo|Bookmark|Hyperlink|Flash|Media|YoutubeVideo|Characters|Line|Form|Styles|Numbering|Bullets|btnPreview|btnStyles|btnCharacters|btnHTMLFullSource|btnHTMLSource|btnClearAll||H1|H2|H3|H4|H5|H6|PRE|doUndo|doRedo|doClick_TabCreate|doRefresh_TabCreate|spellCheckMode|fixWord|listB|onsubmit_original|HTMLBody|XHTML|onMoreColor|onRemoveColor|txtCustomColors|Custom|txtMoreColors|grpMap|id_refresh_z_index|iframe|overflow|input|screenX|screenY|isWindow|resizeOffset|Text|ddFontName|ddFontSize|Justify|f3f3f8|Advanced|177|btnSource|View|Source|show|hideAll|refreshCustomColor|13px|14px|link|href|hdr|selector|objL|arrB|arrExtCss|p1|p2|PARAM|NAME|VALUE|u00A0|undefined|cssText|quot|itemCount|continue|marginRight|allFonts|copyAttribute|replaceChild|fontWeight|fontStyle|10pt|12pt|14pt|18pt|24pt|36pt|IMG|decoration|idElCommand|setEnd|endOffset|startCont|absolute|400|sTab|param|sfx|oN|450|allTags|setEdit|bOnLoadReplaced|reg|checkFocus|selectNodeContents|setFocus|getTextBody|putHTML|styleSelectionHoverBg|styleSelectionHoverFg|applySpan|iconWidth|ColorPicker|Save|FullScreen|Preview|Print|Cut|Copy|BackColor|AutoTable|Absolute|XHTMLSource|StyleAndFormatting|btnPaste|tabs|toolbarMode|cmdContentBlock|cmdInternalLink|insertLink|cmdCustomObject|cmdInternalImage|isCssLoaded|Arial|Lucida|headContent|isContentChanged|iwe_btnSubmit|ieSpell|bOnSubmitOriginalSaved|oTextArea|onsubmit|bBtnExists|onShow|More|tbAction|buildToolbar|icPath|ltr||edtStr|elm|currentResized|onload|onload_original|innova|btnMap|ddPar|ddFont|ddFs||Left|Right|add|ISCustomDDItem|dropTableCreate|380|btnTableEdit|mnuTableSize|mnuTableEdit|arrFormMenu|Field|332|Remove|sCbName|sCbCaption|sCbImage|isActive|currColor|dropColor|2px|idCustomColor|tmp_xxinnova|editorDoc_onkeyup|editorDoc_onmouseup|doKeyPress|createTextNode|offsetHeight|5px|black|sBody|tblStyles|tmpSelector|FONT|hasChildNodes|fontFamily|FormatBlock|bReturn|face|fontSize|edtFrm|GetElement|InsertOrderedList|pointer|idElNavigate|nWidth|selTop|selTopRow|selBottom|selBottomRow|nearElement|createContextualFragment|styleWithCSS|mapFontSize|OL|UL|tPos|selParent|cap|windowOpen|SCRIPT|bDoNotProcess|AREA|coords|shape|bClosingTag|endContainer|tagVal|340|preview|InnovaEditorUtil|US|LanguageDirectory|scriptPathLang|scr|ipt|163|RegExp||Apple|InnovaEditor|getComputedStyle|currentStyle|iwe_focus|init|initISEditor|onKeyPress|icons|iwe_getElm|SpellCheck|PasteWord|PasteText|ContentBlock|InternalLink|InternalImage|CustomObject|Guidelines|HTMLFullSource|HTMLSource|XHTMLFullSource|ClearAll|CustomTag|LTR|RTL|btnCut|btnCopy|btnGuidelines|grpEdit|grpFont|grpPara|grpInsert|grpTables|grpMedia|showResizeBar|pasteTextOnCtrlV|Normal|Style|Gothic|Sans|MS|New|Roman|serif|onSave|click|onFullScreen|onNormalScreen|alert|caption|here|||onsubmit_new|bUseFeature|sHTMLDropMenus|HiliteColor|Object|createToolbar|btnWidth|btnHeight|eTab|createTbGroup|grp|addGroup|idTagSelTopRow|idTagSelTop|auto|idTagSelBottomRow|idTagSelBottom|resize|onEditorStartResize|join|onmousemove|onEditorResize|onmouseup|onEditorStopResize|ISWindow|push|onload_new|ddPreview|btnPreview1|btnPreview2|btnPreview3|Full|ddFormatting|List|CSS|ddParagraph|Font|btnFontName_|btnFontSize_|ddPaste|bullet|To|ddForeColor|Color|ddBackColor|Internal|Link|doOver_TabCreate||20px||doOut_TabCreate|444444|ddTableEdit|Cell|form_form|form_text|285||289|form_list|295|form_check|Button|form_radio|form_hidden|152|form_file|132|form_button|oParent|onHide|showColorPicker|hideColorPicker|hideColorPickerAll|drawColorPicker|708090|455|open|default_edit|stylesheet|base|HREF|close|keyup|mouseup|keydown|arguments|LINK|apos|foot|selectorText|ApplyExternalStyle|doApplyStyle|isOnSelection|sFrom|sTo|STRIKE|DIR|MENU|BASEFONT|fontname|replaceWithSpan|extractContents|copyStyleClass|setTimeout|sMatchTag|TD|InsertUnorderedList|rtl|sCurrClass|realtimeFontSelect|sFontName|queryCommandValue|selectItem|clearSelection|realtimeSizeSelect|sFontSize|sTagSelTop|ondblclick|arial|vertical|middle|Tag|sTagSelBottom|TR|TBODY|previousSibling|INPUT|FORM|SELECT|sOption|InsertHorizontalRule|verticalAlign|listStyleImage|index|isSelInMidText|you|rowIndex|cellIndex|paste_text|wd|ov|STRONG|HR|fixVal|REPL|EMBED|sCoords|sShape|oNode2|noshade|checked|multiple|readonly|disabled|1nowrap|CDATA|_moz|lastIndexOf|430|445|minHeight|newHeight|endif|Array|scripts|language|editor_lang||useSelection|activeModalWin|169|copy|pound|233|eacute|201|Eacute|8364||euro|8220|fromCharCode|initializeEditor|typeof|object|editorarea|insertBefore|edtWin|start|createEvent|TextEvent|initTextEvent|textInput|dispatchEvent|contentDocument|Body|cccccc|700px|350px|dropTopAdjustment_moz|dropLeftAdjustment_moz|useLastForeColor|useLastBackColor|stateForeColor|stateBackColor|getElm|tabHome|Home|tabStyle|cmdAssetManager|cmdFileManager|cmdImageManager|cmdMediaManager|cmdFlashManager|Preformatted|Black|Narrow|Book|Antiqua|Bookman|Old|Century|Comic|Courier|Franklin|Medium|Garamond||Georgia|Impact|Console|Unicode|Modern|Monotype|Corsiva|Palatino|Linotype|Script||Small|Fonts|Symbol|Tahoma|Times|Trebuchet|Verdana|Webdings|Wingdings|sans|cursive|fantasy|monospace|initialRefresh|CustomName1|CustomName2|ISToolbarManager|cloneRange|form|sHTMLIcons|color_picker_fg|color_picker_bg|hilitecolor|toolbar|main_istoolbar|createTbTab|tabCtl|addTab|render|cntContainer|frameborder|no|blank|idResizeBar|resize_bar|onmousedown|submit|SUBMIT|onselectstart|ondragstart|showOverlay|hideOverlay|addSeparator|addBreak|640x480|800x600|1024x768||Screen|||Check|Spelling|btnStyleAndFormat|btnStyle|Box|btnCustomCss||Builder|btnStyleSelect|Selection|btnParagraph_|4px||Name|tahoma|from|Word|btnLeft|btnCenter|Center|btnRight|btnFull|btnNumber|btnList|Foreground|btnInsertForeColor|Background|btnInsertBackColor|Tags|btnCustomTag_|Content|Block|175|cancelBubble|d3d3d3|table_insert|btnInsertTable|btnTableSize|btnEditTable|btnEditCell|btnSymbol|Special|Checkbox|Radio|Hidden|File|Editor|btnDelete|Clear|All|color_picker|800000|8b4513|006400|2f4f4f|000080|4b0082|800080|ff0000|daa520|6b8e23|0000cd|483d8b|c71585|696969|ff4500|ffa500|808000|4682b4|1e90ff|9400d3|ff1493|a9a9a9||ff6347|ffd700|32cd32|87ceeb|00bfff|9370db|ff69b4|dcdcdc|ffdab9|ffffe0|98fb98|e0ffff|87cefa|e6e6fa|dda0dd|145px|117px|16px|moreColTd|StyleSheet|firstLoad|DOCTYPE|textContent|ApplyCSS|3px|9FA7BB|200px|fcfcfc|CENTER|XMP|APPLET|clearTimeout|1000|setEndAfter|ddId|offsetWidth|LI|DarkGray|fontsize|super|sub|InsertUnOrderedList|CreateLink|setAttribute|confirm|Are|sure|wish|to|delete|contents|Dimension|Advance|316ac5|getAttribute|ctrlKey|preventDefault|1000px|scroll|hidden|70px|innerWidth|innerHeight|zIndex|2000|ID|Date|getTime|overlay|openerWin|options|hideAllDD|CITE|CODE|EM|SMALL|BIG|SUB|SUP|SAMP|VAR|KBD|TT|THEAD|MAP|DL|fixAttr|escape|unescape|A0|OBJECT|TITLE|cloneNode|1noshade|1checked|select|1multiple|option|selected|1selected|1readonly|1disabled|contenteditable|RECT|COMMENT_NODE|print|375|NetSpell|checkSpellingById|bookmark|245|216|hyperlink|220|image|440|351|flash|275|youtube_video|125|media|272|runtimeBorder||table_format|320|225|characters|495|160|source_html_full|source_html|source_xhtml_full|source_xhtml|640|480|800|1024|768|text1|511|490|paragraph|460|284|list|305|335|498|395|styles_cssText|360|styles_cssText2|btnForm0|btnForm1|btnForm2|btnForm3|btnForm4|btnForm5|btnForm6|btnForm7|table_size|240|282|table_edit|table_editCell|431|paste_word|cells|xml||u1|st1|wrap|anchorlock'.split('|'),0,{}))

var editor = new Array();
var oUtil = new InnovaEditorUtil();
function InnovaEditorUtil() {
	this.langDir = "en-US";
	try {
		if (LanguageDirectory) this.langDir = LanguageDirectory
	} catch(e) {}
	var oScripts = document.getElementsByTagName("script");
	for (var i = 0; i < oScripts.length; i++) {
		var sSrc = oScripts[i].src.toLowerCase();
		if (sSrc.indexOf("saf/editor.js") != -1) {
			this.scriptPath = oScripts[i].src.replace(/editor.js/, "")
		} else if (sSrc.indexOf("scripts/innovaeditor.js") != -1) {
			if (!this.scriptPath) this.scriptPath = oScripts[i].src.replace(/innovaeditor.js/, "") + "saf/"
		}
	}
	this.scriptPathLang = this.scriptPath.replace(/\/saf/, "") + "language/" + this.langDir + "/";
	if (this.langDir == "en-US") document.write("<scr" + "ipt src='" + this.scriptPathLang + "editor_lang.js'></scr" + "ipt>");
	this.oName;
	this.oEditor;
	this.obj;
	this.oSel;
	this.sType;
	this.bInside = bInside;
	this.useSelection = true;
	this.arrEditor = [];
	this.onSelectionChanged = function () {
		return true
	};
	this.activeElement;
	this.activeModalWin;
	this.setEdit = setEdit;
	this.bOnLoadReplaced = false;
	this.spcCharCode = [[169, "&copy;"], [163, "&pound;"], [174, "&reg;"], [233, "&eacute;"], [201, "&Eacute;"], [8364, "&euro;"], [8220, "\""]];
	this.spcChar = [];
	for (var i = 0; i < this.spcCharCode.length; i++) {
		this.spcChar[i] = [new RegExp(String.fromCharCode(this.spcCharCode[i][0]), "g"), this.spcCharCode[i][1]]
	}
	this.replaceSpecialChar = function (sHTML) {
		for (var i = 0; i < this.spcChar.length; i++) {
			sHTML = sHTML.replace(this.spcChar[i][0], this.spcChar[i][1])
		}
		sHTML = sHTML.replace(/class="Apple-style-span"/gi, "");
		return sHTML
	};
	this.initializeEditor = function (tselector, opt) {
		var allText = [],
		txt,
		edtCnt;
		if (typeof(tselector) == "object" && tselector.tagName && tselector.tagName == "TEXTAREA") {
			allText[0] = tselector
		} else if (tselector.substr(0, 1) == "#") {
			txt = document.getElementById(tselector.substr(1));
			if (!txt) return;
			allText[0] = txt
		} else {
			var all = document.getElementsByTagName("TEXTAREA");
			for (var i = 0; i < all.length; i++) {
				if (all[i].className == tselector) {
					allText[allText.length] = all[i]
				}
			}
		}
		for (var i = 0; i < allText.length; i++) {
			txt = allText[i];
			if (txt.id || txt.id == "") txt.id = "editorarea" + i;
			edtCnt = document.createElement("DIV");
			edtCnt.id = "innovaeditor" + i;
			txt.parentNode.insertBefore(edtCnt, txt);
			window["oEdit" + i] = new InnovaEditor("oEdit" + i);
			var objStyle;
			if (window.getComputedStyle) {
				objStyle = window.getComputedStyle(txt, null)
			} else if (txt.currentStyle) {
				objStyle = txt.currentStyle
			} else {
				objStyle = {
					width: window["oEdit" + i].width,
					height: window["oEdit" + i].height
				}
			}
			window["oEdit" + i].width = objStyle.width;
			window["oEdit" + i].height = objStyle.height;
			if (opt) {
				for (var it in opt) {
					window["oEdit" + i][it] = opt[it]
				}
			}
			window["oEdit" + i].REPLACE(txt.id, "innovaeditor" + i)
		}
	}
};
function bInside(oElement) {
	while (oElement != null) {
		if (oElement.designMode && oElement.designMode == "on") return true;
		oElement = oElement.parentNode
	}
	return false
};
function checkFocus() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var parent = getSelectedElement(oSel);
	if (parent != null) {
		if (!bInside(parent)) return false
	} else {
		if (!bInside(parent)) return false
	}
	return true
};
function iwe_focus(type) {
	var oEditor = document.getElementById("idContent" + this.oName);
	if (oEditor) {
		oEditor = oEditor.contentWindow;
		oEditor.focus()
	}
	if (type && oEditor) {
		var edtWin;
		var range = oEditor.document.createRange();
		if (oEditor.document.body.childNodes.length > 0) {
			var nd = null;
			if (type == "start") {
				nd = oEditor.document.body.childNodes[0];
				range.selectNode(nd);
				range.collapse(true)
			} else {
				nd = oEditor.document.body.childNodes[oEditor.document.body.childNodes.length - 1];
				range.selectNode(nd);
				if (nd.nodeType == 1 && nd.tagName == "BR") {
					range.collapse(true)
				} else {
					range.collapse(false)
				}
			}
		} else {
			range.selectNodeContents(oEditor.document.body);
			range.collapse(false)
		}
		var sel = oEditor.getSelection();
		sel.removeAllRanges();
		sel.addRange(range);
		var evt = document.createEvent('TextEvent');
		evt.initTextEvent('textInput', true, true, window, ' ');
		oEditor.document.dispatchEvent(evt);
		range = sel.getRangeAt(0);
		range.setStart(range.startContainer, range.startOffset - 1);
		range.deleteContents();
		sel.removeAllRanges();
		sel.addRange(range)
	}
};
function setFocus(type) {
	this.focus(type)
};
function setEdit(oName) {
	if ((oName != null) && (oName != "")) {
		try {
			var wnd = document.getElementById("idContent" + oName);
			wnd.contentDocument.body.contentEditable = true;
			wnd.focus()
		} catch(e) {}
	} else {
		for (var i = 0; i < this.arrEditor.length; i++) {
			try {
				var wnd = document.getElementById("idContent" + this.arrEditor[i]).contentWindow;
				wnd.document.body.contentEditable = true;
				var r = wnd.getSelection().getRangeAt(0);
				r.selectNode(wnd.document.getElementsByTagName("Body")[0]);
				r.collapse(true);
				wnd.focus()
			} catch(e) {}
		}
	}
};
var iconHeight;
function InnovaEditor(oName) {
	this.oName = oName;
	this.init = initISEditor;
	this.RENDER = RENDER;
	this.loadHTML = loadHTML;
	this.loadHTMLFull = loadHTMLFull;
	this.getHTMLBody = getHTMLBody;
	this.getHTML = getHTML;
	this.getXHTMLBody = getXHTMLBody;
	this.getXHTML = getXHTML;
	this.getTextBody = getTextBody;
	this.putHTML = putHTML;
	this.css = "";
	this.onKeyPress = function () {
		return true
	};
	this.styleSelectionHoverBg = "#cccccc";
	this.styleSelectionHoverFg = "white";
	this.cleanEmptySpan = cleanEmptySpan;
	this.cleanFonts = cleanFonts;
	this.cleanTags = cleanTags;
	this.replaceTags = replaceTags;
	this.cleanDeprecated = cleanDeprecated;
	this.doClean = doClean;
	this.applySpanStyle = applySpanStyle;
	this.bInside = bInside;
	this.checkFocus = checkFocus;
	this.focus = iwe_focus;
	this.setFocus = setFocus;
	this.doCmd = doCmd;
	this.applyParagraph = applyParagraph;
	this.applyFontName = applyFontName;
	this.applyFontSize = applyFontSize;
	this.applyBullets = applyBullets;
	this.applyNumbering = applyNumbering;
	this.applyJustifyLeft = applyJustifyLeft;
	this.applyJustifyCenter = applyJustifyCenter;
	this.applyJustifyRight = applyJustifyRight;
	this.applyJustifyFull = applyJustifyFull;
	this.applyBlockDirLTR = applyBlockDirLTR;
	this.applyBlockDirRTL = applyBlockDirRTL;
	this.applySpan = applySpan;
	this.makeAbsolute = makeAbsolute;
	this.insertHTML = insertHTML;
	this.clearAll = clearAll;
	this.insertCustomTag = insertCustomTag;
	this.selectParagraph = selectParagraph;
	this.applyFormattingStyle = applyFormattingStyle;
	this.hide = hide;
	this.width = "700px";
	this.height = "350px";
	this.publishingPath = "";
	var oScripts = document.getElementsByTagName("script");
	for (var i = 0; i < oScripts.length; i++) {
		var sSrc = oScripts[i].src.toLowerCase();
		if (sSrc.indexOf("saf/editor.js") != -1) {
			this.scriptPath = oScripts[i].src.replace(/editor.js/, "");
			break
		} else if (sSrc.indexOf("innovaeditor.js") != -1) {
			this.scriptPath = oScripts[i].src.replace(/innovaeditor.js/, "saf/");
			break
		}
	}
	this.iconPath = "icons/";
	this.iconWidth = 29;
	this.iconHeight = 25;
	this.dropTopAdjustment_moz = 0;
	this.dropLeftAdjustment_moz = 0;
	this.applyColor = applyColor;
	this.customColors = [];
	this.oColor1 = new ColorPicker("oColor1", this.oName);
	this.oColor2 = new ColorPicker("oColor2", this.oName);
	this.expandSelection = expandSelection;
	this.useLastForeColor = false;
	this.useLastBackColor = false;
	this.stateForeColor = "";
	this.stateBackColor = "";
	this.fullScreen = fullScreen;
	this.stateFullScreen = false;
	this.getElm = iwe_getElm;
	this.features = [];
	this.buttonMap = ["Save", "FullScreen", "Preview", "Print", "Search", "SpellCheck", "Cut", "Copy", "Paste", "PasteWord", "PasteText", "Undo", "Redo", "ForeColor", "BackColor", "Bookmark", "Hyperlink", "Image", "Flash", "Media", "YoutubeVideo", "ContentBlock", "InternalLink", "InternalImage", "CustomObject", "Table", "AutoTable", "Guidelines", "Absolute", "Characters", "Line", "Form", "RemoveFormat", "HTMLFullSource", "HTMLSource", "XHTMLFullSource", "XHTMLSource", "ClearAll", "BRK", "StyleAndFormatting", "Styles", "CustomTag", "Paragraph", "FontName", "FontSize", "Bold", "Italic", "Underline", "Strikethrough", "Superscript", "Subscript", "JustifyLeft", "JustifyCenter", "JustifyRight", "JustifyFull", "Numbering", "Bullets", "Indent", "Outdent", "LTR", "RTL"];
	this.btnSave = false;
	this.btnPreview = true;
	this.btnFullScreen = true;
	this.btnPrint = false;
	this.btnSearch = true;
	this.btnSpellCheck = false;
	this.btnTextFormatting = true;
	this.btnListFormatting = true;
	this.btnBoxFormatting = true;
	this.btnParagraphFormatting = true;
	this.btnCssText = true;
	this.btnCssBuilder = false;
	this.btnStyles = false;
	this.btnParagraph = true;
	this.btnFontName = true;
	this.btnFontSize = true;
	this.btnCut = true;
	this.btnCopy = true;
	this.btnPaste = true;
	this.btnPasteText = false;
	this.btnUndo = true;
	this.btnRedo = true;
	this.btnBold = true;
	this.btnItalic = true;
	this.btnUnderline = true;
	this.btnStrikethrough = false;
	this.btnSuperscript = false;
	this.btnSubscript = false;
	this.btnJustifyLeft = true;
	this.btnJustifyCenter = true;
	this.btnJustifyRight = true;
	this.btnJustifyFull = true;
	this.btnNumbering = true;
	this.btnBullets = true;
	this.btnIndent = true;
	this.btnOutdent = true;
	this.btnLTR = false;
	this.btnRTL = false;
	this.btnForeColor = true;
	this.btnBackColor = true;
	this.btnHyperlink = true;
	this.btnBookmark = true;
	this.btnCharacters = true;
	this.btnCustomTag = false;
	this.btnImage = true;
	this.btnFlash = false;
	this.btnMedia = false;
	this.btnTable = true;
	this.btnGuidelines = true;
	this.btnAbsolute = true;
	this.btnPasteWord = true;
	this.btnLine = true;
	this.btnForm = true;
	this.btnRemoveFormat = true;
	this.btnHTMLFullSource = false;
	this.btnHTMLSource = false;
	this.btnXHTMLFullSource = false;
	this.btnXHTMLSource = true;
	this.btnClearAll = false;
	this.btnYoutubeVideo = true;
	this.btnAutoTable = false;
	this.tabs = [["tabHome", "Home", ["grpEdit", "grpFont", "grpPara"]], ["tabStyle", "Insert", ["grpInsert", "grpTables", "grpMedia"]]];
	this.groups = [["grpEdit", "", ["XHTMLSource", "FullScreen", "Search", "RemoveFormat", "BRK", "Undo", "Redo", "Cut", "Copy", "Paste", "PasteWord", "PasteText"]], ["grpFont", "", ["FontName", "FontSize", "Strikethrough", "Superscript", "BRK", "Bold", "Italic", "Underline", "ForeColor", "BackColor"]], ["grpPara", "", ["Paragraph", "Indent", "Outdent", "Styles", "StyleAndFormatting", "BRK", "JustifyLeft", "JustifyCenter", "JustifyRight", "JustifyFull", "Numbering", "Bullets"]], ["grpInsert", "", ["Hyperlink", "Bookmark", "BRK", "Image"]], ["grpTables", "", ["Table", "BRK", "Guidelines"]], ["grpMedia", "", ["Media", "Flash", "YoutubeVideo", "BRK", "Characters", "Line"]]];
	this.toolbarMode = 1;
	this.showResizeBar = true;
	this.pasteTextOnCtrlV = false;
	this.cmdAssetManager = "";
	this.cmdFileManager = "";
	this.cmdImageManager = "";
	this.cmdMediaManager = "";
	this.cmdFlashManager = "";
	this.btnContentBlock = false;
	this.cmdContentBlock = ";";
	this.btnInternalLink = false;
	this.cmdInternalLink = ";";
	this.insertLink = insertLink;
	this.btnCustomObject = false;
	this.cmdCustomObject = ";";
	this.btnInternalImage = false;
	this.cmdInternalImage = ";";
	this.arrStyle = [];
	this.isCssLoaded = false;
	this.openStyleSelect = openStyleSelect;
	this.arrParagraph = [[getTxt("Heading 1"), "H1"], [getTxt("Heading 2"), "H2"], [getTxt("Heading 3"), "H3"], [getTxt("Heading 4"), "H4"], [getTxt("Heading 5"), "H5"], [getTxt("Heading 6"), "H6"], [getTxt("Preformatted"), "PRE"], [getTxt("Normal (P)"), "P"], [getTxt("Normal (DIV)"), "DIV"]];
	this.arrFontName = ["Arial", "Arial Black", "Arial Narrow", "Book Antiqua", "Bookman Old Style", "Century Gothic", "Comic Sans MS", "Courier New", "Franklin Gothic Medium", "Garamond", "Georgia", "Impact", "Lucida Console", "Lucida Sans", "Lucida Unicode", "Modern", "Monotype Corsiva", "Palatino Linotype", "Roman", "Script", "Small Fonts", "Symbol", "Tahoma", "Times New Roman", "Trebuchet MS", "Verdana", "Webdings", "Wingdings", "serif", "sans-serif", "cursive", "fantasy", "monospace"];
	this.arrFontSize = [[getTxt("Size 1"), "1"], [getTxt("Size 2"), "2"], [getTxt("Size 3"), "3"], [getTxt("Size 4"), "4"], [getTxt("Size 5"), "5"], [getTxt("Size 6"), "6"], [getTxt("Size 7"), "7"]];
	this.arrCustomTag = [];
	this.docType = "";
	this.html = "<html>";
	this.headContent = "";
	this.preloadHTML = "";
	this.originalContent = "";
	this.isContentChanged = isContentChanged;
	this.onSave = function () {
		document.getElementById("iwe_btnSubmit" + this.oName).click()
	};
	this.onFullScreen = function () {
		return true
	};
	this.onNormalScreen = function () {
		return true
	};
	this.initialRefresh = false;
	this.doUndo = doUndo;
	this.doRedo = doRedo;
	this.saveForUndo = saveForUndo;
	this.doUndoRedo = doUndoRedo;
	this.arrUndoList = [];
	this.arrRedoList = [];
	this.useTagSelector = true;
	this.TagSelectorPosition = "bottom";
	this.moveTagSelector = moveTagSelector;
	this.selectElement = selectElement;
	this.removeTag = removeTag;
	this.doClick_TabCreate = doClick_TabCreate;
	this.doRefresh_TabCreate = doRefresh_TabCreate;
	this.arrCustomButtons = [["CustomName1", "alert(0)", "caption here", "btnSave.gif"], ["CustomName2", "alert(0)", "caption here", "btnSave.gif"]];
	this.onSelectionChanged = function () {
		return true
	};
	this.spellCheckMode = "ieSpell";
	this.encodeIO = false;
	this.changeHeight = changeHeight;
	this.fixWord = fixWord;
	this.REPLACE = REPLACE;
	this.mode = "XHTMLBody";
	this.idTextArea;
	var me = this;
	this.tbar = new ISToolbarManager(this.oName);
	this.tbar.iconPath = this.scriptPath.substring(0, this.scriptPath.indexOf("saf/")) + this.iconPath;
	editor[editor.length] = this;
	return this
};
function saveForUndo() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var obj = this;
	if (obj.arrUndoList[0]) if (oEditor.document.body.innerHTML == obj.arrUndoList[0][0]) return;
	for (var i = 20; i > 1; i--) obj.arrUndoList[i - 1] = obj.arrUndoList[i - 2];
	obj.focus();
	obj.arrUndoList[0] = [oEditor.document.body.innerHTML, null];
	this.arrRedoList = [];
	if (this.btnUndo) this.tbar.btns["btnUndo" + this.oName].setState(1);
	if (this.btnRedo) this.tbar.btns["btnRedo" + this.oName].setState(5)
};
function doUndo() {
	this.doUndoRedo(this.arrUndoList, this.arrRedoList)
};
function doRedo() {
	this.doUndoRedo(this.arrRedoList, this.arrUndoList)
};
function doUndoRedo(listA, listB) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var obj = this;
	if (!listA[0]) return;
	for (var i = 20; i > 1; i--) listB[i - 1] = listB[i - 2];
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	listB[0] = [oEditor.document.body.innerHTML, range.cloneRange()];
	sHTML = listA[0][0];
	oEditor.document.body.innerHTML = sHTML;
	oSel = oEditor.getSelection();
	oSel.removeAllRanges();
	oSel.addRange(listA[0][1]);
	for (var i = 0; i < 19; i++) listA[i] = listA[i + 1];
	listA[19] = null;
	realTime(this)
};
var bOnSubmitOriginalSaved = false;
function REPLACE(idTextArea, dvId) {
	this.idTextArea = idTextArea;
	var oTextArea = document.getElementById(idTextArea);
        if(typeof(dvId) == "undefined")
        {
            dvId = document.createElement('div');
            oTextArea.parentNode.appendChild(dvId);
        }
	oTextArea.style.display = "none";
	var oForm = oTextArea.form;
	if (oForm) {
		if (!bOnSubmitOriginalSaved) {
			if (oForm.onsubmit) onsubmit_original = oForm.onsubmit;
			bOnSubmitOriginalSaved = true
		}
		oForm.onsubmit = new Function("return onsubmit_new()")
	}
	var sContent = document.getElementById(idTextArea).value + " ";
	sContent = sContent.replace(/&/g, "&amp;");
	sContent = sContent.replace(/</g, "&lt;");
	sContent = sContent.replace(/>/g, "&gt;");
	this.RENDER(sContent, dvId)
};
function isContentChanged() {
	var sContent = "";
	if (this.mode == "HTMLBody") {
		sContent = this.getHTMLBody()
	} else if (this.mode == "HTML") {
		sContent = this.getHTML()
	} else if (this.mode == "XHTMLBody") {
		sContent = this.getXHTMLBody()
	} else if (this.mode == "XHTML") {
		sContent = this.getXHTML()
	}
	if (sContent != this.originalContent) {
		return true
	}
	return false
};
function onsubmit_new() {
	var sContent;
	for (var i = 0; i < oUtil.arrEditor.length; i++) {
		var oEdit = eval(oUtil.arrEditor[i]);
		if (oEdit.mode == "HTMLBody") sContent = oEdit.getHTMLBody();
		if (oEdit.mode == "HTML") sContent = oEdit.getHTML();
		if (oEdit.mode == "XHTMLBody") sContent = oEdit.getXHTMLBody();
		if (oEdit.mode == "XHTML") sContent = oEdit.getXHTML();
		document.getElementById(oEdit.idTextArea).value = sContent
	}
	if (onsubmit_original) return onsubmit_original()
};
function onsubmit_original() {};
function RENDER(sPreloadHTML, dvId) {
	iconHeight = this.iconHeight;
	if (sPreloadHTML.substring(0, 4) == "<!--" && sPreloadHTML.substring(sPreloadHTML.length - 3) == "-->") sPreloadHTML = sPreloadHTML.substring(4, sPreloadHTML.length - 3);
	if (sPreloadHTML.substring(0, 4) == "<!--" && sPreloadHTML.substring(sPreloadHTML.length - 6) == "--&gt;") sPreloadHTML = sPreloadHTML.substring(4, sPreloadHTML.length - 6);
	sPreloadHTML = sPreloadHTML.replace(/&lt;/g, "<");
	sPreloadHTML = sPreloadHTML.replace(/&gt;/g, ">");
	sPreloadHTML = sPreloadHTML.replace(/&amp;/g, "&");
	if (this.cmdContentBlock != ";") this.btnContentBlock = true;
	if (this.cmdInternalLink != ";") this.btnInternalLink = true;
	if (this.cmdInternalImage != ";") this.btnInternalImage = true;
	if (this.cmdCustomObject != ";") this.btnCustomObject = true;
	if (this.arrCustomTag.length > 0) this.btnCustomTag = true;
	if (this.mode == "HTMLBody") {
		this.btnXHTMLSource = true;
		this.btnXHTMLFullSource = false
	}
	if (this.mode == "HTML") {
		this.btnXHTMLFullSource = true;
		this.btnXHTMLSource = false
	}
	if (this.mode == "XHTMLBody") {
		this.btnXHTMLSource = true;
		this.btnXHTMLFullSource = false
	}
	if (this.mode == "XHTML") {
		this.btnXHTMLFullSource = true;
		this.btnXHTMLSource = false
	}
	var bUseFeature = false;
	if (this.features.length > 0) {
		bUseFeature = true;
		for (var i = 0; i < this.buttonMap.length; i++) eval(this.oName + ".btn" + this.buttonMap[i] + "=true");
		this.btnTextFormatting = false;
		this.btnListFormatting = false;
		this.btnBoxFormatting = false;
		this.btnParagraphFormatting = false;
		this.btnCssText = false;
		this.btnCssBuilder = false;
		for (var j = 0; j < this.features.length; j++) eval(this.oName + ".btn" + this.features[j] + "=true");
		for (var i = 0; i < this.buttonMap.length; i++) {
			sButtonName = this.buttonMap[i];
			bBtnExists = false;
			for (var j = 0; j < this.features.length; j++) if (sButtonName == this.features[j]) bBtnExists = true;
			if (!bBtnExists) eval(this.oName + ".btn" + sButtonName + "=false")
		}
		this.buttonMap = this.features
	}
	this.preloadHTML = sPreloadHTML;
	var sHTMLDropMenus = "";
	var sHTMLIcons = "";
	var sTmp = "";
	this.oColor1.url = this.scriptPath + "color_picker_fg.htm";
	this.oColor1.onShow = new Function(this.oName + ".hide()");
	this.oColor1.onMoreColor = new Function(this.oName + ".hide()");
	this.oColor1.onPickColor = new Function(this.oName + ".applyColor('ForeColor', " + this.oName + ".oColor1.color)");
	this.oColor1.onRemoveColor = new Function(this.oName + ".applyColor('ForeColor','')");
	this.oColor1.txtCustomColors = getTxt("Custom Colors");
	this.oColor1.txtMoreColors = getTxt("More Colors...");
	this.oColor2.url = this.scriptPath + "color_picker_bg.htm";
	this.oColor2.onShow = new Function(this.oName + ".hide()");
	this.oColor2.onMoreColor = new Function(this.oName + ".hide()");
	this.oColor2.onPickColor = new Function(this.oName + ".applyColor('hilitecolor', " + this.oName + ".oColor2.color)");
	this.oColor2.onRemoveColor = new Function(this.oName + ".applyColor('HiliteColor','')");
	this.oColor2.txtCustomColors = getTxt("Custom Colors");
	this.oColor2.txtMoreColors = getTxt("More Colors...");
	var me = this;
	if (this.toolbarMode != 0) {
		var tmp = null,
		tmpTb, grpMap = new Object();
		for (var i = 0; i < this.buttonMap.length; i++) {
			eval(this.oName + ".btn" + this.buttonMap[i] + "=false")
		}
		for (var i = 0; i < this.groups.length; i++) {
			tmp = this.groups[i];
			tmpTb = this.tbar.createToolbar(this.oName + "tbar" + tmp[0]);
			tmpTb.onClick = function (id) {
				tbAction(tmpTb, id, me, me.oName)
			};
			tmpTb.style.toolbar = "main_istoolbar";
			tmpTb.iconPath = this.scriptPath.substring(0, this.scriptPath.indexOf("saf/")) + this.iconPath;
			tmpTb.btnWidth = this.iconWidth;
			tmpTb.btnHeight = this.iconHeight;
			for (var j = 0; j < tmp[2].length; j++) {
				eval(this.oName + ".btn" + tmp[2][j] + "=true")
			}
			buildToolbar(tmpTb, this, tmp[2]);
			grpMap[tmp[0]] = tmp[1]
		}
		if (this.toolbarMode == 1) {
			var eTab = this.tbar.createTbTab("tabCtl" + this.oName),
			tmpGrp;
			for (var i = 0; i < this.tabs.length; i++) {
				tmp = this.tabs[i];
				tmpGrp = this.tbar.createTbGroup(this.oName + "grp" + tmp[0]);
				for (var j = 0; j < tmp[2].length; j++) {
					tmpGrp.addGroup(this.oName + tmp[2][j], grpMap[tmp[2][j]], this.oName + "tbar" + tmp[2][j])
				}
				eTab.addTab(this.oName + tmp[0], tmp[1], tmpGrp)
			}
		} else if (this.groups.length > 0) {
			var tmpGrp;
			tmpGrp = this.tbar.createTbGroup(this.oName + "grp");
			for (var i = 0; i < this.groups.length; i++) {
				tmp = this.groups[i];
				tmpGrp.addGroup(this.oName + tmp[0], grpMap[tmp[0]], this.oName + "tbar" + tmp[0])
			}
		}
	} else {
		var orTb = this.tbar.createToolbar(this.oName);
		orTb.onClick = function (id) {
			tbAction(orTb, id, me, me.oName)
		};
		orTb.iconPath = this.scriptPath.substring(0, this.scriptPath.indexOf("saf/")) + this.iconPath;
		orTb.btnWidth = this.iconWidth;
		orTb.btnHeight = this.iconHeight;
		buildToolbar(orTb, this, this.buttonMap)
	}
	var sHTML = "";
	var icPath = this.scriptPath.substring(0, this.scriptPath.indexOf("saf/")) + this.iconPath;
	if (!document.getElementById("id_refresh_z_index")) sHTML += "<div id=id_refresh_z_index style='margin:0px'></div>";
	sHTML += "<table id=idArea" + this.oName + " name=idArea" + this.oName + " border='0px' " + "cellpadding=0 cellspacing=0 width='" + this.width + "' height='" + this.height + "' style='border-bottom:solid 1px #cfcfcf'>" + "<tr><td colspan=2 style=\"padding:0px;border:#cfcfcf 0px solid;background:url('" + icPath + "bg.gif')\">" + "<table cellpadding=0 cellspacing=0 border=0 width=100%><tr><td dir=ltr style='padding:0px;'>" + this.tbar.render() + "</td></tr></table>" + "</td></tr>" + "<tr id=idTagSelTopRow" + this.oName + "><td colspan=2 id=idTagSelTop" + this.oName + " height=0px style='padding:0px;'></td></tr>";
	sHTML += "<tr style='width:100%;height:100%'><td colspan=2 valign=top height=100% style='padding:0px;background:white;padding-right:0px;'>";
	sHTML += "<table id='cntContainer" + this.oName + "' cellpadding=0 cellspacing=0 width='100%' height='100%' style='margin-top:0px;'><tr style='width:100%;height:100%'><td width='100%' height='100%' style='padding:0px;border:solid 1px #cfcfcf;border-bottom:none'>";
	sHTML += "<iframe frameborder='no' style='width:100%;height:100%;' " + " name=idContent" + this.oName + " id=idContent" + this.oName + "></iframe>";
	sHTML += "<iframe style='width:1px;height:1px;overflow:auto;border:0px' id=\"myStyle" + this.oName + "\" name=\"myStyle" + this.oName + "\" src='" + this.scriptPath + "blank.gif'></iframe>";
	sHTML += "</td><td id=idStyles" + this.oName + " style='padding:0px;background:#f4f4f4'></td></tr></table>";
	sHTML += "</td></tr>";
	sHTML += "<tr id=idTagSelBottomRow" + this.oName + "><td colspan=2 id=idTagSelBottom" + this.oName + " style='padding:0px;'></td></tr>";
	if (this.showResizeBar) {
		sHTML += "<tr id=idResizeBar" + this.oName + "><td colspan=2 style='padding:0px;'><div  style='cursor:n-resize;' class='resize_bar' onmousedown=\"onEditorStartResize(event, this, '" + this.oName + "')\" ></div></td></tr>"
	}
	sHTML += "</table>";
	sHTML += sHTMLDropMenus;
	sHTML += "<input type=submit name=iwe_btnSubmit" + this.oName + " id=iwe_btnSubmit" + this.oName + " value=SUBMIT style='display:none' >";
	if (typeof(dvId) == 'string')
        {
            document.getElementById(dvId).innerHTML = sHTML;
	}
        else if(typeof(dvId) == 'object')
        {
            dvId.innerHTML = sHTML;
        }
        else
        {
            document.write(sHTML);
	}
	this.init()
};
function onEditorStartResize(ev, elm, oName) {
	document.onmousemove = onEditorResize;
	document.onmouseup = onEditorStopResize;
	document.onselectstart = function () {
		return false
	};
	document.ondragstart = function () {
		return false
	};
	document.body.style.cursor = "n-resize";
	oUtil.currentResized = eval(oName);
	oUtil.resizeInit = {
		x: ev.screenX,
		y: ev.screenY
	};
	if (!oUtil.isWindow) oUtil.isWindow = new ISWindow(oName);
	oUtil.isWindow.showOverlay()
};
function onEditorStopResize(event) {
	oUtil.resizeOffset = {
		dx: event.screenX - oUtil.resizeInit.x,
		dy: event.screenY - oUtil.resizeInit.y
	};
	oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);
	oUtil.isWindow.hideOverlay();
	document.onmousemove = null;
	document.onmouseup = null;
	document.body.style.cursor = "default"
};
function onEditorResize(event) {
	oUtil.resizeOffset = {
		dx: event.screenX - oUtil.resizeInit.x,
		dy: event.screenY - oUtil.resizeInit.y
	};
	oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);
	oUtil.resizeInit = {
		x: event.screenX,
		y: event.screenY
	}
};
function initISEditor() {
	if (this.useTagSelector) {
		if (this.TagSelectorPosition == "bottom") this.TagSelectorPosition = "top";
		else this.TagSelectorPosition = "bottom";
		this.moveTagSelector()
	}
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	oUtil.oName = this.oName;
	oUtil.oEditor = oEditor;
	oUtil.obj = this;
	oUtil.arrEditor.push(this.oName);
	var arrA = String(this.preloadHTML).match(/<HTML[^>]*>/ig);
	if (arrA) {
		this.loadHTMLFull(this.preloadHTML)
	} else {
		this.loadHTML(this.preloadHTML)
	}
	if (!oUtil.bOnLoadReplaced) {
		if (window.onload) onload_original = window.onload;
		window.onload = new Function("onload_new()");
		oUtil.bOnLoadReplaced = true
	}
	try {
		oEditor.document.body.contentEditable = true
	} catch(e) {}
	this.focus();
	try {
		var cnt = oEditor.document.body.innerHTML;
		cnt = cnt.replace(/\s+/gi, "");
		if (cnt == "") {
			oEditor.document.body.innerHTML = "<br class=\"innova\" />"
		}
		var range = oEditor.document.createRange();
		range.selectNode(oEditor.document.body.childNodes[0]);
		range.collapse(true);
		var sel = oEditor.getSelection();
		sel.removeAllRanges();
		sel.addRange(range)
	} catch(e) {}
	switch (this.mode) {
	case "HTMLBody":
		this.originalContent = this.getHTMLBody();
		break;
	case "HTML":
		this.originalContent = this.getHTML();
		break;
	case "XHTMLBody":
		this.originalContent = this.getXHTMLBody();
		break;
	case "XHTML":
		this.originalContent = this.getXHTML();
		break
	};
	this.focus()
};
function buildToolbar(tb, oEdt, btnMap) {
	var oName = oEdt.oName;
	for (var i = 0; i < btnMap.length; i++) {
		sButtonName = btnMap[i];
		switch (sButtonName) {
		case "|":
			tb.addSeparator();
			break;
		case "BRK":
			tb.addBreak();
			break;
		case "Save":
			if (oEdt.btnSave) tb.addButton("btnSave" + oName, "btnSave.gif", getTxt("Save"));
			break;
		case "Preview":
			if (oEdt.btnPreview) {
				tb.addDropdownButton("btnPreview" + oName, "ddPreview" + oName, "btnPreview.gif", getTxt("Preview"));
				var pvDD = new ISDropdown("ddPreview" + oName);
				pvDD.addItem("btnPreview1" + oName, "640x480");
				pvDD.addItem("btnPreview2" + oName, "800x600");
				pvDD.addItem("btnPreview3" + oName, "1024x768");
				pvDD.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				}
			}
			break;
		case "FullScreen":
			if (oEdt.btnFullScreen) tb.addButton("btnFullScreen" + oName, "btnFullScreen.gif", getTxt("Full Screen"));
			break;
		case "Print":
			if (oEdt.btnPrint) tb.addButton("btnPrint" + oName, "btnPrint.gif", getTxt("Print"));
			break;
		case "Search":
			if (oEdt.btnSearch) tb.addButton("btnSearch" + oName, "btnSearch.gif", getTxt("Search"));
			break;
		case "SpellCheck":
			if (oEdt.btnSpellCheck) {
				if (oEdt.spellCheckMode != "ieSpell") tb.addButton("btnSpellCheck" + oName, "btnSpellCheck.gif", getTxt("Check Spelling"))
			}
			break;
		case "StyleAndFormatting":
			if (oEdt.btnTextFormatting || oEdt.btnParagraphFormatting || oEdt.btnListFormatting || oEdt.btnBoxFormatting || oEdt.btnCssText || oEdt.btnCssBuilder) {
				tb.addDropdownButton("btnStyleAndFormat" + oName, "ddFormatting" + oName, "btnStyle.gif", getTxt("Styles & Formatting"));
				var ddFmt = new ISDropdown("ddFormatting" + oName);
				ddFmt.iconPath = tb.iconPath;
				ddFmt.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				if (oEdt.btnTextFormatting) ddFmt.addItem("btnTextFormatting" + oName, getTxt("Text Formatting"), "btnTextFormatting.gif");
				if (oEdt.btnParagraphFormatting) ddFmt.addItem("btnParagraphFormatting" + oName, getTxt("Paragraph Formatting"), "btnParagraphFormatting.gif");
				if (oEdt.btnListFormatting) ddFmt.addItem("btnListFormatting" + oName, getTxt("List Formatting"), "btnListFormatting.gif");
				if (oEdt.btnBoxFormatting) ddFmt.addItem("btnBoxFormatting" + oName, getTxt("Box Formatting"), "btnBoxFormatting.gif");
				if (oEdt.btnCssText) ddFmt.addItem("btnCssText" + oName, getTxt("Custom CSS"), "btnCustomCss.gif");
				if (oEdt.btnCssBuilder) ddFmt.addItem("btnCssBuilder" + oName, getTxt("CSS Builder"))
			}
			break;
		case "Styles":
			if (oEdt.btnStyles) tb.addButton("btnStyles" + oName, "btnStyleSelect.gif", getTxt("Style Selection"));
			break;
		case "Paragraph":
			if (oEdt.btnParagraph) {
				tb.addDropdownButton("btnParagraph" + oName, "ddParagraph" + oName, "btnParagraph.gif", getTxt("Paragraph"), 37);
				var ddPar = new ISDropdown("ddParagraph" + oName);
				ddPar.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				for (var j = 0; j < oEdt.arrParagraph.length; j++) {
					ddPar.addItem("btnParagraph_" + j + oName, "<" + oEdt.arrParagraph[j][1] + " style=\"\margin-bottom:4px\"  unselectable=on> " + oEdt.arrParagraph[j][0] + "</" + oEdt.arrParagraph[j][1] + ">")
				}
			}
			break;
		case "FontName":
			if (oEdt.btnFontName) {
				tb.addDropdownButton("btnFontName" + oName, "ddFontName" + oName, "btnFontName.gif", getTxt("Font Name"), 37);
				var ddFont = new ISDropdown("ddFontName" + oName);
				ddFont.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				for (var j = 0; j < oEdt.arrFontName.length; j++) {
					ddFont.addItem("btnFontName_" + j + oName, "<span style='font-family:" + oEdt.arrFontName[j] + "' unselectable=on>" + oEdt.arrFontName[j] + "</span><span unselectable=on style='font-family:tahoma'>(" + oEdt.arrFontName[j] + ")</span>")
				}
			}
			break;
		case "FontSize":
			if (oEdt.btnFontSize) {
				tb.addDropdownButton("btnFontSize" + oName, "ddFontSize" + oName, "btnFontSize.gif", getTxt("Font Size"), 37);
				var ddFs = new ISDropdown("ddFontSize" + oName);
				ddFs.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				for (var j = 0; j < oEdt.arrFontSize.length; j++) {
					ddFs.addItem("btnFontSize_" + j + oName, "<font unselectable=on size=\"" + oEdt.arrFontSize[j][1] + "\">" + oEdt.arrFontSize[j][0] + "</font>")
				}
			}
			break;
		case "Undo":
			if (oEdt.btnUndo) tb.addButton("btnUndo" + oName, "btnUndo.gif", getTxt("Undo"));
			break;
		case "Redo":
			if (oEdt.btnRedo) tb.addButton("btnRedo" + oName, "btnRedo.gif", getTxt("Redo"));
			break;
		case "Paste":
			if (oEdt.btnPasteWord || oEdt.btnPasteText) {
				tb.addDropdownButton("btnPaste" + oName, "ddPaste" + oName, "btnPaste.gif", getTxt("Paste"));
				var pvDD = new ISDropdown("ddPaste" + oName);
				pvDD.iconPath = tb.iconPath;
				if (oEdt.btnPasteWord) pvDD.addItem("btnPasteWord" + oName, getTxt("Paste from Word"), "btnPasteWord.gif");
				if (oEdt.btnPasteText) pvDD.addItem("btnPasteText" + oName, getTxt("Paste Text"), "btnPasteText.gif");
				pvDD.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				}
			}
			break;
		case "Bold":
			if (oEdt.btnBold) tb.addToggleButton("btnBold" + oName, "", false, "btnBold.gif", getTxt("Bold"));
			break;
		case "Italic":
			if (oEdt.btnItalic) tb.addToggleButton("btnItalic" + oName, "", false, "btnItalic.gif", getTxt("Italic"));
			break;
		case "Underline":
			if (oEdt.btnUnderline) tb.addToggleButton("btnUnderline" + oName, "", false, "btnUnderline.gif", getTxt("Underline"));
			break;
		case "Strikethrough":
			if (oEdt.btnStrikethrough) tb.addToggleButton("btnStrikethrough" + oName, "", false, "btnStrikethrough.gif", getTxt("Strikethrough"));
			break;
		case "Superscript":
			if (oEdt.btnSuperscript) tb.addToggleButton("btnSuperscript" + oName, "", false, "btnSuperscript.gif", getTxt("Superscript"));
			break;
		case "Subscript":
			if (oEdt.btnSubscript) tb.addToggleButton("btnSubscript" + oName, "", false, "btnSubscript.gif", getTxt("Subscript"));
			break;
		case "JustifyLeft":
			if (oEdt.btnJustifyLeft) tb.addToggleButton("btnJustifyLeft" + oName, "align", false, "btnLeft.gif", getTxt("Justify Left"));
			break;
		case "JustifyCenter":
			if (oEdt.btnJustifyCenter) tb.addToggleButton("btnJustifyCenter" + oName, "align", false, "btnCenter.gif", getTxt("Justify Center"));
			break;
		case "JustifyRight":
			if (oEdt.btnJustifyRight) tb.addToggleButton("btnJustifyRight" + oName, "align", false, "btnRight.gif", getTxt("Justify Right"));
			break;
		case "JustifyFull":
			if (oEdt.btnJustifyFull) tb.addToggleButton("btnJustifyFull" + oName, "align", false, "btnFull.gif", getTxt("Justify Full"));
			break;
		case "Numbering":
			if (oEdt.btnNumbering) tb.addToggleButton("btnNumbering" + oName, "bullet", false, "btnNumber.gif", getTxt("Numbering"));
			break;
		case "Bullets":
			if (oEdt.btnBullets) tb.addToggleButton("btnBullets" + oName, "bullet", false, "btnList.gif", getTxt("Bullets"));
			break;
		case "Indent":
			if (oEdt.btnIndent) tb.addButton("btnIndent" + oName, "btnIndent.gif", getTxt("Indent"));
			break;
		case "Outdent":
			if (oEdt.btnOutdent) tb.addButton("btnOutdent" + oName, "btnOutdent.gif", getTxt("Outdent"));
			break;
		case "LTR":
			if (oEdt.btnLTR) tb.addToggleButton("btnLTR" + oName, "dir", false, "btnLTR.gif", getTxt("Left To Right"));
			break;
		case "RTL":
			if (oEdt.btnRTL) tb.addToggleButton("btnRTL" + oName, "dir", false, "btnRTL.gif", getTxt("Right To Left"));
			break;
		case "ForeColor":
			tb.addDropdownButton("btnForeColor" + oName, "ddForeColor" + oName, "btnForeColor.gif", getTxt("Foreground Color"));
			var ddTable = new ISDropdown("ddForeColor" + oName);
			ddTable.add(new ISCustomDDItem("btnInsertForeColor", oEdt.oColor1.generateHTML()));
			break;
		case "BackColor":
			tb.addDropdownButton("btnBackColor" + oName, "ddBackColor" + oName, "btnBackColor.gif", getTxt("Background Color"));
			var ddTable = new ISDropdown("ddBackColor" + oName);
			ddTable.add(new ISCustomDDItem("btnInsertBackColor", oEdt.oColor2.generateHTML()));
			break;
		case "Bookmark":
			if (oEdt.btnBookmark) tb.addButton("btnBookmark" + oName, "btnBookmark.gif", getTxt("Bookmark"));
			break;
		case "Hyperlink":
			if (oEdt.btnHyperlink) tb.addButton("btnHyperlink" + oName, "btnHyperlink.gif", getTxt("Hyperlink"));
			break;
		case "CustomTag":
			if (oEdt.btnCustomTag) {
				tb.addDropdownButton("btnCustomTag" + oName, "ddCustomTag" + oName, "btnCustomTag.gif", getTxt("Tags"), 37);
				var ddCustomTag = new ISDropdown("ddCustomTag" + oName);
				ddCustomTag.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				for (var j = 0; j < oEdt.arrCustomTag.length; j++) {
					ddCustomTag.addItem("btnCustomTag_" + j + oName, oEdt.arrCustomTag[j][0])
				}
			}
			break;
		case "Image":
			if (oEdt.btnImage) tb.addButton("btnImage" + oName, "btnImage.gif", getTxt("Image"));
			break;
		case "Flash":
			if (oEdt.btnFlash) tb.addButton("btnFlash" + oName, "btnFlash.gif", getTxt("Flash"));
			break;
		case "Media":
			if (oEdt.btnMedia) tb.addButton("btnMedia" + oName, "btnMedia.gif", getTxt("Media"));
			break;
		case "YoutubeVideo":
			if (oEdt.btnYoutubeVideo) tb.addButton("btnYoutubeVideo" + oName, "btnYoutubeVideo.gif", getTxt("YoutubeVideo"));
			break;
		case "ContentBlock":
			if (oEdt.btnContentBlock) tb.addButton("btnContentBlock" + oName, "btnContentBlock.gif", getTxt("Content Block"));
			break;
		case "InternalLink":
			if (oEdt.btnInternalLink) tb.addButton("btnInternalLink" + oName, "btnInternalLink.gif", getTxt("Internal Link"));
			break;
		case "InternalImage":
			if (oEdt.btnInternalImage) tb.addButton("btnInternalImage" + oName, "btnInternalImage.gif", getTxt("Internal Image"));
			break;
		case "CustomObject":
			if (oEdt.btnCustomObject) tb.addButton("btnCustomObject" + oName, "btnCustomObject.gif", getTxt("Object"));
			break;
		case "Table":
			if (oEdt.btnTable) {
				var sdd = [],
				sZ = 0;
				sdd[sZ++] = "<table width='175' id='dropTableCreate" + oName + "' style='cursor:default;background:#f3f3f8;' cellpadding=0 cellspacing=1 unselectable=on>";
				for (var m = 0; m < 8; m++) {
					sdd[sZ++] = "<tr>";
					for (var n = 0; n < 8; n++) {
						sdd[sZ++] = "<td onclick='" + oName + ".doClick_TabCreate(this)' onmouseover='doOver_TabCreate(this);event.cancelBubble=true;' style='background:#ffffff;font-size:1px;border:#d3d3d3 1px solid;width:20px;height:20px;' unselectable=on>&nbsp;</td>"
					}
					sdd[sZ++] = "</tr>"
				}
				sdd[sZ++] = "<tr><td colspan=8 onclick=\"" + oName + ".hide();modelessDialogShow('" + oEdt.scriptPath + "table_insert.htm',380,380);\" onmouseover=\"doOut_TabCreate(document.getElementById('dropTableCreate" + oName + "'));this.innerHTML='" + getTxt("Advanced Table Insert") + "';this.style.border='#777777 1px solid';this.style.backgroundColor='#444444';this.style.color='#ffffff'\" onmouseout=\"this.style.border='#f3f3f8 1px solid';this.style.backgroundColor='#f3f3f8';this.style.color='#000000'\" align=center style='font-family:verdana;font-size:10px;color:#000000;border:#f3f3f8 1px solid;padding:1px 1px 1px 1px' unselectable=on>" + getTxt("Advanced Table Insert") + "</td></tr>";
				sdd[sZ++] = "</table>";
				tb.addDropdownButton("btnTable" + oName, "ddTable" + oName, "btnTable.gif", getTxt("Insert Table"));
				var ddTable = new ISDropdown("ddTable" + oName);
				ddTable.add(new ISCustomDDItem("btnInsertTable", sdd.join("")));
				tb.addDropdownButton("btnTableEdit" + oName, "ddTableEdit" + oName, "btnTableEdit.gif", getTxt("Edit Table/Cell"));
				var ddTblEdit = new ISDropdown("ddTableEdit" + oName);
				ddTblEdit.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				ddTblEdit.iconPath = tb.iconPath;
				ddTblEdit.addItem("mnuTableSize" + oName, getTxt("Table Size"), "btnTableSize.gif");
				ddTblEdit.addItem("mnuTableEdit" + oName, getTxt("Edit Table"), "btnEditTable.gif");
				ddTblEdit.addItem("mnuCellEdit" + oName, getTxt("Edit Cell"), "btnEditCell.gif")
			}
			break;
		case "AutoTable":
			if (oEdt.btnAutoTable) tb.addButton("btnAutoTable" + oName, "btnAutoTable.gif", getTxt("AutoTable"));
			break;
		case "Absolute":
			if (oEdt.btnAbsolute) tb.addButton("btnAbsolute" + oName, "btnAbsolute.gif", getTxt("Absolute"));
			break;
		case "Characters":
			if (oEdt.btnCharacters) tb.addButton("btnCharacters" + oName, "btnSymbol.gif", getTxt("Special Characters"));
			break;
		case "Line":
			if (oEdt.btnLine) tb.addButton("btnLine" + oName, "btnLine.gif", getTxt("Line"));
			break;
		case "Form":
			if (oEdt.btnForm) {
				var arrFormMenu = [[getTxt("Form"), "form_form.htm", "280", "177"], [getTxt("Text Field"), "form_text.htm", "285", "289"], [getTxt("List"), "form_list.htm", "295", "332"], [getTxt("Checkbox"), "form_check.htm", "235", "174"], [getTxt("Radio Button"), "form_radio.htm", "235", "177"], [getTxt("Hidden Field"), "form_hidden.htm", "235", "152"], [getTxt("File Field"), "form_file.htm", "235", "132"], [getTxt("Button"), "form_button.htm", "235", "174"]];
				tb.addDropdownButton("btnForm" + oName, "ddForm" + oName, "btnForm.gif", getTxt("Form Editor"));
				var ddForm = new ISDropdown("ddForm" + oName);
				ddForm.onClick = function (id) {
					ddAction(tb, id, oEdt, oEdt.oName)
				};
				for (var j = 0; j < arrFormMenu.length; j++) {
					ddForm.addItem("btnForm" + j + oName, arrFormMenu[j][0])
				}
			}
			break;
		case "RemoveFormat":
			if (oEdt.btnRemoveFormat) tb.addButton("btnRemoveFormat" + oName, "btnRemoveFormat.gif", getTxt("Remove Formatting"));
			break;
		case "HTMLFullSource":
			if (oEdt.btnHTMLFullSource) tb.addButton("btnHTMLFullSource" + oName, "btnSource.gif", getTxt("View/Edit Source"));
			break;
		case "HTMLSource":
			if (oEdt.btnHTMLSource) tb.addButton("btnHTMLSource" + oName, "btnSource.gif", getTxt("View/Edit Source"));
			break;
		case "XHTMLFullSource":
			if (oEdt.btnXHTMLFullSource) tb.addButton("btnXHTMLFullSource" + oName, "btnSource.gif", getTxt("View/Edit Source"));
			break;
		case "XHTMLSource":
			if (oEdt.btnXHTMLSource) tb.addButton("btnXHTMLSource" + oName, "btnSource.gif", getTxt("View/Edit Source"));
			break;
		case "ClearAll":
			if (oEdt.btnClearAll) tb.addButton("btnClearAll" + oName, "btnDelete.gif", getTxt("Clear All"));
			break;
		default:
			for (j = 0; j < oEdt.arrCustomButtons.length; j++) {
				if (sButtonName == oEdt.arrCustomButtons[j][0]) {
					sCbName = oEdt.arrCustomButtons[j][0];
					sCbCaption = oEdt.arrCustomButtons[j][2];
					sCbImage = oEdt.arrCustomButtons[j][3];
					if (oEdt.arrCustomButtons[j][4]) tb.addButton(sCbName + oName, sCbImage, sCbCaption, oEdt.arrCustomButtons[j][4]);
					else tb.addButton(sCbName + oName, sCbImage, sCbCaption)
				}
			}
			break
		}
	}
};
function iwe_getElm(s) {
	return document.getElementById(s + this.oName)
};
function onload_new() {
	onload_original()
};
function onload_original() {};
var arrColorPickerObjects = [];
function ColorPicker(sName, sParent) {
	this.oParent = sParent;
	if (sParent) {
		this.oName = sParent + "." + sName;
		this.oRenderName = sName + sParent
	} else {
		this.oName = sName;
		this.oRenderName = sName
	}
	arrColorPickerObjects.push(this.oName);
	this.url = "color_picker.htm";
	this.onShow = function () {
		return true
	};
	this.onHide = function () {
		return true
	};
	this.onPickColor = function () {
		return true
	};
	this.onRemoveColor = function () {
		return true
	};
	this.onMoreColor = function () {
		return true
	};
	this.show = showColorPicker;
	this.hide = hideColorPicker;
	this.hideAll = hideColorPickerAll;
	this.color;
	this.customColors = [];
	this.refreshCustomColor = refreshCustomColor;
	this.isActive = false;
	this.txtCustomColors = "Custom Colors";
	this.txtMoreColors = "More Colors...";
	this.align = "left";
	this.currColor = "#ffffff";
	this.generateHTML = generateHTML;
	this.RENDER = drawColorPicker
};
function generateHTML() {
	var arrColors = [["#800000", "#8b4513", "#006400", "#2f4f4f", "#000080", "#4b0082", "#800080", "#000000"], ["#ff0000", "#daa520", "#6b8e23", "#708090", "#0000cd", "#483d8b", "#c71585", "#696969"], ["#ff4500", "#ffa500", "#808000", "#4682b4", "#1e90ff", "#9400d3", "#ff1493", "#a9a9a9"], ["#ff6347", "#ffd700", "#32cd32", "#87ceeb", "#00bfff", "#9370db", "#ff69b4", "#dcdcdc"], ["#ffdab9", "#ffffe0", "#98fb98", "#e0ffff", "#87cefa", "#e6e6fa", "#dda0dd", "#ffffff"]];
	var sHTMLColor = "<table id=dropColor" + this.oRenderName + " style=\"cursor:default;background-color:#f4f4f4;padding:2px\" unselectable=on cellpadding=0 cellspacing=0 width=145px><tr><td unselectable=on style='padding:0px;'>";
	sHTMLColor += "<table align=center cellpadding=0 cellspacing=0 border=0 unselectable=on>";
	for (var i = 0; i < arrColors.length; i++) {
		sHTMLColor += "<tr>";
		for (var j = 0; j < arrColors[i].length; j++) sHTMLColor += "<td onclick=\"" + this.oName + ".color='" + arrColors[i][j] + "';" + this.oName + ".onPickColor();" + this.oName + ".currColor='" + arrColors[i][j] + "';" + this.oName + ".hideAll()\" onmouseover=\"this.style.border='#777777 1px solid'\" onmouseout=\"this.style.border='#f4f4f4 1px solid'\" style=\"padding:0px;cursor:default;padding:1px;border:#f4f4f4 1px solid;\" unselectable=on>" + "<table style='margin:0px;width:13px;height:13px;background:" + arrColors[i][j] + ";border:white 1px solid' cellpadding=0 cellspacing=0 unselectable=on>" + "<tr><td unselectable=on style='padding:0px;'></td></tr>" + "</table></td>";
		sHTMLColor += "</tr>"
	}
	sHTMLColor += "<tr><td colspan=8 id=idCustomColor" + this.oRenderName + " style='padding:0px;'></td></tr>";
	sHTMLColor += "<tr>";
	sHTMLColor += "<td unselectable=on style='padding:0px;'>" + "<table style='padding:0px;margin-left:1px;width:14px;height:14px;background:#f4f4f4;' cellpadding=0 cellspacing=0 unselectable=on>" + "<tr><td onclick=\"" + this.oName + ".onRemoveColor();" + this.oName + ".currColor='';" + this.oName + ".hideAll()\" onmouseover=\"this.style.border='#777777 1px solid'\" onmouseout=\"this.style.border='white 1px solid'\" style=\"cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;\" align=center valign=top unselectable=on>x</td></tr>" + "</table></td>";
	sHTMLColor += "<td colspan=7 unselectable=on style='padding:0px;'>" + "<table style='padding:0px;margin:1px;width:117px;height:16px;background:#f4f4f4;border:white 1px solid' cellpadding=0 cellspacing=0 unselectable=on>" + "<tr><td id=\"" + this.oName + "moreColTd\" onclick=\"" + this.oName + ".onMoreColor();" + this.oName + ".hideAll();modelessDialogShow('" + this.url + "?" + this.oName + "', 455, 455, window,{'oName':'" + this.oName + "'})\" onmouseover=\"this.style.border='#777777 1px solid';this.style.background='#444444';this.style.color='#ffffff'\" onmouseout=\"this.style.border='#f4f4f4 1px solid';this.style.background='#f4f4f4';this.style.color='#000000'\" style=\"cursor:default;font-family:verdana;font-size:9px;color:#000000;line-height:9px;padding:1px\" align=center valign=top nowrap unselectable=on>" + this.txtMoreColors + "</td></tr>" + "</table></td>";
	sHTMLColor += "</tr>";
	sHTMLColor += "</table>";
	sHTMLColor += "</td></tr></table>";
	return sHTMLColor
};
function drawColorPicker() {
	document.write(this.generateHTML())
};
function refreshCustomColor() {
	this.customColors = eval(this.oParent).customColors;
	if (this.customColors.length == 0) {
		document.getElementById("idCustomColor" + this.oRenderName).innerHTML = "";
		return
	}
	sHTML = "<table cellpadding=0 cellspacing=0 width=100%><tr><td colspan=8 style=\"font-family:verdana;font-size:9px;color:#000000;line-height:9px;padding:1px\">" + this.txtCustomColors + ":</td></tr></table>";
	sHTML += "<table cellpadding=0 cellspacing=0><tr>";
	for (var i = 0; i < this.customColors.length; i++) {
		if (i < 22) {
			if (i == 8 || i == 16 || i == 24 || i == 32) sHTML += "</tr></table><table cellpadding=0 cellspacing=0><tr>";
			sHTML += "<td onclick=\"" + this.oName + ".color='" + this.customColors[i] + "';" + this.oName + ".onPickColor()\" onmouseover=\"this.style.border='#777777 1px solid'\" onmouseout=\"this.style.border='#f4f4f4 1px solid'\" style=\"cursor:default;padding:1px;border:#f4f4f4 1px solid;\" unselectable=on>" + "   <table  style='margin:0px;width:13px;height:13px;background:" + this.customColors[i] + ";border:white 1px solid' cellpadding=0 cellspacing=0 unselectable=on>" + "   <tr><td unselectable=on></td></tr>" + "   </table>" + "</td>"
		}
	}
	sHTML += "</tr></table>";
	document.getElementById("idCustomColor" + this.oRenderName).innerHTML = sHTML
};
function showColorPicker(oEl) {
	this.refreshCustomColor()
};
function hideColorPicker() {
	this.onHide();
	return;
	var box = document.getElementById("dropColor" + this.oRenderName);
	box.style.display = "none";
	this.isActive = false
};
function hideColorPickerAll() {
	return;
	for (var i = 0; i < arrColorPickerObjects.length; i++) {
		var box = document.getElementById("dropColor" + eval(arrColorPickerObjects[i]).oRenderName);
		box.style.display = "none";
		eval(arrColorPickerObjects[i]).isActive = false
	}
};
function loadHTML(sHTML) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	oEditor.document.open("text/html", "replace");
	var defaultEditCss = "<link id='tmp_xxinnova' href='" + this.scriptPath + "default_edit.css' type='text/css' rel='stylesheet' />";
	var hdr = "";
	if (this.publishingPath != "") {
		var arrA = String(this.preloadHTML).match(/<base[^>]*>/ig);
		if (!arrA) {
			hdr = this.docType + "<HTML><HEAD><BASE HREF=\"" + this.publishingPath + "\"/>" + defaultEditCss + this.headContent + "</HEAD><BODY>" + "</BODY></HTML>"
		}
	} else {
		hdr = this.docType + "<HTML><HEAD>" + defaultEditCss + this.headContent + "</HEAD><BODY>" + "</BODY></HTML>"
	}
	oEditor.document.write(hdr);
	oEditor.document.close();
	oEditor.document.body.innerHTML = sHTML;
	oEditor.document.body.contentEditable = true;
	var me = this;
	oEditor.document.addEventListener("keyup", new Function("editorDoc_onkeyup(" + this.oName + ")"), true);
	oEditor.document.addEventListener("mouseup", function (e) {
		editorDoc_onmouseup(e, me.oName)
	},
	true);
	oEditor.document.addEventListener("keydown", new Function("var e=arguments[0];doKeyPress(eval(e), " + this.oName + ")"), false);
	if (this.arrStyle.length > 0) {
		var oElement = oEditor.document.createElement("STYLE");
		oEditor.document.documentElement.childNodes[0].appendChild(oElement);
		var sCssText = "";
		for (var i = 0; i < this.arrStyle.length; i++) {
			selector = this.arrStyle[i][0];
			style = this.arrStyle[i][3];
			sCssText += selector + " { " + style + " } "
		}
		oElement.appendChild(oEditor.document.createTextNode(sCssText))
	}
	if (this.css != "") {
		var objL = oEditor.document.createElement("LINK");
		objL.href = this.css;
		objL.rel = "StyleSheet";
		oEditor.document.documentElement.childNodes[0].appendChild(objL)
	}
	this.cleanDeprecated()
};
function loadHTMLFull(sHTML, firstLoad) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var arrA = String(sHTML).match(/<!DOCTYPE[^>]*>/ig);
	if (arrA) for (var i = 0; i < arrA.length; i++) {
		this.docType = arrA[i]
	} else this.docType = "";
	var arrB = String(sHTML).match(/<HTML[^>]*>/ig);
	if (arrB) for (var i = 0; i < arrB.length; i++) {
		s = arrB[i];
		s = s.replace(/\"[^\"]*\"/ig, function (x) {
			x = x.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/'/g, "&apos;").replace(/\s+/ig, "#_#");
			return x
		});
		s = s.replace(/<([^ >]*)/ig, function (x) {
			return x.toLowerCase()
		});
		s = s.replace(/ ([^=]+)=([^" >]+)/ig, " $1=\"$2\"");
		s = s.replace(/ ([^=]+)=/ig, function (x) {
			return x.toLowerCase()
		});
		s = s.replace(/#_#/ig, " ");
		this.html = s
	} else this.html = "<html>";
	if (this.publishingPath != "") {
		var arrA = sHTML.match(/<base[^>]*>/ig);
		if (!arrA) {
			sHTML = "<BASE HREF=\"" + this.publishingPath + "\"/>" + sHTML
		}
	}
	this.css = "";
	var arrExtCss = String(sHTML).match(/<link[^>]*>/ig);
	if (arrExtCss) for (var i = 0; i < arrExtCss.length; i++) {
		var s = arrExtCss[i];
		var arrTmp = s.split("href=\"");
		if (arrTmp.length > 1) {
			s = arrTmp[1];
			arrTmp = s.split("\"");
			if (arrTmp.length > 1) this.css = arrTmp[0]
		}
	}
	var p1 = 0,
	p2 = sHTML.length;
	var tmp = sHTML.match(/<body[^>]*>/i);
	if (tmp) {
		p1 = sHTML.indexOf(tmp[0]) + tmp[0].length
	}
	tmp = sHTML.match(/<\/body>/i);
	if (tmp) {
		p2 = sHTML.indexOf(tmp[0])
	}
	var head = sHTML.substring(0, p1) + "</html>";
	var cnt = sHTML.substring(p1, p2);
	var foot = sHTML.substr(p2);
	var defaultEditCss = "<link id='tmp_xxinnova' href='" + this.scriptPath + "default_edit.css' type='text/css' rel='stylesheet' />";
	if (head.match(/<head>/gi)) {
		head = head.replace(/<head>/gi, "<head>" + defaultEditCss)
	} else {
		head = head.replace(/<body/gi, "<head>" + defaultEditCss + "</head><body")
	}
	oEditor.document.open("text/html", "replace");
	oEditor.document.write(head + foot);
	oEditor.document.close();
	oEditor.document.body.innerHTML = cnt;
	oEditor.document.body.contentEditable = true;
	var me = this;
	oEditor.document.addEventListener("keyup", new Function("editorDoc_onkeyup(" + me.oName + ")"), true);
	oEditor.document.addEventListener("mouseup", function (e) {
		editorDoc_onmouseup(e, me.oName)
	},
	true);
	oEditor.document.addEventListener("keydown", new Function("var e=arguments[0];doKeyPress(eval(e), " + this.oName + ")"), false);
	this.cleanDeprecated()
};
function putHTML(sHTML) {
	this.loadHTMLFull(sHTML, true)
};
function encodeHTMLCode(sHTML) {
	return sHTML.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;")
};
function cleanHTML(sHTML) {
	var h = sHTML.replace(/<br class="innova" \/>/gi, "").replace(/<br class="innova">/gi, "");
	var sMatch = h.match(/<link[^>]*>/ig);
	if (sMatch) {
		for (var i = 0; i < sMatch.length; i++) {
			if (sMatch[i].indexOf("tmp_xxinnova") != -1) {
				h = h.replace(new RegExp(sMatch[i], "gi"), "")
			}
		}
	}
	return h
};
function getTextBody() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	return oEditor.document.body.textContent
};
function getHTML() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	this.cleanDeprecated();
	sHTML = getOuterHTML(oEditor.document.documentElement);
	sHTML = String(sHTML).replace(/ contentEditable=\"true\"/gi, "");
	sHTML = String(sHTML).replace(/\<PARAM NAME=\"Play\" VALUE=\"0\">/ig, "<PARAM NAME=\"Play\" VALUE=\"-1\">");
	sHTML = this.docType + sHTML;
	sHTML = oUtil.replaceSpecialChar(sHTML);
	if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);
	sHTML = sHTML.replace(/\u00A0+/gi, " ");
	sHTML = cleanHTML(sHTML);
	return sHTML
};
function getHTMLBody() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	this.cleanDeprecated();
	sHTML = oEditor.document.body.innerHTML;
	sHTML = String(sHTML).replace(/ contentEditable=\"true\"/gi, "");
	sHTML = String(sHTML).replace(/\<PARAM NAME=\"Play\" VALUE=\"0\">/ig, "<PARAM NAME=\"Play\" VALUE=\"-1\">");
	sHTML = oUtil.replaceSpecialChar(sHTML);
	if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);
	sHTML = sHTML.replace(/\u00A0+/gi, " ");
	sHTML = cleanHTML(sHTML);
	return sHTML
};
var sBaseHREF = "";
function getXHTML() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	this.cleanDeprecated();
	sHTML = getOuterHTML(oEditor.document.documentElement);
	var arrTmp = sHTML.match(/<BASE([^>]*)>/ig);
	if (arrTmp != null) sBaseHREF = arrTmp[0];
	var arrBase = oEditor.document.getElementsByTagName("BASE");
	if (arrBase.length != null) {
		for (var i = 0; i < arrBase.length; i++) {
			arrBase[i].parentNode.removeChild(arrBase[i])
		}
	}
	sBaseHREF = sBaseHREF.replace(/<([^ >]*)/ig, function (x) {
		return x.toLowerCase()
	});
	sBaseHREF = sBaseHREF.replace(/ [^=]+="[^"]+"/ig, function (x) {
		x = x.replace(/\s+/ig, "#_#");
		x = x.replace(/^#_#/, " ");
		return x
	});
	sBaseHREF = sBaseHREF.replace(/ ([^=]+)=([^" >]+)/ig, " $1=\"$2\"");
	sBaseHREF = sBaseHREF.replace(/ ([^=]+)=/ig, function (x) {
		return x.toLowerCase()
	});
	sBaseHREF = sBaseHREF.replace(/#_#/ig, " ");
	sBaseHREF = sBaseHREF.replace(/>$/ig, " \/>").replace(/\/ \/>$/ig, "\/>");
	sHTML = recur(oEditor.document.documentElement, "");
	sHTML = this.docType + this.html + sHTML + "\n</html>";
	sHTML = sHTML.replace(/<head>/i, "<head>" + sBaseHREF);
	sHTML = sHTML.replace(/\u00A0+/gi, " ");
	sHTML = oUtil.replaceSpecialChar(sHTML);
	if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);
	sHTML = cleanHTML(sHTML);
	return sHTML
};
function getXHTMLBody() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	this.cleanDeprecated();
	sHTML = getOuterHTML(oEditor.document.documentElement);
	var arrTmp = sHTML.match(/<BASE([^>]*)>/ig);
	if (arrTmp != null) sBaseHREF = arrTmp[0];
	var arrBase = oEditor.document.getElementsByTagName("BASE");
	if (arrBase.length != null) {
		for (var i = 0; i < arrBase.length; i++) {
			arrBase[i].parentNode.removeChild(arrBase[i])
		}
	}
	sHTML = recur(oEditor.document.body, "");
	sHTML = oUtil.replaceSpecialChar(sHTML);
	if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);
	sHTML = sHTML.replace(/\u00A0+/gi, " ");
	sHTML = cleanHTML(sHTML);
	return sHTML
};
function ApplyCSS(oName) {
	var sTmp = "";
	var myStyle = document.getElementById("myStyle" + oName).contentWindow;
	for (var i = 0; i < myStyle.document.styleSheets[0].cssRules.length; i++) {
		var sSelector = myStyle.document.styleSheets[0].cssRules[i].selectorText;
		if (sSelector != undefined) {
			sCssText = myStyle.document.styleSheets[0].cssRules[i].style.cssText.replace(/"/g, "&quot;");
			var itemCount = sSelector.split(".").length;
			if (itemCount > 1) {
				sCaption = sSelector.split(".")[1];
				sTmp += ",[\"" + sSelector + "\",true,\"" + sCaption + "\",\"" + sCssText + "\"]"
			} else sTmp += ",[\"" + sSelector + "\",false,\"\",\"" + sCssText + "\"]"
		}
	}
	var arrStyle = eval("[" + sTmp.substr(1) + "]");
	if (arrStyle.length > 0) {
		var oEditor = document.getElementById("idContent" + oName).contentWindow;
		var oElement = oEditor.document.createElement("STYLE");
		oEditor.document.documentElement.childNodes[0].appendChild(oElement);
		var sCssText = "";
		for (var i = 0; i < arrStyle.length; i++) {
			selector = arrStyle[i][0];
			style = arrStyle[i][3].replace(/&quot;/g, "\"");
			sCssText += selector + " { " + style + " } "
		}
		oElement.appendChild(oEditor.document.createTextNode(sCssText))
	}
};
function ApplyExternalStyle(oName) {
	var oEditor = document.getElementById("idContent" + oName).contentWindow;
	var sTmp = "";
	for (var j = 0; j < oEditor.document.styleSheets.length; j++) {
		var myStyle = oEditor.document.styleSheets[j];
		for (var i = 0; i < myStyle.cssRules.length; i++) {
			sSelector = myStyle.cssRules[i].selectorText;
			if (sSelector != undefined) {
				if (sSelector.match(/table\./gi)) {
					continue
				}
				sCssText = myStyle.cssRules[i].style.cssText.replace(/"/g, "&quot;");
				var itemCount = sSelector.split(".").length;
				if (itemCount > 1) {
					sCaption = sSelector.split(".")[1];
					sTmp += ",[\"" + sSelector + "\",true,\"" + sCaption + "\",\"" + sCssText + "\"]"
				} else sTmp += ",[\"" + sSelector + "\",false,\"\",\"" + sCssText + "\"]"
			}
		}
	}
	var arrStyle = eval("[" + sTmp.substr(1) + "]");
	var edtObj = eval(oName);
	for (var i = 0; i < arrStyle.length; i++) {
		for (var j = 0; j < edtObj.arrStyle.length; j++) {
			if (arrStyle[i][0].toLowerCase() == edtObj.arrStyle[j][0].toLowerCase()) {
				arrStyle[i][1] = edtObj.arrStyle[j][1]
			}
		}
	}
	edtObj.arrStyle = arrStyle
};
function doApplyStyle(oName, sClassName) {
	var oEditor = document.getElementById("idContent" + oName).contentWindow;
	var oSel = oEditor.getSelection();
	eval(oName).saveForUndo();
	var element;
	if (oUtil.activeElement) {
		element = oUtil.activeElement;
		element.className = sClassName
	} else {
		element = getSelectedElement(oSel);
		if (isTextSelected(oSel)) {
			if (oSel != "") {
				eval(oName).applySpanStyle([], sClassName)
			} else {
				if (element.tagName == "BODY") return;
				element.className = sClassName
			}
		} else {
			if (element.tagName == "BODY") return;
			element.className = sClassName
		}
	}
	realTime(eval(oName))
};
function openStyleSelect() {
	if (!this.isCssLoaded) ApplyExternalStyle(this.oName);
	this.isCssLoaded = true;
	var idStyles = document.getElementById("idStyles" + this.oName);
	if (idStyles.innerHTML != "") {
		if (idStyles.style.display == "") idStyles.style.display = "none";
		else idStyles.style.display = "";
		return
	}
	idStyles.style.display = "";
	var h = document.getElementById("idContent" + this.oName).offsetHeight - 27;
	var arrStyle = this.arrStyle;
	var sHTML = "";
	sHTML += "<div unselectable=on style='margin:5px;margin-top:0;margin-right:0' align='left'>";
	sHTML += "<table style='margin:1px;margin-top:2px;margin-bottom:3px;width:14px;height:14px;background:#f4f4f4;' cellpadding=0 cellspacing=0 unselectable=on>" + "<tr><td onclick=\"" + this.oName + ".openStyleSelect();\" onmouseover=\"this.style.border='#708090 1px solid';this.style.color='white';this.style.backgroundColor='9FA7BB'\" onmouseout=\"this.style.border='white 1px solid';this.style.color='black';this.style.backgroundColor=''\" style=\"cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;\" align=center valign=top unselectable=on>x</td></tr>" + "</table>";
	var sBody = "";
	for (var i = 0; i < arrStyle.length; i++) {
		sSelector = arrStyle[i][0];
		if (sSelector == "body") sBody = arrStyle[i][3]
	}
	sHTML += "<div unselectable=on style='overflow:auto;width:200px;height:" + h + "px;'>";
	sHTML += "<table name='tblStyles" + this.oName + "' id='tblStyles" + this.oName + "' cellpadding=0 cellspacing=0 style='background:#fcfcfc;" + sBody + ";height:100%;width:100%;margin:0;'>";
	for (var i = 0; i < arrStyle.length; i++) {
		sSelector = arrStyle[i][0];
		isOnSelection = arrStyle[i][1];
		sCssText = arrStyle[i][3];
		sCaption = arrStyle[i][2];
		if (isOnSelection) {
			if (sSelector.split(".").length > 1) {
				var tmpSelector = sSelector;
				if (sSelector.indexOf(":") > 0) tmpSelector = sSelector.substring(0, sSelector.indexOf(":"));
				sHTML += "<tr style=\"cursor:default\" onmouseover=\"if(this.style.marginRight!='1px'){this.style.background='" + this.styleSelectionHoverBg + "';this.style.color='" + this.styleSelectionHoverFg + "'}\" onmouseout=\"if(this.style.marginRight!='1px'){this.style.background='';this.style.color=''}\">";
				sHTML += "<td unselectable=on onclick=\"doApplyStyle('" + this.oName + "','" + tmpSelector.split(".")[1] + "')\" style='padding:2px'>";
				if (sSelector.split(".")[0] == "") sHTML += "<span unselectable=on style=\"" + sCssText + ";margin:0;\">" + sCaption + "</span>";
				else sHTML += "<span unselectable=on style=\"" + sCssText + ";margin:0;\">" + sSelector + "</span>";
				sHTML += "</td></tr>"
			}
		}
	}
	sHTML += "<tr><td height=100%>&nbsp;</td></tr></table></div>";
	sHTML += "</div>";
	document.getElementById("idStyles" + this.oName).innerHTML = sHTML
};
function cleanFonts() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var allFonts = oEditor.document.body.getElementsByTagName("FONT");
	if (allFonts.length == 0) return false;
	var f;
	var range;
	while (allFonts.length > 0) {
		f = allFonts[0];
		if (f.hasChildNodes && f.childNodes.length == 1 && f.childNodes[0].nodeType == 1 && f.childNodes[0].nodeName == "SPAN") {
			var theSpan = f.childNodes[0];
			copyAttribute(theSpan, f);
			range = oEditor.document.createRange();
			range.selectNode(f);
			range.insertNode(theSpan);
			range.selectNode(f);
			range.deleteContents()
		} else if (f.parentNode.nodeName == "SPAN" && f.parentNode.childNodes.length == 1) {
			var theSpan = f.parentNode;
			copyAttribute(theSpan, f);
			theSpan.innerHTML = f.innerHTML
		} else {
			var newSpan = oEditor.document.createElement("SPAN");
			copyAttribute(newSpan, f);
			newSpan.innerHTML = f.innerHTML;
			f.parentNode.replaceChild(newSpan, f)
		}
	}
	return true
};
function cleanTags(elements, sVal) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	if (elements.length == 0) return false;
	var f;
	var range;
	while (elements.length > 0) {
		f = elements[0];
		if (f.hasChildNodes && f.childNodes.length == 1 && f.childNodes[0].nodeType == 1 && f.childNodes[0].nodeName == "SPAN") {
			var theSpan = f.childNodes[0];
			if (sVal == "bold") theSpan.style.fontWeight = "bold";
			if (sVal == "italic") theSpan.style.fontStyle = "italic";
			if (sVal == "line-through") theSpan.style.textDecoration = "line-through";
			if (sVal == "underline") theSpan.style.textDecoration = "underline";
			range = oEditor.document.createRange();
			range.selectNode(f);
			range.insertNode(theSpan);
			range.selectNode(f);
			range.deleteContents()
		} else if (f.parentNode.nodeName == "SPAN" && f.parentNode.childNodes.length == 1) {
			var theSpan = f.parentNode;
			if (sVal == "bold") theSpan.style.fontWeight = "bold";
			if (sVal == "italic") theSpan.style.fontStyle = "italic";
			if (sVal == "line-through") theSpan.style.textDecoration = "line-through";
			if (sVal == "underline") theSpan.style.textDecoration = "underline";
			theSpan.innerHTML = f.innerHTML
		} else {
			var newSpan = oEditor.document.createElement("SPAN");
			if (sVal == "bold") newSpan.style.fontWeight = "bold";
			if (sVal == "italic") newSpan.style.fontStyle = "italic";
			if (sVal == "line-through") newSpan.style.textDecoration = "line-through";
			if (sVal == "underline") newSpan.style.textDecoration = "underline";
			newSpan.innerHTML = f.innerHTML;
			f.parentNode.replaceChild(newSpan, f)
		}
	}
	return true
};
function replaceTags(sFrom, sTo) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var elements = oEditor.document.body.getElementsByTagName(sFrom);
	while (elements.length > 0) {
		f = elements[0];
		var newSpan = oEditor.document.createElement(sTo);
		newSpan.innerHTML = f.innerHTML;
		f.parentNode.replaceChild(newSpan, f)
	}
};
function cleanDeprecated() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var elements;
	elements = oEditor.document.body.getElementsByTagName("B");
	this.cleanTags(elements, "bold");
	elements = oEditor.document.body.getElementsByTagName("I");
	this.cleanTags(elements, "italic");
	elements = oEditor.document.body.getElementsByTagName("STRIKE");
	this.cleanTags(elements, "line-through");
	elements = oEditor.document.body.getElementsByTagName("S");
	this.cleanTags(elements, "line-through");
	elements = oEditor.document.body.getElementsByTagName("U");
	this.cleanTags(elements, "underline");
	this.replaceTags("DIR", "DIV");
	this.replaceTags("MENU", "DIV");
	this.replaceTags("CENTER", "DIV");
	this.replaceTags("XMP", "PRE");
	this.replaceTags("BASEFONT", "SPAN");
	elements = oEditor.document.body.getElementsByTagName("APPLET");
	while (elements.length > 0) {
		var f = elements[0];
		theParent = f.parentNode;
		theParent.removeChild(f)
	}
	this.cleanFonts();
	this.cleanEmptySpan();
	return true
};
function applySpanStyle(arrStyles, sClassName, blockTag) {
	var useBlock = "SPAN";
	if (blockTag != null && blockTag != "") useBlock = blockTag;
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var range;
	var oElement;
	if (!isTextSelected(oSel)) {
		range = oSel.getRangeAt(0);
		oElement = getSelectedElement(oSel);
		if (oElement.nodeName == useBlock) return oElement;
		return
	}
	this.hide();
	this.doCmd("fontname", "verdana");
	oElement = getSelectedElement(oSel);
	oElement.style.fontFamily = "";
	replaceWithSpan(oEditor, arrStyles, sClassName, useBlock);
	realTime(this)
};
function doClean() {
	this.saveForUndo();
	if (oUtil.activeElement) var element = oUtil.activeElement;
	else {
		var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
		var oSel = oEditor.getSelection();
		element = getSelectedElement(oSel);
		if (isTextSelected(oSel)) {
			if (oSel != "") {
				var range = oSel.getRangeAt(0);
				if (element.innerHTML != range.toString()) {
					this.doCmd('RemoveFormat');
					realTime(this);
					return
				}
			} else {
				if (element.tagName == "BODY") return
			}
		} else {
			if (element.tagName == "BODY") return
		}
	}
	element.removeAttribute("className");
	element.removeAttribute("style");
	if (element.tagName == "H1" || element.tagName == "H2" || element.tagName == "H3" || element.tagName == "H4" || element.tagName == "H5" || element.tagName == "H6" || element.tagName == "PRE" || element.tagName == "P" || element.tagName == "DIV") {
		this.doCmd('FormatBlock', '<P>')
	}
	this.doCmd('RemoveFormat');
	realTime(this)
};
function cleanEmptySpan() {
	var bReturn = false;
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var reg = /<\s*SPAN\s*>/gi;
	while (true) {
		var allSpans = oEditor.document.getElementsByTagName("SPAN");
		if (allSpans.length == 0) break;
		var emptySpans = [];
		for (var i = 0; i < allSpans.length; i++) {
			if (allSpans[i].className == "Apple-style-span") allSpans[i].removeAttribute("class", 0);
			if (allSpans[i].style.cssText == "") allSpans[i].removeAttribute("style", 0);
			if (getOuterHTML(allSpans[i]).search(reg) == 0) emptySpans[emptySpans.length] = allSpans[i]
		}
		if (emptySpans.length == 0) break;
		var theSpan, theParent;
		for (var i = 0; i < emptySpans.length; i++) {
			theSpan = emptySpans[i];
			theParent = theSpan.parentNode;
			if (!theParent) continue;
			if (theSpan.hasChildNodes()) {
				var range = oEditor.document.createRange();
				range.selectNodeContents(theSpan);
				var docFrag = range.extractContents();
				theParent.replaceChild(docFrag, theSpan)
			} else {
				theParent.removeChild(theSpan)
			}
			bReturn = true
		}
	}
	return bReturn
};
function copyStyleClass(newSpan, arrStyles, sClassName) {
	if (arrStyles) {
		for (var i = 0; i < arrStyles.length; i++) {
			newSpan.style[arrStyles[i][0]] = arrStyles[i][1]
		}
		if (newSpan.style.cssText == "") newSpan.removeAttribute("style", 0)
	}
	if (sClassName) newSpan.className = sClassName
};
function copyAttribute(newSpan, f) {
	if ((f.face != null) && (f.face != "")) newSpan.style.fontFamily = f.face;
	if ((f.size != null) && (f.size != "")) {
		var nSize = "";
		if (f.size == 1) nSize = "8pt";
		else if (f.size == 2) nSize = "10pt";
		else if (f.size == 3) nSize = "12pt";
		else if (f.size == 4) nSize = "14pt";
		else if (f.size == 5) nSize = "18pt";
		else if (f.size == 6) nSize = "24pt";
		else if (f.size >= 7) nSize = "36pt";
		else if (f.size <= -2 || f.size == "0") nSize = "8pt";
		else if (f.size == "-1") nSize = "10pt";
		else if (f.size == 0) nSize = "12pt";
		else if (f.size == "+1") nSize = "14pt";
		else if (f.size == "+2") nSize = "18pt";
		else if (f.size == "+3") nSize = "24pt";
		else if (f.size == "+4" || f.size == "+5" || f.size == "+6") nSize = "36pt";
		else nSize = "";
		if (nSize != "") newSpan.style.fontSize = nSize
	}
	if ((f.style.backgroundColor != null) && (f.style.backgroundColor != "")) newSpan.style.backgroundColor = f.style.backgroundColor;
	if ((f.color != null) && (f.color != "")) newSpan.style.color = f.color;
	if ((f.className != null) && (f.className != "")) newSpan.className = f.className
};
function replaceWithSpan(oEditor, arrStyles, sClassName, blockTag) {
	var useBlock = "SPAN";
	if (blockTag != null && blockTag != "") useBlock = blockTag;
	var oSel = oEditor.getSelection();
	var elm = getSelectedElement(oSel);
	if (arrStyles || sClassName) copyStyleClass(elm, arrStyles, sClassName)
};
function editorDoc_onkeyup(oEdt) {
	if (oEdt.tmKeyup) {
		clearTimeout(oEdt.tmKeyup);
		oEdt.tmKeyup = null
	}
	if (!oEdt.tmKeyup) oEdt.tmKeyup = setTimeout(function () {
		realTime(oEdt)
	},
	1000)
};
function editorDoc_onmouseup(e, oName) {
	var edtObj = eval(oName);
	var edtFrm = document.getElementById("idContent" + oName);
	oUtil.activeElement = null;
	oUtil.oName = oName;
	oUtil.oEditor = edtFrm.contentWindow;
	oUtil.obj = edtObj;
	edtObj.hide();
	if (e.target && e.target.tagName && e.target.tagName == 'IMG') {
		var oSel = edtFrm.contentWindow.getSelection();
		var range = oSel.getRangeAt(0);
		oSel.removeAllRanges();
		range.selectNodeContents(e.target);
		range.setEndAfter(e.target);
		oSel.addRange(range)
	}
	realTime(edtObj)
};
function setActiveEditor(edtObj) {
	oUtil.oName = edtObj.oName;
	oUtil.oEditor = document.getElementById("idContent" + edtObj.oName).contentWindow;
	oUtil.obj = edtObj
};
var arrTmp = [];
function GetElement(oElement, sMatchTag) {
	while (oElement != null && oElement.tagName != sMatchTag) {
		if (oElement.tagName == "BODY") return null;
		oElement = oElement.parentNode
	}
	return oElement
};
var arrTmp2 = [];
function realTime(edtObj) {
	try {
		var oName = edtObj.oName;
		var oEditor = document.getElementById("idContent" + oName).contentWindow;
		var oSel = oEditor.getSelection();
		var element = getSelectedElement(oSel);
		var obj = edtObj;
		var tbar = obj.tbar;
		var btn = null;
		if (obj.btnTable) {
			var btn = tbar.btns["btnTableEdit" + oName];
			var ddTbl = isDDs[btn.ddId];
			ddTbl.enableItem("mnuTableSize" + oName, true);
			ddTbl.enableItem("mnuTableEdit" + oName, true);
			ddTbl.enableItem("mnuCellEdit" + oName, true);
			var oTable = GetElement(element, "TABLE");
			if (oTable) {
				ddTbl.enableItem("mnuCellEdit" + oName, false);
				btn.setState(1)
			} else btn.setState(5);
			var oTD = GetElement(element, "TD");
			if (oTD) {
				ddTbl.enableItem("mnuCellEdit" + oName, true)
			}
		}
		var doc = oEditor.document;
		if (obj.btnParagraph) {
			btn = tbar.btns["btnParagraph" + oName];
			btn.setState(doc.queryCommandEnabled("FormatBlock") ? 1 : 5)
		}
		if (obj.btnFontName) {
			btn = tbar.btns["btnFontName" + oName];
			btn.setState(doc.queryCommandEnabled("FontName") ? 1 : 5)
		}
		if (obj.btnFontSize) {
			btn = tbar.btns["btnFontSize" + oName];
			btn.setState(doc.queryCommandEnabled("FontSize") ? 1 : 5)
		}
		if (obj.btnUndo) {
			btn = tbar.btns["btnUndo" + oName];
			btn.setState(!obj.arrUndoList[0] ? 5 : 1)
		}
		if (obj.btnRedo) {
			btn = tbar.btns["btnRedo" + oName];
			btn.setState(!obj.arrRedoList[0] ? 5 : 1)
		}
		if (obj.btnBold) {
			btn = tbar.btns["btnBold" + oName];
			btn.setState(doc.queryCommandEnabled("Bold") ? (doc.queryCommandState("Bold") ? 4 : 1) : 5)
		}
		if (obj.btnItalic) {
			btn = tbar.btns["btnItalic" + oName];
			btn.setState(doc.queryCommandEnabled("Italic") ? (doc.queryCommandState("Italic") ? 4 : 1) : 5)
		}
		if (obj.btnUnderline) {
			btn = tbar.btns["btnUnderline" + oName];
			btn.setState(doc.queryCommandEnabled("Underline") ? (doc.queryCommandState("Underline") ? 4 : 1) : 5)
		}
		if (obj.btnStrikethrough) {
			btn = tbar.btns["btnStrikethrough" + oName];
			btn.setState(doc.queryCommandEnabled("Strikethrough") ? (doc.queryCommandState("Strikethrough") ? 4 : 1) : 5)
		}
		if (obj.btnSuperscript) {
			btn = tbar.btns["btnSuperscript" + oName];
			btn.setState(doc.queryCommandEnabled("Superscript") ? (doc.queryCommandState("Superscript") ? 4 : 1) : 5)
		}
		if (obj.btnSubscript) {
			btn = tbar.btns["btnSubscript" + oName];
			btn.setState(doc.queryCommandEnabled("Subscript") ? (doc.queryCommandState("Subscript") ? 4 : 1) : 5)
		}
		if (obj.btnNumbering) {
			btn = tbar.btns["btnNumbering" + oName];
			btn.setState(doc.queryCommandEnabled("InsertOrderedList") ? (doc.queryCommandState("InsertOrderedList") ? 4 : 1) : 5)
		}
		if (obj.btnBullets) {
			btn = tbar.btns["btnBullets" + oName];
			btn.setState(doc.queryCommandEnabled("InsertUnorderedList") ? (doc.queryCommandState("InsertUnorderedList") ? 4 : 1) : 5)
		}
		if (obj.btnJustifyLeft) {
			btn = tbar.btns["btnJustifyLeft" + oName];
			btn.setState(doc.queryCommandEnabled("JustifyLeft") ? (doc.queryCommandState("JustifyLeft") ? 4 : 1) : 5)
		}
		if (obj.btnJustifyCenter) {
			btn = tbar.btns["btnJustifyCenter" + oName];
			btn.setState(doc.queryCommandEnabled("JustifyCenter") ? (doc.queryCommandState("JustifyCenter") ? 4 : 1) : 5)
		}
		if (obj.btnJustifyRight) {
			btn = tbar.btns["btnJustifyRight" + oName];
			btn.setState(doc.queryCommandEnabled("JustifyRight") ? (doc.queryCommandState("JustifyRight") ? 4 : 1) : 5)
		}
		if (obj.btnJustifyFull) {
			btn = tbar.btns["btnJustifyFull" + oName];
			btn.setState(doc.queryCommandEnabled("JustifyFull") ? (doc.queryCommandState("JustifyFull") ? 4 : 1) : 5)
		}
		if (obj.btnIndent) {
			btn = tbar.btns["btnIndent" + oName];
			btn.setState(doc.queryCommandEnabled("Indent") ? 1 : 5)
		}
		if (obj.btnOutdent) {
			btn = tbar.btns["btnOutdent" + oName];
			btn.setState(doc.queryCommandEnabled("Outdent") ? 1 : 5)
		}
		if (obj.btnLTR) {
			btn = tbar.btns["btnLTR" + oName];
			btn.setState(element.dir ? (element.dir.toLowerCase() == "ltr" ? 4 : 1) : 1)
		}
		if (obj.btnRTL) {
			btn = tbar.btns["btnRTL" + oName];
			btn.setState(element.dir ? (element.dir.toLowerCase() == "rtl" ? 4 : 1) : 1)
		}
		var v = (element ? 1 : 5);
		if (obj.btnForeColor) tbar.btns["btnForeColor" + oName].setState(v);
		if (obj.btnBackColor) tbar.btns["btnBackColor" + oName].setState(v);
		if (obj.btnLine) tbar.btns["btnLine" + oName].setState(v);
		try {
			oUtil.onSelectionChanged()
		} catch(e) {}
		try {
			obj.onSelectionChanged()
		} catch(e) {}
		var idStyles = document.getElementById("idStyles" + oName);
		if (idStyles.innerHTML != "") {
			var oElement;
			if (oUtil.activeElement) oElement = oUtil.activeElement;
			else oElement = getSelectedElement(oSel);
			var sCurrClass = oElement.className;
			var oRows = document.getElementById("tblStyles" + oName).rows;
			for (var i = 0; i < oRows.length - 1; i++) {
				sClass = oRows[i].childNodes[0].childNodes[0].innerHTML;
				if (sClass.split(".").length > 1 && sClass != "") sClass = sClass.split(".")[1];
				if (sCurrClass == sClass) {
					oRows[i].style.marginRight = "1px";
					oRows[i].style.backgroundColor = obj.styleSelectionHoverBg;
					oRows[i].style.color = obj.styleSelectionHoverFg
				} else {
					oRows[i].style.marginRight = "";
					oRows[i].style.backgroundColor = "";
					oRows[i].style.color = ""
				}
			}
		}
		if (obj.useTagSelector) {
			oElement = element;
			var sHTML = "";
			var i = 0;
			arrTmp2 = [];
			while (oElement != null && oElement.tagName != "BODY" && oElement.nodeType == 1) {
				arrTmp2[i] = oElement;
				sHTML = "&nbsp; &lt;<span id=tag" + oName + i + " unselectable=on style='text-decoration:underline;cursor:pointer' onclick=\"" + oName + ".selectElement(" + i + ")\">" + oElement.tagName + "</span>&gt;" + sHTML;
				oElement = oElement.parentNode;
				i++
			}
			sHTML = "&nbsp;&lt;BODY&gt;" + sHTML;
			document.getElementById("idElNavigate" + oName).innerHTML = sHTML;
			document.getElementById("idElCommand" + oName).style.display = "none";
			for (i = 0; i < arrTmp2.length; i++) {
				document.getElementById("tag" + oName + i).addEventListener("click", new Function(oName + ".selectElement(" + i + ")"), true)
			}
		}
	} catch(e) {}
};
function realtimeFontSelect(oName) {
	var oEditor = document.getElementById("idContent" + oName).contentWindow;
	var sFontName = oEditor.document.queryCommandValue("FontName");
	var edt = eval(oName);
	var found = false;
	for (var i = 0; i < edt.arrFontName.length; i++) {
		if (sFontName == edt.arrFontName[i]) {
			found = true;
			break
		}
	}
	if (found) {
		isDDs["ddFontName" + oName].selectItem("btnFontName_" + i + oName, true)
	} else {
		isDDs["ddFontName" + oName].clearSelection()
	}
};
function realtimeSizeSelect(oName) {
	var oEditor = document.getElementById("idContent" + oName).contentWindow;
	var sFontSize = oEditor.document.queryCommandValue("FontSize");
	var edt = eval(oName);
	var found = false;
	for (var i = 0; i < edt.arrFontSize.length; i++) {
		if (sFontSize == edt.arrFontSize[i][1]) {
			found = true;
			break
		}
	}
	if (found) {
		isDDs["ddFontSize" + oName].selectItem("btnFontSize_" + i + oName, true)
	} else {
		isDDs["ddFontSize" + oName].clearSelection()
	}
};
function moveTagSelector() {
	var edtArea = document.getElementById("idArea" + this.oName);
	var nWidth = edtArea.offsetWidth - 90;
	var icPath = this.scriptPath.substring(0, this.scriptPath.indexOf("saf/")) + this.iconPath;
	var sTagSelTop = "<table unselectable=on ondblclick='" + this.oName + ".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border:#cfcfcf 1px solid;border-bottom:none'><tr style='background-color:#f4f4f4;font-family:arial;font-size:10px;color:black;'>" + "<td id=idElNavigate" + this.oName + " style='padding:1px;width:" + nWidth + "px' valign=top>&nbsp;</td>" + "<td align=right valign='center' nowrap>" + "<span id=idElCommand" + this.oName + " unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='" + this.oName + ".removeTag()'>" + getTxt("Remove Tag") + "</span>" + "</td></tr></table>";
	var sTagSelBottom = "<table unselectable=on ondblclick='" + this.oName + ".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border-left:#cfcfcf 1px solid;border-right:#cfcfcf 1px solid;'><tr style='background-color:#f4f4f4;font-family:arial;font-size:10px;color:black;'>" + "<td id=idElNavigate" + this.oName + " style='padding:1px;width:" + nWidth + "px' valign=top>&nbsp;</td>" + "<td align=right valign='center' nowrap>" + "<span id=idElCommand" + this.oName + " unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='" + this.oName + ".removeTag()'>" + getTxt("Remove Tag") + "</span>" + "</td></tr></table>";
	var selTop = document.getElementById("idTagSelTop" + this.oName);
	var selTopRow = document.getElementById("idTagSelTopRow" + this.oName);
	var selBottom = document.getElementById("idTagSelBottom" + this.oName);
	var selBottomRow = document.getElementById("idTagSelBottomRow" + this.oName);
	if (this.TagSelectorPosition == "top") {
		selTop.innerHTML = "";
		selBottom.innerHTML = sTagSelBottom;
		selTopRow.style.display = "none";
		selBottomRow.style.display = "";
		this.TagSelectorPosition = "bottom"
	} else {
		selTop.innerHTML = sTagSelTop;
		selBottom.innerHTML = "";
		selTopRow.style.display = "";
		selBottomRow.style.display = "none";
		this.TagSelectorPosition = "top"
	}
};
function selectElement(i) {
	if (!this.useTagSelector) return;
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var range = oEditor.document.createRange();
	range.selectNode(arrTmp2[i]);
	var oSel = oEditor.getSelection();
	oSel.removeAllRanges();
	oSel.addRange(range);
	oActiveElement = arrTmp2[i];
	if (oActiveElement.tagName != "TD" && oActiveElement.tagName != "TR" && oActiveElement.tagName != "TBODY" && oActiveElement.tagName != "LI") document.getElementById("idElCommand" + this.oName).style.display = "";
	for (var j = 0; j < arrTmp2.length; j++) document.getElementById("tag" + this.oName + j).style.background = "";
	document.getElementById("tag" + this.oName + i).style.background = "DarkGray";
	if (oActiveElement) oUtil.activeElement = oActiveElement;
	this.focus()
};
function removeTag() {
	this.saveForUndo();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var element = getSelectedElement(oSel);
	var nearElement = element.nextSibling == null ? (element.previousSibling == null ? element.parentNode: element.previousSibling) : element.nextSibling;
	switch (element.nodeName) {
	case "TABLE":
		;
	case "IMG":
		;
	case "INPUT":
		;
	case "FORM":
		;
	case "SELECT":
		element.parentNode.removeChild(element);
		break;
	default:
		oSel = oEditor.getSelection();
		var range = oSel.getRangeAt(0);
		var docFrag = range.createContextualFragment(element.innerHTML);
		range.selectNode(element);
		range.deleteContents();
		range.insertNode(docFrag);
		try {
			oEditor.document.designMode = "on"
		} catch(e) {}
		break
	}
	oSel = oEditor.getSelection();
	oSel.removeAllRanges();
	var range = oEditor.document.createRange();
	range.setStart(nearElement, 0);
	range.setEnd(nearElement, 0);
	oSel.addRange(range);
	this.focus();
	realTime(this)
};
function doCmd(sCmd, sOption) {
	if (sCmd == "Bold" || sCmd == "Italic" || sCmd == "Underline" || sCmd == "Strikethrough" || sCmd == "Superscript" || sCmd == "Subscript" || sCmd == "Indent" || sCmd == "Outdent" || sCmd == "InsertHorizontalRule") this.saveForUndo();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	oEditor.document.execCommand("styleWithCSS", false, true);
	oEditor.document.execCommand(sCmd, false, sOption);
	realTime(this)
};
function applyColor(sType, sColor) {
	this.hide();
	this.focus();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	this.saveForUndo();
	if (sColor != null && sColor != "") {
		oEditor.document.execCommand("styleWithCSS", false, true);
		oEditor.document.execCommand(sType, false, sColor);
		var sel = oEditor.getSelection();
		var range = sel.getRangeAt(0);
		if (range.startContainer.nodeType == Node.TEXT_NODE) {
			var el = range.startContainer.nextSibling;
			if (el) {
				range = oEditor.document.createRange();
				range.selectNode(el);
				sel = oEditor.getSelection();
				sel.removeAllRanges();
				sel.addRange(range)
			}
		}
	} else {
		var el = getSelectedElement(oEditor.getSelection());
		if (sType == "ForeColor") {
			el.style.color = ""
		} else if (sType == "HiliteColor") {
			el.style.backgroundColor = ""
		}
	}
	realTime(this);
	if (sColor == "") return
};
function applyParagraph(val) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	this.hide();
	this.saveForUndo();
	this.doCmd("FormatBlock", val)
};
function applyFontName(val) {
	this.hide();
	this.saveForUndo();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oElement = getSelectedElement(oSel);
	if (oElement != null && oElement.tagName == "SPAN") {
		oElement.style.fontFamily = val
	} else {
		this.doCmd("fontname", val)
	}
};
function applyFontSize(val) {
	this.hide();
	this.saveForUndo();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oElement = getSelectedElement(oSel);
	if (oElement != null && oElement.tagName == "SPAN") {
		oElement.style.fontSize = mapFontSize(val)
	} else {
		this.doCmd("fontsize", val);
		oSel = oEditor.getSelection();
		oElement = getSelectedElement(oSel);
		if (oElement != null) oElement.style.fontSize = mapFontSize(val)
	}
	realTime(this)
};
function mapFontSize(v) {
	var s = "8pt";
	if (v == 1) s = "8pt";
	else if (v == 2) s = "10pt";
	else if (v == 3) s = "12pt";
	else if (v == 4) s = "14pt";
	else if (v == 5) s = "18pt";
	else if (v == 6) s = "24pt";
	else if (v >= 7) s = "36pt";
	else if (v <= -2 || v == "0") s = "8pt";
	else if (v == "-1") s = "10pt";
	else if (v == 0) s = "12pt";
	else if (v == "+1") s = "14pt";
	else if (v == "+2") s = "18pt";
	else if (v == "+3") s = "24pt";
	else if (v == "+4" || v == "+5" || v == "+6") s = "36pt";
	return s
};
function applyFormattingStyle(cmd, opt) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oElement = getSelectedElement(oSel);
	var doc = oEditor.document;
	if (oElement != null && oElement.tagName == "SPAN") {
		if (cmd == "Bold" || cmd == "Italic" || cmd == "Underline" || cmd == "Strikethrough" || cmd == "Superscript" || cmd == "Subscript") {
			this.saveForUndo();
			switch (cmd) {
			case "Bold":
				oElement.style.fontWeight = (!doc.queryCommandState("Bold") ? "bold": "");
				break;
			case "Italic":
				oElement.style.fontStyle = (!doc.queryCommandState("Italic") ? "italic": "");
				break;
			case "Underline":
				oElement.style.textDecoration = (!doc.queryCommandState("Underline") ? "underline": "");
				break;
			case "Strikethrough":
				oElement.style.textDecoration = (!doc.queryCommandState("Strikethrough") ? "line-through": "");
				break;
			case "Superscript":
				oElement.style.verticalAlign = (!doc.queryCommandState("Superscript") ? "super": "");
				break;
			case "Subscript":
				oElement.style.verticalAlign = (!doc.queryCommandState("Subscript") ? "sub": "");
				break
			}
			realTime(this)
		}
	} else {
		this.doCmd(cmd, opt)
	}
};
function applyBullets() {
	this.saveForUndo();
	this.doCmd("InsertUnOrderedList");
	this.tbar.btns["btnNumbering" + this.oName].setState(1);
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oElement = getSelectedElement(oSel);
	while (oElement != null && oElement.tagName != "OL" && oElement.tagName != "UL") {
		if (oElement.tagName == "BODY") return;
		oElement = oElement.parentNode
	}
	oElement.removeAttribute("type", 0);
	oElement.style.listStyleImage = ""
};
function applyNumbering() {
	this.saveForUndo();
	this.doCmd("InsertOrderedList");
	this.tbar.btns["btnBullets" + this.oName].setState(1);
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oElement = getSelectedElement(oSel);
	while (oElement != null && oElement.tagName != "OL" && oElement.tagName != "UL") {
		if (oElement.tagName == "BODY") return;
		oElement = oElement.parentNode
	}
	oElement.removeAttribute("type", 0);
	oElement.style.listStyleImage = ""
};
function applyJustifyLeft() {
	this.saveForUndo();
	this.doCmd("JustifyLeft")
};
function applyJustifyCenter() {
	this.saveForUndo();
	this.doCmd("JustifyCenter")
};
function applyJustifyRight() {
	this.saveForUndo();
	this.doCmd("JustifyRight")
};
function applyJustifyFull() {
	this.saveForUndo();
	this.doCmd("JustifyFull")
};
function applyBlockDirLTR() {
	this.saveForUndo();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oEl = getSelectedElement(oSel);
	if (oEl.dir) oEl.removeAttribute("dir");
	else oEl.dir = "ltr";
	this.focus()
};
function applyBlockDirRTL() {
	this.saveForUndo();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oEl = getSelectedElement(oSel);
	if (oEl.dir) oEl.removeAttribute("dir");
	else oEl.dir = "rtl";
	this.focus()
};
function insertCustomTag(index) {
	this.insertHTML(this.arrCustomTag[index][1]);
	this.hide();
	this.focus()
};
function expandSelection() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	if (range.startContainer.nodeType == Node.TEXT_NODE) {
		if (range.toString() == "") {
			var sPos = range.startOffset;
			var ePos = range.endOffset;
			var startCont = range.startContainer;
			var str = startCont.nodeValue;
			sPos = str.substring(0, range.startOffset).search(/(\W+\w*)$/i);
			sPos = sPos == -1 ? 0 : sPos;
			var tPos = str.substring(sPos, range.startOffset).search(/\w+/i);
			sPos += (tPos == -1 ? str.substring(sPos, range.startOffset).length: tPos);
			ePos = str.substr(range.endOffset).search(/\W+/i);
			ePos = ePos == -1 ? str.length: ePos + range.endOffset;
			range = oEditor.document.createRange();
			range.setStart(startCont, sPos);
			range.setEnd(startCont, ePos);
			oSel = oEditor.getSelection();
			oSel.removeAllRanges();
			oSel.addRange(range)
		}
	}
	return
};
function selectParagraph() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var selParent = getSelectedElement(oSel);
	if (selParent) {
		if (oSel.getRangeAt(0).toString() == "") {
			var oElement = selParent;
			while (oElement != null && oElement.tagName != "H1" && oElement.tagName != "H2" && oElement.tagName != "H3" && oElement.tagName != "H4" && oElement.tagName != "H5" && oElement.tagName != "H6" && oElement.tagName != "PRE" && oElement.tagName != "P" && oElement.tagName != "DIV") {
				if (oElement.tagName == "BODY") return;
				oElement = oElement.parentNode
			}
			var range = oEditor.document.createRange();
			range.selectNode(oElement);
			oSel = oEditor.getSelection();
			oSel.removeAllRanges();
			oSel.addRange(range)
		}
	}
};
function insertHTML(sHTML) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	this.saveForUndo();
	var docFrag = range.createContextualFragment(sHTML);
	range.collapse(false);
	var lastNode = docFrag.childNodes[docFrag.childNodes.length - 1];
	range.insertNode(docFrag);
	if (lastNode.nodeType == Node.TEXT_NODE) {
		range = oEditor.document.createRange();
		range.setStart(lastNode, lastNode.nodeValue.length);
		range.setEnd(lastNode, lastNode.nodeValue.length);
		oSel = oEditor.getSelection();
		oSel.removeAllRanges();
		oSel.addRange(range)
	}
};
function insertLink(url, title, target, rel) {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	this.saveForUndo();
	var emptySel = false;
	if (range.toString() == "") {
		if (range.startContainer.nodeType == Node.ELEMENT_NODE) {
			if (range.startContainer.childNodes[range.startOffset].nodeType != Node.TEXT_NODE) {
				if (range.startContainer.childNodes[range.startOffset].nodeName == "BR") emptySel = true;
				else emptySel = false
			} else {
				emptySel = true
			}
		} else {
			emptySel = true
		}
		if (emptySel) {
			var cap = (title != "" && title != null ? title: url);
			var node = oEditor.document.createTextNode(cap);
			range.insertNode(node);
			try {
				oEditor.document.designMode = "on"
			} catch(e) {}
			range = oEditor.document.createRange();
			range.setStart(node, 0);
			range.setEnd(node, cap.length);
			oSel = oEditor.getSelection();
			oSel.removeAllRanges();
			oSel.addRange(range)
		}
	}
	var isSelInMidText = (range.startContainer.nodeType == Node.TEXT_NODE) && (range.startOffset > 0);
	oEditor.document.execCommand("styleWithCSS", false, true);
	oEditor.document.execCommand("CreateLink", false, url);
	oSel = oEditor.getSelection();
	range = oSel.getRangeAt(0);
	if (range.startContainer.nodeType == Node.TEXT_NODE) {
		var node = (emptySel || !isSelInMidText ? range.startContainer.parentNode: range.startContainer.nextSibling);
		range = oEditor.document.createRange();
		range.selectNode(node);
		oSel = oEditor.getSelection();
		oSel.removeAllRanges();
		oSel.addRange(range)
	}
	var oEl = range.startContainer.childNodes[range.startOffset];
	if (oEl) {
		if (target != "" && target != undefined) oEl.target = target;
		if (rel != "" && rel != undefined) oEl.setAttribute("rel", rel)
	}
};
function clearAll() {
	if (confirm(getTxt("Are you sure you wish to delete all contents?")) == true) {
		this.saveForUndo();
		var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
		oEditor.document.body.innerHTML = "<BR>";
		oEditor.focus()
	}
};
function applySpan(blockTag) {
	var useBlock = "SPAN";
	if (blockTag != null && blockTag != "") useBlock = blockTag;
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var range;
	var oElement;
	var sHTML;
	if (!isTextSelected(oSel)) {
		range = oSel.getRangeAt(0);
		oElement = getSelectedElement(oSel);
		if (oElement.nodeName == useBlock) return oElement;
		return
	}
	range = oSel.getRangeAt(0);
	sHTML = range.toString();
	var docFrag = range.extractContents();
	var idSpan = oEditor.document.createElement(useBlock);
	idSpan.appendChild(docFrag);
	range.insertNode(idSpan);
	try {
		oEditor.document.designMode = "on"
	} catch(e) {}
	range = oEditor.document.createRange();
	range.selectNode(idSpan);
	oSel = oEditor.getSelection();
	oSel.removeAllRanges();
	oSel.addRange(range);
	return idSpan
};
function makeAbsolute() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oSel = oEditor.getSelection();
	var oEl = getSelectedElement(oSel);
	this.saveForUndo();
	if (oEl != null && oEl.nodeName != "BODY") {
		if (oEl.style.position == "absolute") oEl.style.position = "";
		else oEl.style.position = "absolute"
	}
};
function doOver_TabCreate(el) {
	var oTD = el;
	var oTable = oTD.parentNode.parentNode.parentNode;
	var nRow = oTD.parentNode.rowIndex;
	var nCol = oTD.cellIndex;
	var rows = oTable.rows;
	var custCell = rows[rows.length - 1].childNodes[0];
	custCell.innerHTML = "<div align=right>" + (nRow * 1 + 1) + " x " + (nCol * 1 + 1) + " " + getTxt("Table Dimension Text") + " ...  &nbsp;&nbsp;&nbsp;<span style='text-decoration:underline'>" + getTxt("Table Advance Link") + "</span>&nbsp;</div>";
	custCell.style.backgroundColor = "";
	custCell.style.color = "#000000";
	custCell.style.border = "0px";
	for (var i = 0; i < rows.length - 1; i++) {
		var oRow = rows[i];
		for (var j = 0; j < oRow.childNodes.length; j++) {
			var oCol = oRow.childNodes[j];
			if (i <= nRow && j <= nCol) oCol.style.backgroundColor = "#316ac5";
			else oCol.style.backgroundColor = "#ffffff"
		}
	}
};
function doOut_TabCreate(el) {
	var oTable = el;
	if (oTable.nodeName != "TABLE") return;
	var rows = oTable.rows;
	rows[rows.length - 1].childNodes[0].innerHTML = getTxt("Advanced Table Insert");
	for (var i = 0; i < rows.length - 1; i++) {
		var oRow = rows[i];
		for (var j = 0; j < oRow.childNodes.length; j++) {
			var oCol = oRow.childNodes[j];
			oCol.style.backgroundColor = "#ffffff"
		}
	}
};
function doRefresh_TabCreate() {
	var oTable = document.getElementById("dropTableCreate" + this.oName);
	var rows = oTable.rows;
	rows[rows.length - 1].childNodes[0].innerHTML = getTxt("Advanced Table Insert");
	for (var i = 0; i < rows.length - 1; i++) {
		var oRow = rows[i];
		for (var j = 0; j < oRow.childNodes.length; j++) {
			var oCol = oRow.childNodes[j];
			oCol.style.backgroundColor = "#ffffff"
		}
	}
};
function doClick_TabCreate(el) {
	this.hide();
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var oTD = el;
	var nRow = oTD.parentNode.rowIndex + 1;
	var nCol = oTD.cellIndex + 1;
	this.saveForUndo();
	var sHTML = "<table style='border-collapse:collapse;width:100%;' selThis='selThis'>";
	for (var i = 1; i <= nRow; i++) {
		sHTML += "<tr>";
		for (var j = 1; j <= nCol; j++) {
			sHTML += "<td><br/></td>"
		}
		sHTML += "</tr>"
	}
	sHTML += "</table>";
	var oSel = oEditor.getSelection();
	var range = oSel.getRangeAt(0);
	range.collapse(true);
	var docFrag = range.createContextualFragment(sHTML);
	range.insertNode(docFrag);
	try {
		oEditor.document.designMode = "on"
	} catch(e) {}
	var allTabs = oEditor.document.getElementsByTagName("TABLE");
	for (var i = 0; i < allTabs.length; i++) {
		if (allTabs[i].getAttribute("selThis") == "selThis") {
			range = oEditor.document.createRange();
			range.selectNode(allTabs[i]);
			oSel = oEditor.getSelection();
			oSel.removeAllRanges();
			oSel.addRange(range);
			allTabs[i].removeAttribute("selThis");
			break
		}
	}
	realTime(this)
};
function doKeyPress(evt, obj) {
	if (!obj.arrUndoList[0]) {
		obj.saveForUndo()
	}
	if (evt.ctrlKey) {
		switch (evt.keyCode) {
		case 86:
			if (obj.pasteTextOnCtrlV) {
				evt.preventDefault();
				modelessDialogShow(obj.scriptPath + "paste_text.htm", 400, 280)
			} else {
				var mainEditor = document.getElementById("idContent" + obj.oName).contentWindow;
				var oSel = mainEditor.getSelection();
				var range = oSel.getRangeAt(0);
				mainEditor.document.body.contentEditable = false;
				var pasteArea = mainEditor.document.getElementById("pasteArea");
				if (!pasteArea) {
					pasteArea = document.createElement("div");
					pasteArea.id = "pasteArea";
					pasteArea.style.position = "absolute";
					pasteArea.style.left = "-1000px";
					pasteArea.contentEditable = true;
					mainEditor.document.body.appendChild(pasteArea)
				}
				pasteArea.focus();
				window.setTimeout(function () {
					var str = obj.fixWord();
					var mainEditor = document.getElementById("idContent" + obj.oName).contentWindow;
					mainEditor.document.body.contentEditable = true;
					mainEditor.document.body.focus();
					var oSel = mainEditor.getSelection();
					oSel.removeAllRanges();
					oSel.addRange(range);
					obj.insertHTML(str)
				},
				100)
			}
			break
		}
	}
	if (evt.keyCode == 37 || evt.keyCode == 38 || evt.keyCode == 39 || evt.keyCode == 40) {
		obj.saveForUndo()
	}
	if (evt.keyCode == 13) {
		obj.saveForUndo()
	}
	obj.onKeyPress()
};
function fullScreen() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var edtArea = document.getElementById("idArea" + this.oName);
	this.hide();
	if (this.stateFullScreen) {
		this.onNormalScreen();
		this.stateFullScreen = false;
		document.body.style.overflow = "";
		document.getElementById("id_refresh_z_index").style.margin = "0px";
		edtArea.style.position = "";
		edtArea.style.top = "0px";
		edtArea.style.left = "0px";
		if (this.width.toString().indexOf("%") != -1) edtArea.style.width = this.width;
		else edtArea.style.width = parseInt(this.width) + "px";
		if (this.height.toString().indexOf("%") != -1) edtArea.style.height = this.height;
		else edtArea.style.height = parseInt(this.height) + "px";
		for (var i = 0; i < oUtil.arrEditor.length; i++) {
			if (oUtil.arrEditor[i] != this.oName) {
				document.getElementById("idArea" + oUtil.arrEditor[i]).style.display = "";
				try {
					document.getElementById("idContent" + oUtil.arrEditor[i]).contentWindow.document.designMode = "on"
				} catch(e) {}
			}
		}
	} else {
		this.onFullScreen();
		this.stateFullScreen = true;
		window.scroll(0, 0);
		document.body.style.overflow = "hidden";
		document.getElementById("id_refresh_z_index").style.margin = "70px";
		edtArea.style.position = "absolute";
		edtArea.style.top = "0px";
		edtArea.style.left = "0px";
		edtArea.style.width = window.innerWidth + "px";
		edtArea.style.height = window.innerHeight + "px";
		edtArea.style.zIndex = 2000;
		for (var i = 0; i < oUtil.arrEditor.length; i++) {
			if (oUtil.arrEditor[i] != this.oName) document.getElementById("idArea" + oUtil.arrEditor[i]).style.display = "none"
		}
		oEditor.focus()
	}
	try {
		oEditor.document.designMode = "on"
	} catch(e) {}
	var idStyles = document.getElementById("idStyles" + this.oName);
	idStyles.innerHTML = ""
};
function modelessDialogShow(url, width, height, p, opt) {
	windowOpen(url, width, height, false, p, opt)
};
function modalDialogShow(url, width, height, p, opt) {
	windowOpen(url, width, height, true, p, opt)
};
function windowOpen(url, wd, hg, ov, p, opt) {
	var id = "ID" + (new Date()).getTime();
	var f = new ISWindow(id);
	f.iconPath = oUtil.scriptPath.substring(0, oUtil.scriptPath.indexOf("saf/")) + "icons/";
	f.show({
		width: wd + "px",
		height: hg + "px",
		overlay: ov,
		center: true,
		url: url,
		openerWin: p,
		options: opt
	})
};
function hide() {
	hideAllDD();
	this.oColor1.hide();
	this.oColor2.hide();
	if (this.btnTable) this.doRefresh_TabCreate()
};
function lineBreak1(tag) {
	arrReturn = ["\n", "", ""];
	if (tag == "A" || tag == "B" || tag == "CITE" || tag == "CODE" || tag == "EM" || tag == "FONT" || tag == "I" || tag == "SMALL" || tag == "STRIKE" || tag == "BIG" || tag == "STRONG" || tag == "SUB" || tag == "SUP" || tag == "U" || tag == "SAMP" || tag == "S" || tag == "VAR" || tag == "BASEFONT" || tag == "KBD" || tag == "TT" || tag == "SPAN" || tag == "IMG") arrReturn = ["", "", ""];
	if (tag == "TEXTAREA" || tag == "TABLE" || tag == "THEAD" || tag == "TBODY" || tag == "TR" || tag == "OL" || tag == "UL" || tag == "DIR" || tag == "MENU" || tag == "FORM" || tag == "SELECT" || tag == "MAP" || tag == "DL" || tag == "HEAD" || tag == "BODY" || tag == "HTML") arrReturn = ["\n", "", "\n"];
	if (tag == "STYLE" || tag == "SCRIPT") arrReturn = ["\n", "", ""];
	if (tag == "BR" || tag == "HR") arrReturn = ["", "\n", ""];
	return arrReturn
};
function fixAttr(s) {
	s = String(s).replace(/&/g, "&amp;");
	s = String(s).replace(/</g, "&lt;");
	s = String(s).replace(/"/g, "&quot;");
	return s
};
function fixVal(s) {
	s = String(s).replace(/&/g, "&amp;");
	s = String(s).replace(/</g, "&lt;");
	var x = escape(s);
	x = unescape(x.replace(/\ /gi, "-*REPL*-"));
	s = x.replace(/-\*REPL\*-/gi, "&nbsp;");
	return s
};
function recur(oEl, sTab) {
	var sHTML = "";
	for (var i = 0; i < oEl.childNodes.length; i++) {
		var oNode = oEl.childNodes[i];
		if (oNode.nodeType == 1) {
			var sTagName = oNode.nodeName;
			var bDoNotProcess = false;
			if (sTagName.substring(0, 1) == "/") {
				bDoNotProcess = true
			} else {
				var sT = sTab;
				sHTML += lineBreak1(sTagName)[0];
				if (lineBreak1(sTagName)[0] != "") sHTML += sT
			}
			if (bDoNotProcess) {} else if (sTagName == "OBJECT" || sTagName == "EMBED") {
				s = getOuterHTML(oNode);
				s = s.replace(/\"[^\"]*\"/ig, function (x) {
					x = x.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/'/g, "&apos;").replace(/\s+/ig, "#_#").replace(/&amp;amp;/gi, "&amp;");
					return x
				});
				s = s.replace(/<([^ >]*)/ig, function (x) {
					return x.toLowerCase()
				});
				s = s.replace(/ ([^=]+)=([^"' >]+)/ig, " $1=\"$2\"");
				s = s.replace(/ ([^=]+)=/ig, function (x) {
					return x.toLowerCase()
				});
				s = s.replace(/#_#/ig, " ");
				s = s.replace(/<param([^>]*)>/ig, "\n<param$1 />").replace(/\/ \/>$/ig, " \/>");
				if (sTagName == "EMBED") if (oNode.innerHTML == "") s = s.replace(/>$/ig, " \/>").replace(/\/ \/>$/ig, "\/>");
				s = s.replace(/<param name=\"Play\" value=\"0\" \/>/, "<param name=\"Play\" value=\"-1\" \/>");
				sHTML += s
			} else if (sTagName == "TITLE") {
				sHTML += "<title>" + oNode.innerHTML + "</title>"
			} else {
				if (sTagName == "AREA") {
					var sCoords = oNode.coords;
					var sShape = oNode.shape
				}
				var oNode2 = oNode.cloneNode(false);
				s = getOuterHTML(oNode2).replace(/<\/[^>]*>/, "");
				if (sTagName == "STYLE") {
					var arrTmp = s.match(/<[^>]*>/ig);
					s = arrTmp[0]
				}
				s = s.replace(/\"[^\"]*\"/ig, function (x) {
					x = x.replace(/&/g, "&amp;").replace(/&amp;amp;/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\s+/ig, "#_#");
					return x
				});
				s = s.replace(/<([^ >]*)/ig, function (x) {
					return x.toLowerCase()
				});
				s = s.replace(/ ([^=]+)=([^" >]+)/ig, " $1=\"$2\"");
				s = s.replace(/ ([^=]+)=/ig, function (x) {
					return x.toLowerCase()
				});
				s = s.replace(/#_#/ig, " ");
				s = s.replace(/(<hr[^>]*)(noshade="")/ig, "$1noshade=\"noshade\"");
				s = s.replace(/(<input[^>]*)(checked="")/ig, "$1checked=\"checked\"");
				s = s.replace(/(<select[^>]*)(multiple="")/ig, "$1multiple=\"multiple\"");
				s = s.replace(/(<option[^>]*)(selected="")/ig, "$1selected=\"true\"");
				s = s.replace(/(<input[^>]*)(readonly="")/ig, "$1readonly=\"readonly\"");
				s = s.replace(/(<input[^>]*)(disabled="")/ig, "$1disabled=\"disabled\"");
				s = s.replace(/(<td[^>]*)(nowrap="" )/ig, "$1nowrap=\"nowrap\" ");
				s = s.replace(/(<td[^>]*)(nowrap=""\>)/ig, "$1nowrap=\"nowrap\"\>");
				s = s.replace(/ contenteditable=\"true\"/ig, "");
				if (sTagName == "AREA") {
					s = s.replace(/ coords=\"0,0,0,0\"/ig, " coords=\"" + sCoords + "\"");
					s = s.replace(/ shape=\"RECT\"/ig, " shape=\"" + sShape + "\"")
				}
				var bClosingTag = true;
				if (sTagName == "IMG" || sTagName == "BR" || sTagName == "AREA" || sTagName == "HR" || sTagName == "INPUT" || sTagName == "BASE" || sTagName == "LINK") {
					s = s.replace(/>$/ig, " \/>").replace(/\/ \/>$/ig, "\/>");
					bClosingTag = false
				}
				sHTML += s;
				if (sTagName != "TEXTAREA") sHTML += lineBreak1(sTagName)[1];
				if (sTagName != "TEXTAREA") if (lineBreak1(sTagName)[1] != "") sHTML += sT;
				if (bClosingTag) {
					s = getOuterHTML(oNode);
					if (sTagName == "SCRIPT") {
						s = s.replace(/<script([^>]*)>[\n+\s+\t+]*/ig, "<script$1>");
						s = s.replace(/[\n+\s+\t+]*<\/script>/ig, "<\/script>");
						s = s.replace(/<script([^>]*)>\/\/<!\[CDATA\[/ig, "");
						s = s.replace(/\/\/\]\]><\/script>/ig, "");
						s = s.replace(/<script([^>]*)>/ig, "");
						s = s.replace(/<\/script>/ig, "");
						s = s.replace(/^\s+/, '').replace(/\s+$/, '');
						sHTML += "\n" + sT + "//<![CDATA[\n" + sT + s + "\n" + sT + "//]]>\n" + sT
					}
					if (sTagName == "STYLE") {
						s = s.replace(/<style([^>]*)>[\n+\s+\t+]*/ig, "<style$1>");
						s = s.replace(/[\n+\s+\t+]*<\/style>/ig, "<\/style>");
						s = s.replace(/<style([^>]*)><!--/ig, "");
						s = s.replace(/--><\/style>/ig, "");
						s = s.replace(/<style([^>]*)>/ig, "");
						s = s.replace(/<\/style>/ig, "");
						s = s.replace(/^\s+/, "").replace(/\s+$/, "");
						sHTML += "\n" + sT + "<!--\n" + sT + s + "\n" + sT + "-->\n" + sT
					}
					if (sTagName == "DIV" || sTagName == "P") {
						if (oNode.innerHTML == "" || oNode.innerHTML == "&nbsp;") {
							sHTML += "&nbsp;"
						} else sHTML += recur(oNode, sT + "\t")
					} else if (sTagName == "STYLE" || sTagName == "SCRIPT") {} else {
						sHTML += recur(oNode, sT + "\t")
					}
					if (sTagName != "TEXTAREA") sHTML += lineBreak1(sTagName)[2];
					if (sTagName != "TEXTAREA") if (lineBreak1(sTagName)[2] != "") sHTML += sT;
					sHTML += "</" + sTagName.toLowerCase() + ">"
				}
			}
		} else if (oNode.nodeType == 3) {
			sHTML += fixVal(oNode.nodeValue).replace(/^[\t\r\n\v\f]*/, "").replace(/[\t\r\n\v\f]*$/, "")
		} else if (oNode.nodeType == 8) {
			if (getOuterHTML(oNode).substring(0, 2) == "<" + "%") {
				sTmp = (getOuterHTML(oNode).substring(2));
				sTmp = sTmp.substring(0, sTmp.length - 2);
				sTmp = sTmp.replace(/^\s+/, "").replace(/\s+$/, "");
				var sT = sTab;
				sHTML += "\n" + sT + "<%\n" + sT + sTmp + "\n" + sT + "%>\n" + sT
			} else {
				var sT = sTab;
				sTmp = oNode.nodeValue;
				sTmp = sTmp.replace(/^\s+/, "").replace(/\s+$/, "");
				sHTML += "\n" + sT + "<!--\n" + sT + sTmp + "\n" + sT + "-->\n" + sT
			}
		} else {}
	}
	return sHTML
};
function getSelectedElement(sel) {
	var range = sel.getRangeAt(0);
	var node = range.startContainer;
	if (node.nodeType == Node.ELEMENT_NODE) {
		if (range.startOffset >= node.childNodes.length) return node;
		node = node.childNodes[range.startOffset]
	}
	if (node.nodeType == Node.TEXT_NODE) {
		if (node.nodeValue.length == range.startOffset) {
			var el = node.nextSibling;
			if (el && el.nodeType == Node.ELEMENT_NODE) {
				if (range.endContainer.nodeType == Node.TEXT_NODE && range.endContainer.nodeValue.length == range.endOffset) {
					if (el == range.endContainer.parentNode) {
						return el
					}
				}
			}
		}
		while (node != null && node.nodeType != Node.ELEMENT_NODE) {
			node = node.parentNode
		}
	}
	return node
};
function isTextSelected(sel) {
	var range = sel.getRangeAt(0);
	if (range != null && range.startContainer != null) {
		return (range.startContainer.nodeType == Node.TEXT_NODE)
	}
	return false
};
function getOuterHTML(node) {
	var sHTML = "";
	switch (node.nodeType) {
	case Node.ELEMENT_NODE:
		sHTML = "<" + node.nodeName;
		var tagVal = "";
		for (var atr = 0; atr < node.attributes.length; atr++) {
			if (node.attributes[atr].nodeName.substr(0, 4) == "_moz") continue;
			if (node.attributes[atr].nodeValue.substr(0, 4) == "_moz") continue;
			if (node.nodeName == 'TEXTAREA' && node.attributes[atr].nodeName.toLowerCase() == 'value') {
				tagVal = node.attributes[atr].nodeValue
			} else {
				sHTML += ' ' + node.attributes[atr].nodeName + '="' + node.attributes[atr].nodeValue + '"'
			}
		}
		sHTML += '>';
		sHTML += (node.nodeName != 'TEXTAREA' ? node.innerHTML: tagVal);
		sHTML += "</" + node.nodeName + ">";
		break;
	case Node.COMMENT_NODE:
		sHTML = "<!" + "--" + node.nodeValue + "--" + ">";
		break;
	case Node.TEXT_NODE:
		sHTML = node.nodeValue;
		break
	}
	return sHTML
};
function tbAction(tb, id, edt, sfx) {
	var e = edt,
	oN = sfx,
	btn = id.substring(0, id.lastIndexOf(oN));
	switch (btn) {
	case "btnSave":
		e.onSave();
		break;
	case "btnFullScreen":
		e.fullScreen();
		break;
	case "btnPrint":
		e.focus();
		document.getElementById("idContent" + edt.oName).contentWindow.print();
		break;
	case "btnSearch":
		e.hide();
		modelessDialogShow(e.scriptPath + "search.htm", 375, 163);
		break;
	case "btnSpellCheck":
		e.hide();
		if (e.spellCheckMode == "ieSpell");
		else if (e.spellCheckMode == "NetSpell") checkSpellingById("idContent" + edt.oName);
		break;
	case "btnCut":
		e.doCmd("Cut");
		break;
	case "btnCopy":
		e.doCmd("Copy");
		break;
	case "btnUndo":
		e.doUndo();
		break;
	case "btnRedo":
		e.doRedo();
		break;
	case "btnBold":
		e.applyFormattingStyle("Bold");
		break;
	case "btnItalic":
		e.applyFormattingStyle("Italic");
		break;
	case "btnUnderline":
		e.applyFormattingStyle("Underline");
		break;
	case "btnStrikethrough":
		e.applyFormattingStyle("Strikethrough");
		break;
	case "btnSuperscript":
		e.applyFormattingStyle("Superscript");
		break;
	case "btnSubscript":
		e.applyFormattingStyle("Subscript");
		break;
	case "btnJustifyLeft":
		e.applyJustifyLeft();
		break;
	case "btnJustifyCenter":
		e.applyJustifyCenter();
		break;
	case "btnJustifyRight":
		e.applyJustifyRight();
		break;
	case "btnJustifyFull":
		e.applyJustifyFull();
		break;
	case "btnNumbering":
		e.applyNumbering();
		break;
	case "btnBullets":
		e.applyBullets();
		break;
	case "btnIndent":
		e.doCmd("Indent");
		break;
	case "btnOutdent":
		e.doCmd("Outdent");
		break;
	case "btnLTR":
		e.applyBlockDirLTR();
		break;
	case "btnRTL":
		e.applyBlockDirRTL();
		break;
	case "btnForeColor":
		e.oColor1.show(document.getElementById(id));
		break;
	case "btnBackColor":
		e.oColor2.show(document.getElementById(id));
		break;
	case "btnBookmark":
		e.hide();
		modelessDialogShow(e.scriptPath + "bookmark.htm", 245, 216);
		break;
	case "btnHyperlink":
		e.hide();
		modelessDialogShow(e.scriptPath + "hyperlink.htm", 380, 220);
		break;
	case "btnImage":
		e.hide();
		modelessDialogShow(e.scriptPath + "image.htm", 440, 351);
		break;
	case "btnFlash":
		e.hide();
		modelessDialogShow(e.scriptPath + "flash.htm", 340, 275);
		break;
	case "btnYoutubeVideo":
		e.hide();
		modelessDialogShow(e.scriptPath + "youtube_video.htm", 340, 125);
		break;
	case "btnMedia":
		e.hide();
		modelessDialogShow(e.scriptPath + "media.htm", 340, 272);
		break;
	case "btnContentBlock":
		e.hide();
		eval(e.cmdContentBlock);
		break;
	case "btnInternalLink":
		e.hide();
		eval(e.cmdInternalLink);
		break;
	case "btnInternalImage":
		e.hide();
		eval(e.cmdInternalImage);
		break;
	case "btnCustomObject":
		e.hide();
		eval(e.cmdCustomObject);
		break;
	case "btnGuidelines":
		e.runtimeBorder(true);
		break;
	case "btnAutoTable":
		e.hide();
		modelessDialogShow(e.scriptPath + "table_format.htm", 320, 225);
		break;
	case "btnAbsolute":
		e.makeAbsolute();
		break;
	case "btnCharacters":
		e.hide();
		modelessDialogShow(e.scriptPath + "characters.htm", 495, 160);
		break;
	case "btnLine":
		e.doCmd("InsertHorizontalRule");
		break;
	case "btnRemoveFormat":
		e.doClean();
		break;
	case "btnHTMLFullSource":
		setActiveEditor(edt);
		e.hide();
		modalDialogShow(e.scriptPath + "source_html_full.htm", 600, 450);
		break;
	case "btnHTMLSource":
		setActiveEditor(edt);
		e.hide();
		modalDialogShow(e.scriptPath + "source_html.htm", 600, 450);
		break;
	case "btnXHTMLFullSource":
		setActiveEditor(edt);
		e.hide();
		modalDialogShow(e.scriptPath + "source_xhtml_full.htm", 600, 450);
		break;
	case "btnXHTMLSource":
		setActiveEditor(edt);
		e.hide();
		modalDialogShow(e.scriptPath + "source_xhtml.htm", 600, 450);
		break;
	case "btnClearAll":
		e.clearAll();
		break;
	case "btnStyles":
		e.hide();
		e.openStyleSelect();
		break;
	case "btnParagraph":
		e.hide();
		e.selectParagraph();
		break;
	case "btnFontName":
		e.hide();
		e.expandSelection();
		realtimeFontSelect(e.oName);
		break;
	case "btnFontSize":
		e.hide();
		e.expandSelection();
		realtimeSizeSelect(e.oName);
		break;
	case "btnCustomTag":
		e.hide();
		break;
	default:
		for (var i = 0; i < e.arrCustomButtons.length; i++) {
			if (e.arrCustomButtons[i][0] == btn) {
				eval(e.arrCustomButtons[i][1]);
				break
			}
		}
	}
};
function ddAction(tb, id, edt, sfx) {
	var oN = sfx;
	var e = edt;
	var btn = id.substring(0, id.lastIndexOf(oN));
	switch (btn) {
	case "btnPreview1":
		setActiveEditor(edt);
		modalDialogShow(e.scriptPath + "preview.htm", 640, 480);
		break;
	case "btnPreview2":
		setActiveEditor(edt);
		modalDialogShow(e.scriptPath + "preview.htm", 800, 600);
		break;
	case "btnPreview3":
		setActiveEditor(edt);
		modalDialogShow(e.scriptPath + "preview.htm", 1024, 768);
		break;
	case "btnTextFormatting":
		modelessDialogShow(e.scriptPath + "text1.htm", 511, 490);
		break;
	case "btnParagraphFormatting":
		modelessDialogShow(e.scriptPath + "paragraph.htm", 460, 284);
		break;
	case "btnListFormatting":
		modelessDialogShow(e.scriptPath + "list.htm", 305, 335);
		break;
	case "btnBoxFormatting":
		modelessDialogShow(e.scriptPath + "box.htm", 498, 395);
		break;
	case "btnCssText":
		modelessDialogShow(e.scriptPath + "styles_cssText.htm", 360, 332);
		break;
	case "btnCssBuilder":
		modelessDialogShow(e.scriptPath + "styles_cssText2.htm", 430, 445);
		break;
	case "btnForm0":
		modelessDialogShow(e.scriptPath + "form_form.htm", 280, 177);
		break;
	case "btnForm1":
		modelessDialogShow(e.scriptPath + "form_text.htm", 285, 289);
		break;
	case "btnForm2":
		modelessDialogShow(e.scriptPath + "form_list.htm", 295, 332);
		break;
	case "btnForm3":
		modelessDialogShow(e.scriptPath + "form_check.htm", 235, 174);
		break;
	case "btnForm4":
		modelessDialogShow(e.scriptPath + "form_radio.htm", 235, 177);
		break;
	case "btnForm5":
		modelessDialogShow(e.scriptPath + "form_hidden.htm", 235, 152);
		break;
	case "btnForm6":
		modelessDialogShow(e.scriptPath + "form_file.htm", 235, 132);
		break;
	case "btnForm7":
		modelessDialogShow(e.scriptPath + "form_button.htm", 235, 174);
		break;
	case "mnuTableSize":
		modelessDialogShow(e.scriptPath + "table_size.htm", 240, 282);
		break;
	case "mnuTableEdit":
		modelessDialogShow(e.scriptPath + "table_edit.htm", 400, 430);
		break;
	case "mnuCellEdit":
		modelessDialogShow(e.scriptPath + "table_editCell.htm", 431, 445);
		break;
	case "btnPasteWord":
		modelessDialogShow(e.scriptPath + "paste_word.htm", 400, 280);
		break;
	case "btnPasteText":
		modelessDialogShow(e.scriptPath + "paste_text.htm", 400, 280);
		break
	}
	var idx = 0;
	if (btn.indexOf("btnParagraphFormatting") != -1) {} else if (btn.indexOf("btnParagraph") != -1) {
		idx = btn.substr(btn.indexOf("_") + 1);
		e.applyParagraph("<" + e.arrParagraph[parseInt(idx)][1] + ">")
	} else if (btn.indexOf("btnFontName") != -1) {
		idx = btn.substr(btn.indexOf("_") + 1);
		e.applyFontName(e.arrFontName[parseInt(idx)])
	} else if (btn.indexOf("btnFontSize") != -1) {
		idx = btn.substr(btn.indexOf("_") + 1);
		e.applyFontSize(e.arrFontSize[parseInt(idx)][1])
	} else if (btn.indexOf("btnCustomTag") != -1) {
		idx = btn.substr(btn.indexOf("_") + 1);
		e.insertCustomTag(parseInt(idx))
	}
};
function changeHeight(v) {
	var cH = String(this.height);
	var edtObj = document.getElementById("idArea" + this.oName);
	if (cH.indexOf("%") > -1) {
		cH = edtObj.childNodes[0].offsetHeight - edtObj.rows[0].cells[0].childNodes[0].offsetHeight - (this.useTagSelector ? 20 : 0)
	}
	if (!this.minHeight) this.minHeight = parseInt(cH, 10);
	var newHeight = parseInt(cH, 10) + v;
	this.height = newHeight + "px";
	edtObj.style.height = this.height
};
function fixWord() {
	var oEditor = document.getElementById("idContent" + this.oName).contentWindow;
	var idSource = oEditor.document.getElementById("pasteArea");
	var allTags = idSource.getElementsByTagName("*");
	for (var i = 0; i < allTags.length; i++) {
		allTags[i].removeAttribute("class");
		allTags[i].removeAttribute("style")
	}
	var str = idSource.innerHTML;
	idSource.parentNode.removeChild(idSource);
	str = String(str).replace(/<\\?\?xml[^>]*>/g, "");
	str = String(str).replace(/<\/?o:p[^>]*>/g, "");
	str = String(str).replace(/<\/?u1:p[^>]*>/gi, "");
	str = String(str).replace(/<\/?v:[^>]*>/g, "");
	str = String(str).replace(/<\/?o:[^>]*>/g, "");
	str = String(str).replace(/<\/?st1:[^>]*>/g, "");
	str = String(str).replace(/<\/?w:wrap[^>]*>/gi, "");
	str = String(str).replace(/<\/?w:anchorlock[^>]*>/gi, "");
	str = String(str).replace(/&nbsp;/g, "");
	str = String(str).replace(/<\/?SPAN[^>]*>/g, "");
	str = String(str).replace(/<\/?FONT[^>]*>/g, "");
	str = String(str).replace(/<\/?STRONG[^>]*>/g, "");
	str = String(str).replace(/<\/?H1[^>]*>/g, "");
	str = String(str).replace(/<\/?H2[^>]*>/g, "");
	str = String(str).replace(/<\/?H3[^>]*>/g, "");
	str = String(str).replace(/<\/?H4[^>]*>/g, "");
	str = String(str).replace(/<\/?H5[^>]*>/g, "");
	str = String(str).replace(/<\/?H6[^>]*>/g, "");
	str = String(str).replace(/<\/?P[^>]*><\/P>/g, "");
	str = String(str).replace(/<!--\[if[^>]*>/gi, "");
	str = String(str).replace(/<!--\[endif\]-->/gi, "");
	str = String(str).replace(/<!\[endif\]-->/gi, "");
	return str
}